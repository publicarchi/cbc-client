function OpenSeadragon(e){return new OpenSeadragon.Viewer(e)}!function(e){var t={},i=navigator.userAgent;t.history=(-1===i.indexOf("Android 2.")&&-1===i.indexOf("Android 4.0")||-1===i.indexOf("Mobile Safari")||-1!==i.indexOf("Chrome")||-1!==i.indexOf("Windows Phone")||"file:"===location.protocol)&&window.history&&"pushState"in window.history&&"replaceState"in window.history,e.support=t,e.testCSS=function(e){for(var t,i=(e=-1!=e.indexOf("-")?e.replace(/([a-z])-([a-z])/g,function(e,t,i){return t+i.toUpperCase()}).replace(/^-/,""):e).charAt(0).toUpperCase()+e.slice(1),n=(e+" "+"Moz O ms Webkit".split(" ").join(i+" ")+i).split(" "),s=document.createElement("a"),o=n.length,r=0;r<o;r++)if(t=n[r],void 0!==s.style[t])return t;return!1}}(this),function(){function e(){}for(var t,i=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],n=i.length,s=window.console=window.console||{};n--;)s[t=i[n]]||(s[t]=e)}(),function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=this,i=(t.document||t.ownerDocument).querySelectorAll(e),n=0;i[n]&&i[n]!==t;)++n;return!!i[n]},e.closest=e.closest||function(e){for(var t=this;t&&!t.matches(e);)t=t.parentElement;return t}}(Element.prototype),function(e){e.remove=e.remove||function(){this.parentNode&&this.parentNode.removeChild(this)}}(Element.prototype),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),i=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;i.appendChild(t?e:document.createTextNode(String(e)))}),this.insertBefore(i,this.firstChild)}})}),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),i=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;i.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(i)}})}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("before")||Object.defineProperty(e,"before",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),i=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;i.appendChild(t?e:document.createTextNode(String(e)))}),this.parentNode.insertBefore(i,this)}})}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("after")||Object.defineProperty(e,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),i=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;i.appendChild(t?e:document.createTextNode(String(e)))}),this.parentNode.insertBefore(i,this.nextSibling)}})}),window.lazySizesConfig=window.lazySizesConfig||{},window.lazySizesConfig.expand=200,window.lazySizesConfig.loadHidden=!1,function(e){var t=function(n,d,o){"use strict";var p,g,m,M,s,f,e,h,H,r,B,F,i,N,a,c,u,v,y,w,x,j,b,t,W,U,l,T,$,V,G,E,S,q,_,Z,X,Y,P,C,k,R,K,Q,J,ee,te,D,ie,ne,se,oe,L,I,z,re,O,ae,le,he,A,ce,ue,de,pe,ge,me,fe,ve={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};for(fe in g=n.lazySizesConfig||n.lazysizesConfig||{},ve)fe in g||(g[fe]=ve[fe]);return d&&d.getElementsByClassName?(m=d.documentElement,M=n.HTMLPictureElement,f="getAttribute",e=n[s="addEventListener"].bind(n),h=n.setTimeout,H=n.requestAnimationFrame||h,r=n.requestIdleCallback,B=/^picture$/i,F=["load","error","lazyincluded","_lazyloaded"],i={},N=Array.prototype.forEach,a=function(e,t){return i[t]||(i[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),i[t].test(e[f]("class")||"")&&i[t]},c=function(e,t){a(e,t)||e.setAttribute("class",(e[f]("class")||"").trim()+" "+t)},u=function(e,t){(t=a(e,t))&&e.setAttribute("class",(e[f]("class")||"").replace(t," "))},v=function(t,i,e){var n=e?s:"removeEventListener";e&&v(t,i),F.forEach(function(e){t[n](e,i)})},y=function(e,t,i,n,s){var o=d.createEvent("Event");return(i=i||{}).instance=p,o.initEvent(t,!n,!s),o.detail=i,e.dispatchEvent(o),o},w=function(e,t){var i;!M&&(i=n.picturefill||g.pf)?(t&&t.src&&!e[f]("srcset")&&e.setAttribute("srcset",t.src),i({reevaluate:!0,elements:[e]})):t&&t.src&&(e.src=t.src)},x=function(e,t){return(getComputedStyle(e,null)||{})[t]},j=function(e,t,i){for(i=i||e.offsetWidth;i<g.minSize&&t&&!e._lazysizesWidth;)i=t.offsetWidth,t=t.parentNode;return i},ge=[],me=pe=[],Ce._lsFlush=Pe,b=Ce,t=function(i,e){return e?function(){b(i)}:function(){var e=this,t=arguments;b(function(){i.apply(e,t)})}},W=function(e){function t(){var e=o.now()-n;e<99?h(t,99-e):(r||s)(s)}var i,n,s=function(){i=null,e()};return function(){n=o.now(),i=i||h(t,99)}},ne=/^img$/i,se=/^iframe$/i,oe="onscroll"in n&&!/(gle|ing)bot/.test(navigator.userAgent),z=-1,re=function(e){return(K=null==K?"hidden"==x(d.body,"visibility"):K)||!("hidden"==x(e.parentNode,"visibility")&&"hidden"==x(e,"visibility"))},Q=xe,ee=I=L=0,te=g.throttleDelay,D=g.ricTimeout,ie=r&&49<D?function(){r(be,{timeout:D}),D!==g.ricTimeout&&(D=g.ricTimeout)}:t(function(){h(be)},!0),ae=t(Te),le=function(e){ae({target:e.target})},he=t(function(t,i,e,n,s){var o,r,a;if(!(r=y(t,"lazybeforeunveil",i)).defaultPrevented){if(n&&(e?c(t,g.autosizesClass):t.setAttribute("sizes",n)),e=t[f](g.srcsetAttr),n=t[f](g.srcAttr),s&&(o=(l=t.parentNode)&&B.test(l.nodeName||"")),a=i.firesLoad||"src"in t&&(e||n||o),r={target:t},c(t,g.loadingClass),a&&(clearTimeout(q),q=h(we,2500),v(t,le,!0)),o&&N.call(l.getElementsByTagName("source"),Ee),e)t.setAttribute("srcset",e);else if(n&&!o)if(se.test(t.nodeName)){var i=t,l=n;try{i.contentWindow.location.replace(l)}catch(e){i.src=l}}else t.src=n;s&&(e||o)&&w(t,{src:n})}t._lazyRace&&delete t._lazyRace,u(t,g.lazyClass),b(function(){var e=t.complete&&1<t.naturalWidth;a&&!e||(e&&c(t,"ls-is-cached"),Te(r),t._lazyCache=!0,h(function(){"_lazyCache"in t&&delete t._lazyCache},9)),"lazy"==t.loading&&I--},!0)}),ce=W(function(){g.loadMode=3,O()}),U={_:function(){Z=o.now(),p.elements=d.getElementsByClassName(g.lazyClass),E=d.getElementsByClassName(g.lazyClass+" "+g.preloadClass),e("scroll",O,!0),e("resize",O,!0),e("pageshow",function(e){var t;e.persisted&&(t=d.querySelectorAll("."+g.loadingClass)).length&&t.forEach&&H(function(){t.forEach(function(e){e.complete&&A(e)})})}),n.MutationObserver?new MutationObserver(O).observe(m,{childList:!0,subtree:!0,attributes:!0}):(m[s]("DOMNodeInserted",O,!0),m[s]("DOMAttrModified",O,!0),setInterval(O,999)),e("hashchange",O,!0),["focus","mouseover","click","load","transitionend","animationend"].forEach(function(e){d[s](e,O,!0)}),/d$|^c/.test(d.readyState)?_e():(e("load",_e),d[s]("DOMContentLoaded",O),h(_e,2e4)),p.elements.length?(xe(),b._lsFlush()):O()},checkElems:O=function(e){var t;(e=!0===e)&&(D=33),J||(J=!0,(t=te-(o.now()-ee))<0&&(t=0),e||t<9?ie():h(ie,t))},unveil:A=function(e){var t,i,n,s;e._lazyRace||!(!(s="auto"==(n=(i=ne.test(e.nodeName))&&(e[f](g.sizesAttr)||e[f]("sizes"))))&&S||!i||!e[f]("src")&&!e.srcset||e.complete||a(e,g.errorClass))&&a(e,g.lazyClass)||(t=y(e,"lazyunveilread").detail,s&&l.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,I++,he(e,t,s,n,i))},_aLSL:Se},V=t(function(e,t,i,n){var s,o,r;if(e._lazysizesWidth=n,e.setAttribute("sizes",n+="px"),B.test(t.nodeName||""))for(o=0,r=(s=t.getElementsByTagName("source")).length;o<r;o++)s[o].setAttribute("sizes",n);i.detail.dataAttr||w(e,i.detail)}),l={_:function(){$=d.getElementsByClassName(g.autosizesClass),e("resize",G)},checkElems:G=W(function(){var e,t=$.length;if(t)for(e=0;e<t;e++)ye($[e])}),updateElem:ye},T=function(){!T.i&&d.getElementsByClassName&&(T.i=!0,l._(),U._())},h(function(){g.init&&T()}),p={cfg:g,autoSizer:l,loader:U,init:T,uP:w,aC:c,rC:u,hC:a,fire:y,gW:j,rAF:b}):{init:function(){},cfg:g,noSupport:!0};function ye(e,t,i){var n=e.parentNode;n&&(i=j(e,n,i),(t=y(e,"lazybeforesizes",{width:i,dataAttr:!!t})).defaultPrevented||(i=t.detail.width)&&i!==e._lazysizesWidth&&V(e,n,t,i))}function we(e){I--,e&&!(I<0)&&e.target||(I=0)}function xe(){var e,t,i,n,s,o,r,a,l,h,c,u=p.elements;if((_=g.loadMode)&&I<8&&(e=u.length)){for(t=0,z++;t<e;t++)if(u[t]&&!u[t]._lazyRace)if(!oe||p.prematureUnveil&&p.prematureUnveil(u[t]))A(u[t]);else if((r=u[t][f]("data-expand"))&&(s=+r)||(s=L),l||(l=!g.expand||g.expand<1?500<m.clientHeight&&500<m.clientWidth?500:370:g.expand,h=(p._defEx=l)*g.expFactor,c=g.hFac,K=null,L<h&&I<1&&2<z&&2<_&&!d.hidden?(L=h,z=0):L=1<_&&1<z&&I<6?l:0),a!==s&&(X=innerWidth+s*c,Y=innerHeight+s,o=-1*s,a=s),h=u[t].getBoundingClientRect(),(R=h.bottom)>=o&&(P=h.top)<=Y&&(k=h.right)>=o*c&&(C=h.left)<=X&&(R||k||C||P)&&(g.loadHidden||re(u[t]))&&(S&&I<3&&!r&&(_<3||z<4)||function(e,t){var i,n=e,s=re(e);for(P-=t,R+=t,C-=t,k+=t;s&&(n=n.offsetParent)&&n!=d.body&&n!=m;)(s=0<(x(n,"opacity")||1))&&"visible"!=x(n,"overflow")&&(i=n.getBoundingClientRect(),s=k>i.left&&C<i.right&&R>i.top-1&&P<i.bottom+1);return s}(u[t],s))){if(A(u[t]),n=!0,9<I)break}else!n&&S&&!i&&I<4&&z<4&&2<_&&(E[0]||g.preloadAfterLoad)&&(E[0]||!r&&(R||k||C||P||"auto"!=u[t][f](g.sizesAttr)))&&(i=E[0]||u[t]);i&&!n&&A(i)}}function be(){J=!1,ee=o.now(),Q()}function Te(e){var t=e.target;t._lazyCache?delete t._lazyCache:(we(e),c(t,g.loadedClass),u(t,g.loadingClass),v(t,le),y(t,"lazyloaded"))}function Ee(e){var t,i=e[f](g.srcsetAttr);(t=g.customMedia[e[f]("data-media")||e[f]("media")])&&e.setAttribute("media",t),i&&e.setAttribute("srcset",i)}function Se(){3==g.loadMode&&(g.loadMode=2),ce()}function _e(){S||(o.now()-Z<999?h(_e,999):(S=!0,g.loadMode=3,O(),e("scroll",Se,!0)))}function Pe(){var e=me;for(me=pe.length?ge:pe,de=!(ue=!0);e.length;)e.shift()();ue=!1}function Ce(e,t){ue&&!t?e.apply(this,arguments):(me.push(e),de||(de=!0,(d.hidden?h:H)(Pe)))}}(e,e.document,Date);e.lazySizes=t,"object"==typeof module&&module.exports&&(module.exports=t)}("undefined"!=typeof window?window:{}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("whatInput",[],t):"object"==typeof exports?exports.whatInput=t():e.whatInput=t()}(this,function(){return s={},i.m=n=[function(e,t){"use strict";e.exports=function(){if("undefined"==typeof document||"undefined"==typeof window)return{ask:function(){return"initial"},element:function(){return null},ignoreKeys:function(){},specificKeys:function(){},registerOnChange:function(){},unRegisterOnChange:function(){}};var s=document.documentElement,t=null,o="initial",r=o,i=Date.now(),n="false",a=["button","input","select","textarea"],l=[],h=[16,17,18,91,93],c=[],u={keydown:"keyboard",keyup:"keyboard",mousedown:"mouse",mousemove:"mouse",MSPointerDown:"pointer",MSPointerMove:"pointer",pointerdown:"pointer",pointermove:"pointer",touchstart:"touch",touchend:"touch"},d=!1,p={x:null,y:null},g={2:"touch",3:"touch",4:"mouse"},e=!1;try{var m=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,m)}catch(m){}function f(){if(n=!(s.getAttribute("data-whatpersist")||"false"===document.body.getAttribute("data-whatpersist")))try{window.sessionStorage.getItem("what-input")&&(o=window.sessionStorage.getItem("what-input")),window.sessionStorage.getItem("what-intent")&&(r=window.sessionStorage.getItem("what-intent"))}catch(e){}T("input"),T("intent")}function v(e){var t=e.which,i=u[e.type],e=("pointer"===i&&(i=_(e)),!c.length&&-1===h.indexOf(t)),n=c.length&&-1!==c.indexOf(t),t="keyboard"===i&&t&&(e||n)||"mouse"===i||"touch"===i;(t=P(i)?!1:t)&&o!==i&&(S("input",o=i),T("input")),t&&r!==i&&(e=document.activeElement)&&e.nodeName&&(-1===a.indexOf(e.nodeName.toLowerCase())||"button"===e.nodeName.toLowerCase()&&!k(e,"form"))&&(S("intent",r=i),T("intent"))}function y(e){var t=u[e.type];"pointer"===t&&(t=_(e)),C(e),(!d&&!P(t)||d&&"wheel"===e.type||"mousewheel"===e.type||"DOMMouseScroll"===e.type)&&r!==t&&(S("intent",r=t),T("intent"))}function w(e){e.target.nodeName?(t=e.target.nodeName.toLowerCase(),s.setAttribute("data-whatelement",t),e.target.classList&&e.target.classList.length&&s.setAttribute("data-whatclasses",e.target.classList.toString().replace(" ",","))):E()}function x(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}var b,T=function(e){s.setAttribute("data-what"+e,"input"===e?o:r);for(var t=e,i=0,n=l.length;i<n;i++)l[i].type===t&&l[i].fn.call(void 0,"input"===t?o:r)},E=function(){t=null,s.removeAttribute("data-whatelement"),s.removeAttribute("data-whatclasses")},S=function(e,t){if(n)try{window.sessionStorage.setItem("what-"+e,t)}catch(e){}},_=function(e){return"number"==typeof e.pointerType?g[e.pointerType]:"pen"===e.pointerType?"touch":e.pointerType},P=function(e){var t=Date.now(),e="mouse"===e&&"touch"===o&&t-i<200;return i=t,e},C=function(e){p.x!==e.screenX||p.y!==e.screenY?(d=!1,p.x=e.screenX,p.y=e.screenY):d=!0},k=function(e,t){var i=window.Element.prototype;if(i.matches||(i.matches=i.msMatchesSelector||i.webkitMatchesSelector),i.closest)return e.closest(t);do{if(e.matches(t))return e}while(null!==(e=e.parentElement||e.parentNode)&&1===e.nodeType);return null};return"addEventListener"in window&&Array.prototype.indexOf&&(u[x()]="mouse",b=!!e&&{passive:!0},document.addEventListener("DOMContentLoaded",f),window.PointerEvent?(window.addEventListener("pointerdown",v),window.addEventListener("pointermove",y)):window.MSPointerEvent?(window.addEventListener("MSPointerDown",v),window.addEventListener("MSPointerMove",y)):(window.addEventListener("mousedown",v),window.addEventListener("mousemove",y),"ontouchstart"in window&&(window.addEventListener("touchstart",v,b),window.addEventListener("touchend",v))),window.addEventListener(x(),y,b),window.addEventListener("keydown",v),window.addEventListener("keyup",v),window.addEventListener("focusin",w),window.addEventListener("focusout",E)),{ask:function(e){return"intent"===e?r:o},element:function(){return t},ignoreKeys:function(e){h=e},specificKeys:function(e){c=e},registerOnChange:function(e,t){l.push({fn:e,type:t||"input"})},unRegisterOnChange:function(e){e=function(e){for(var t=0,i=l.length;t<i;t++)if(l[t].fn===e)return t}(e);!e&&0!==e||l.splice(e,1)},clearStorage:function(){window.sessionStorage.clear()}}}()}],i.c=s,i.p="",i(0);function i(e){var t;return(s[e]||(t=s[e]={exports:{},id:e,loaded:!1},n[e].call(t.exports,t,t.exports,i),t.loaded=!0,t)).exports}var n,s}),function(t,i){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(e){return i(t,e)}):"object"==typeof module&&module.exports?module.exports=i(t,require("jquery")):t.jQueryBridget=i(t,t.jQuery)}(window,function(e,t){"use strict";var i=Array.prototype.slice,n=e.console,u=void 0===n?function(){}:function(e){n.error(e)};function s(l,h,c){(c=c||t||e.jQuery)&&(h.prototype.option||(h.prototype.option=function(e){c.isPlainObject(e)&&(this.options=c.extend(!0,this.options,e))}),c.fn[l]=function(e){var t,n,s,o,r,a;return"string"==typeof e?(t=i.call(arguments,1),s=t,r="$()."+l+'("'+(n=e)+'")',(t=this).each(function(e,t){var i,t=c.data(t,l);t?(i=t[n])&&"_"!=n.charAt(0)?(i=i.apply(t,s),o=void 0===o?i:o):u(r+" is not a valid method"):u(l+" not initialized. Cannot call methods, i.e. "+r)}),void 0!==o?o:t):(a=e,this.each(function(e,t){var i=c.data(t,l);i?(i.option(a),i._init()):(i=new h(t,a),c.data(t,l,i))}),this)},o(c))}function o(e){e&&!e.bridget&&(e.bridget=s)}return o(t||e.jQuery),s}),function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){var i;if(e&&t)return-1==(i=(i=this._events=this._events||{})[e]=i[e]||[]).indexOf(t)&&i.push(t),this},t.once=function(e,t){var i;if(e&&t)return this.on(e,t),((i=this._onceEvents=this._onceEvents||{})[e]=i[e]||{})[t]=!0,this},t.off=function(e,t){e=this._events&&this._events[e];if(e&&e.length)return-1!=(t=e.indexOf(t))&&e.splice(t,1),this},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){i=i.slice(0),t=t||[];for(var n=this._onceEvents&&this._onceEvents[e],s=0;s<i.length;s++){var o=i[s];n&&n[o]&&(this.off(e,o),delete n[o]),o.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(e,t){"function"==typeof define&&define.amd?define("get-size/get-size",t):"object"==typeof module&&module.exports?module.exports=t():e.getSize=t()}(window,function(){"use strict";function f(e){var t=parseFloat(e);return-1==e.indexOf("%")&&!isNaN(t)&&t}var t="undefined"==typeof console?function(){}:function(e){console.error(e)},v=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],y=v.length;function w(e){e=getComputedStyle(e);return e||t("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}var x,b=!1;function T(e){if(b||(b=!0,(c=document.createElement("div")).style.width="200px",c.style.padding="1px 2px 3px 4px",c.style.borderStyle="solid",c.style.borderWidth="1px 2px 3px 4px",c.style.boxSizing="border-box",(h=document.body||document.documentElement).appendChild(c),o=w(c),x=200==Math.round(f(o.width)),T.isBoxSizeOuter=x,h.removeChild(c)),(e="string"==typeof e?document.querySelector(e):e)&&"object"==typeof e&&e.nodeType){var t=w(e);if("none"==t.display){for(var i={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},n=0;n<y;n++)i[v[n]]=0;return i}for(var s={},o=(s.width=e.offsetWidth,s.height=e.offsetHeight,s.isBorderBox="border-box"==t.boxSizing),r=0;r<y;r++){var a=v[r],l=t[a],l=parseFloat(l);s[a]=isNaN(l)?0:l}var h=s.paddingLeft+s.paddingRight,c=s.paddingTop+s.paddingBottom,e=s.marginLeft+s.marginRight,u=s.marginTop+s.marginBottom,d=s.borderLeftWidth+s.borderRightWidth,p=s.borderTopWidth+s.borderBottomWidth,g=o&&x,m=f(t.width),m=(!1!==m&&(s.width=m+(g?0:h+d)),f(t.height));return!1!==m&&(s.height=m+(g?0:c+p)),s.innerWidth=s.width-(h+d),s.innerHeight=s.height-(c+p),s.outerWidth=s.width+e,s.outerHeight=s.height+u,s}}return T}),function(e,t){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",t):"object"==typeof module&&module.exports?module.exports=t():e.matchesSelector=t()}(window,function(){"use strict";var i=function(){var e=window.Element.prototype;if(e.matches)return"matches";if(e.matchesSelector)return"matchesSelector";for(var t=["webkit","moz","ms","o"],i=0;i<t.length;i++){var n=t[i]+"MatchesSelector";if(e[n])return n}}();return function(e,t){return e[i](t)}}),function(t,i){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(e){return i(t,e)}):"object"==typeof module&&module.exports?module.exports=i(t,require("desandro-matches-selector")):t.fizzyUIUtils=i(t,t.matchesSelector)}(window,function(i,o){var l={extend:function(e,t){for(var i in t)e[i]=t[i];return e},modulo:function(e,t){return(e%t+t)%t}},t=Array.prototype.slice,h=(l.makeArray=function(e){return Array.isArray(e)?e:null==e?[]:"object"==typeof e&&"number"==typeof e.length?t.call(e):[e]},l.removeFrom=function(e,t){t=e.indexOf(t);-1!=t&&e.splice(t,1)},l.getParent=function(e,t){for(;e.parentNode&&e!=document.body;)if(e=e.parentNode,o(e,t))return e},l.getQueryElement=function(e){return"string"==typeof e?document.querySelector(e):e},l.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},l.filterFindElements=function(e,n){e=l.makeArray(e);var s=[];return e.forEach(function(e){if(e instanceof HTMLElement)if(n){o(e,n)&&s.push(e);for(var t=e.querySelectorAll(n),i=0;i<t.length;i++)s.push(t[i])}else s.push(e)}),s},l.debounceMethod=function(e,t,n){n=n||100;var s=e.prototype[t],o=t+"Timeout";e.prototype[t]=function(){var e=this[o],t=(clearTimeout(e),arguments),i=this;this[o]=setTimeout(function(){s.apply(i,t),delete i[o]},n)}},l.docReady=function(e){var t=document.readyState;"complete"==t||"interactive"==t?setTimeout(e):document.addEventListener("DOMContentLoaded",e)},l.toDashed=function(e){return e.replace(/(.)([A-Z])/g,function(e,t,i){return t+"-"+i}).toLowerCase()},i.console);return l.htmlInit=function(r,a){l.docReady(function(){var e=l.toDashed(a),n="data-"+e,t=document.querySelectorAll("["+n+"]"),e=document.querySelectorAll(".js-"+e),t=l.makeArray(t).concat(l.makeArray(e)),s=n+"-options",o=i.jQuery;t.forEach(function(e){var t=e.getAttribute(n)||e.getAttribute(s);try{i=t&&JSON.parse(t)}catch(t){return void(h&&h.error("Error parsing "+n+" on "+e.className+": "+t))}var i=new r(e,i);o&&o.data(e,a,i)})})},l}),function(e,t){"function"==typeof define&&define.amd?define("flickity/js/cell",["get-size/get-size"],function(e){return t(0,e)}):"object"==typeof module&&module.exports?module.exports=t(0,require("get-size")):(e.Flickity=e.Flickity||{},e.Flickity.Cell=t(0,e.getSize))}(window,function(e,t){function i(e,t){this.element=e,this.parent=t,this.create()}var n=i.prototype;return n.create=function(){this.element.style.position="absolute",this.element.setAttribute("aria-hidden","true"),this.x=0,this.shift=0,this.element.style[this.parent.originSide]=0},n.destroy=function(){this.unselect(),this.element.style.position="";var e=this.parent.originSide;this.element.style[e]="",this.element.style.transform="",this.element.removeAttribute("aria-hidden")},n.getSize=function(){this.size=t(this.element)},n.setPosition=function(e){this.x=e,this.updateTarget(),this.renderPosition(e)},n.updateTarget=n.setDefaultTarget=function(){var e="left"==this.parent.originSide?"marginLeft":"marginRight";this.target=this.x+this.size[e]+this.size.width*this.parent.cellAlign},n.renderPosition=function(e){var t="left"===this.parent.originSide?1:-1,e=this.parent.options.percentPosition?e*t*(this.parent.size.innerWidth/this.size.width):e*t;this.element.style.transform="translateX("+this.parent.getPositionValue(e)+")"},n.select=function(){this.element.classList.add("is-selected"),this.element.removeAttribute("aria-hidden")},n.unselect=function(){this.element.classList.remove("is-selected"),this.element.setAttribute("aria-hidden","true")},n.wrapShift=function(e){this.shift=e,this.renderPosition(this.x+this.parent.slideableWidth*e)},n.remove=function(){this.element.parentNode.removeChild(this.element)},i}),function(e,t){"function"==typeof define&&define.amd?define("flickity/js/slide",t):"object"==typeof module&&module.exports?module.exports=t():(e.Flickity=e.Flickity||{},e.Flickity.Slide=t())}(window,function(){"use strict";function e(e){this.parent=e,this.isOriginLeft="left"==e.originSide,this.cells=[],this.outerWidth=0,this.height=0}var t=e.prototype;return t.addCell=function(e){var t;this.cells.push(e),this.outerWidth+=e.size.outerWidth,this.height=Math.max(e.size.outerHeight,this.height),1==this.cells.length&&(this.x=e.x,t=this.isOriginLeft?"marginLeft":"marginRight",this.firstMargin=e.size[t])},t.updateTarget=function(){var e=this.isOriginLeft?"marginRight":"marginLeft",t=this.getLastCell(),t=t?t.size[e]:0,e=this.outerWidth-(this.firstMargin+t);this.target=this.x+this.firstMargin+e*this.parent.cellAlign},t.getLastCell=function(){return this.cells[this.cells.length-1]},t.select=function(){this.cells.forEach(function(e){e.select()})},t.unselect=function(){this.cells.forEach(function(e){e.unselect()})},t.getCellElements=function(){return this.cells.map(function(e){return e.element})},e}),function(e,t){"function"==typeof define&&define.amd?define("flickity/js/animate",["fizzy-ui-utils/utils"],function(e){return t(0,e)}):"object"==typeof module&&module.exports?module.exports=t(0,require("fizzy-ui-utils")):(e.Flickity=e.Flickity||{},e.Flickity.animatePrototype=t(0,e.fizzyUIUtils))}(window,function(e,t){var i={startAnimation:function(){this.isAnimating||(this.isAnimating=!0,this.restingFrames=0,this.animate())},animate:function(){this.applyDragForce(),this.applySelectedAttraction();var e,t=this.x;this.integratePhysics(),this.positionSlider(),this.settle(t),this.isAnimating&&(e=this,requestAnimationFrame(function(){e.animate()}))},positionSlider:function(){var e=this.x;this.options.wrapAround&&1<this.cells.length&&(e=t.modulo(e,this.slideableWidth),e-=this.slideableWidth,this.shiftWrapCells(e)),this.setTranslateX(e,this.isAnimating),this.dispatchScrollEvent()},setTranslateX:function(e,t){e+=this.cursorPosition,e=this.options.rightToLeft?-e:e;e=this.getPositionValue(e);this.slider.style.transform=t?"translate3d("+e+",0,0)":"translateX("+e+")"},dispatchScrollEvent:function(){var e,t=this.slides[0];t&&(e=(t=-this.x-t.target)/this.slidesWidth,this.dispatchEvent("scroll",null,[e,t]))},positionSliderAtSelected:function(){this.cells.length&&(this.x=-this.selectedSlide.target,this.velocity=0,this.positionSlider())},getPositionValue:function(e){return this.options.percentPosition?.01*Math.round(e/this.size.innerWidth*1e4)+"%":Math.round(e)+"px"},settle:function(e){this.isPointerDown||Math.round(100*this.x)!=Math.round(100*e)||this.restingFrames++,2<this.restingFrames&&(this.isAnimating=!1,delete this.isFreeScrolling,this.positionSlider(),this.dispatchEvent("settle",null,[this.selectedIndex]))},shiftWrapCells:function(e){var t=this.cursorPosition+e,t=(this._shiftCells(this.beforeShiftCells,t,-1),this.size.innerWidth-(e+this.slideableWidth+this.cursorPosition));this._shiftCells(this.afterShiftCells,t,1)},_shiftCells:function(e,t,i){for(var n=0;n<e.length;n++){var s=e[n];s.wrapShift(0<t?i:0),t-=s.size.outerWidth}},_unshiftCells:function(e){if(e&&e.length)for(var t=0;t<e.length;t++)e[t].wrapShift(0)},integratePhysics:function(){this.x+=this.velocity,this.velocity*=this.getFrictionFactor()},applyForce:function(e){this.velocity+=e},getFrictionFactor:function(){return 1-this.options[this.isFreeScrolling?"freeScrollFriction":"friction"]},getRestingPosition:function(){return this.x+this.velocity/(1-this.getFrictionFactor())},applyDragForce:function(){var e;this.isDraggable&&this.isPointerDown&&(e=this.dragX-this.x-this.velocity,this.applyForce(e))},applySelectedAttraction:function(){var e;this.isDraggable&&this.isPointerDown||this.isFreeScrolling||!this.slides.length||(e=(-1*this.selectedSlide.target-this.x)*this.options.selectedAttraction,this.applyForce(e))}};return i}),function(r,a){var e;"function"==typeof define&&define.amd?define("flickity/js/flickity",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./cell","./slide","./animate"],function(e,t,i,n,s,o){return a(r,e,t,i,n,s,o)}):"object"==typeof module&&module.exports?module.exports=a(r,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./cell"),require("./slide"),require("./animate")):(e=r.Flickity,r.Flickity=a(r,r.EvEmitter,r.getSize,r.fizzyUIUtils,e.Cell,e.Slide,e.animatePrototype))}(window,function(n,e,t,r,i,a,s){var o=n.jQuery,l=n.getComputedStyle,h=n.console;function c(e,t){for(e=r.makeArray(e);e.length;)t.appendChild(e.shift())}var u=0,d={};function p(e,t){var i,n=r.getQueryElement(e);if(n){if(this.element=n,this.element.flickityGUID)return(i=d[this.element.flickityGUID])&&i.option(t),i;o&&(this.$element=o(this.element)),this.options=r.extend({},this.constructor.defaults),this.option(t),this._create()}else h&&h.error("Bad element for Flickity: "+(n||e))}p.defaults={accessibility:!0,cellAlign:"center",freeScrollFriction:.075,friction:.28,namespaceJQueryEvents:!0,percentPosition:!0,resize:!0,selectedAttraction:.025,setGallerySize:!0},p.createMethods=[];var g=p.prototype,m=(r.extend(g,e.prototype),g._create=function(){var e,t=this.guid=++u;for(e in this.element.flickityGUID=t,(d[t]=this).selectedIndex=0,this.restingFrames=0,this.x=0,this.velocity=0,this.originSide=this.options.rightToLeft?"right":"left",this.viewport=document.createElement("div"),this.viewport.className="flickity-viewport",this._createSlider(),(this.options.resize||this.options.watchCSS)&&n.addEventListener("resize",this),this.options.on){var i=this.options.on[e];this.on(e,i)}p.createMethods.forEach(function(e){this[e]()},this),this.options.watchCSS?this.watchCSS():this.activate()},g.option=function(e){r.extend(this.options,e)},g.activate=function(){this.isActive||(this.isActive=!0,this.element.classList.add("flickity-enabled"),this.options.rightToLeft&&this.element.classList.add("flickity-rtl"),this.getSize(),c(this._filterFindCellElements(this.element.children),this.slider),this.viewport.appendChild(this.slider),this.element.appendChild(this.viewport),this.reloadCells(),this.options.accessibility&&(this.element.tabIndex=0,this.element.addEventListener("keydown",this)),this.emitEvent("activate"),this.selectInitialIndex(),this.isInitActivated=!0,this.dispatchEvent("ready"))},g._createSlider=function(){var e=document.createElement("div");e.className="flickity-slider",e.style[this.originSide]=0,this.slider=e},g._filterFindCellElements=function(e){return r.filterFindElements(e,this.options.cellSelector)},g.reloadCells=function(){this.cells=this._makeCells(this.slider.children),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize()},g._makeCells=function(e){return this._filterFindCellElements(e).map(function(e){return new i(e,this)},this)},g.getLastCell=function(){return this.cells[this.cells.length-1]},g.getLastSlide=function(){return this.slides[this.slides.length-1]},g.positionCells=function(){this._sizeCells(this.cells),this._positionCells(0)},g._positionCells=function(e){this.maxCellHeight=(e=e||0)&&this.maxCellHeight||0;for(var t,i=0,n=(0<e&&(i=(t=this.cells[e-1]).x+t.size.outerWidth),this.cells.length),s=e;s<n;s++){var o=this.cells[s];o.setPosition(i),i+=o.size.outerWidth,this.maxCellHeight=Math.max(o.size.outerHeight,this.maxCellHeight)}this.slideableWidth=i,this.updateSlides(),this._containSlides(),this.slidesWidth=n?this.getLastSlide().target-this.slides[0].target:0},g._sizeCells=function(e){e.forEach(function(e){e.getSize()})},g.updateSlides=function(){var n,s,o;this.slides=[],this.cells.length&&(n=new a(this),this.slides.push(n),s="left"==this.originSide?"marginRight":"marginLeft",o=this._getCanCellFit(),this.cells.forEach(function(e,t){var i;n.cells.length&&(i=n.outerWidth-n.firstMargin+(e.size.outerWidth-e.size[s]),o.call(this,t,i)||(n.updateTarget(),n=new a(this),this.slides.push(n))),n.addCell(e)},this),n.updateTarget(),this.updateSelectedSlide())},g._getCanCellFit=function(){var t,i,e=this.options.groupCells;return e?"number"==typeof e?(t=parseInt(e,10),function(e){return e%t!=0}):(e="string"==typeof e&&e.match(/^(\d+)%$/),i=e?parseInt(e[1],10)/100:1,function(e,t){return t<=(this.size.innerWidth+1)*i}):function(){return!1}},g._init=g.reposition=function(){this.positionCells(),this.positionSliderAtSelected()},g.getSize=function(){this.size=t(this.element),this.setCellAlign(),this.cursorPosition=this.size.innerWidth*this.cellAlign},{center:{left:.5,right:.5},left:{left:0,right:1},right:{right:0,left:1}});return g.setCellAlign=function(){var e=m[this.options.cellAlign];this.cellAlign=e?e[this.originSide]:this.options.cellAlign},g.setGallerySize=function(){var e;this.options.setGallerySize&&(e=this.options.adaptiveHeight&&this.selectedSlide?this.selectedSlide.height:this.maxCellHeight,this.viewport.style.height=e+"px")},g._getWrapShiftCells=function(){var e,t;this.options.wrapAround&&(this._unshiftCells(this.beforeShiftCells),this._unshiftCells(this.afterShiftCells),e=this.cursorPosition,t=this.cells.length-1,this.beforeShiftCells=this._getGapCells(e,t,-1),e=this.size.innerWidth-this.cursorPosition,this.afterShiftCells=this._getGapCells(e,0,1))},g._getGapCells=function(e,t,i){for(var n=[];0<e;){var s=this.cells[t];if(!s)break;n.push(s),t+=i,e-=s.size.outerWidth}return n},g._containSlides=function(){var e,t,i,n,s,o;this.options.contain&&!this.options.wrapAround&&this.cells.length&&(e=(t=this.options.rightToLeft)?"marginRight":"marginLeft",t=t?"marginLeft":"marginRight",i=this.slideableWidth-this.getLastCell().size[t],n=i<this.size.innerWidth,s=this.cursorPosition+this.cells[0].size[e],o=i-this.size.innerWidth*(1-this.cellAlign),this.slides.forEach(function(e){n?e.target=i*this.cellAlign:(e.target=Math.max(e.target,s),e.target=Math.min(e.target,o))},this))},g.dispatchEvent=function(e,t,i){var n=t?[t].concat(i):i;this.emitEvent(e,n),o&&this.$element&&(n=e+=this.options.namespaceJQueryEvents?".flickity":"",t&&((t=new o.Event(t)).type=e,n=t),this.$element.trigger(n,i))},g.select=function(e,t,i){this.isActive&&(e=parseInt(e,10),this._wrapSelect(e),(this.options.wrapAround||t)&&(e=r.modulo(e,this.slides.length)),this.slides[e])&&(t=this.selectedIndex,this.selectedIndex=e,this.updateSelectedSlide(),i?this.positionSliderAtSelected():this.startAnimation(),this.options.adaptiveHeight&&this.setGallerySize(),this.dispatchEvent("select",null,[e]),e!=t&&this.dispatchEvent("change",null,[e]),this.dispatchEvent("cellSelect"))},g._wrapSelect=function(e){var t=this.slides.length;if(!(this.options.wrapAround&&1<t))return e;var i=r.modulo(e,t),n=Math.abs(i-this.selectedIndex),s=Math.abs(i+t-this.selectedIndex),i=Math.abs(i-t-this.selectedIndex);!this.isDragSelect&&s<n?e+=t:!this.isDragSelect&&i<n&&(e-=t),e<0?this.x-=this.slideableWidth:t<=e&&(this.x+=this.slideableWidth)},g.previous=function(e,t){this.select(this.selectedIndex-1,e,t)},g.next=function(e,t){this.select(this.selectedIndex+1,e,t)},g.updateSelectedSlide=function(){var e=this.slides[this.selectedIndex];e&&(this.unselectSelectedSlide(),(this.selectedSlide=e).select(),this.selectedCells=e.cells,this.selectedElements=e.getCellElements(),this.selectedCell=e.cells[0],this.selectedElement=this.selectedElements[0])},g.unselectSelectedSlide=function(){this.selectedSlide&&this.selectedSlide.unselect()},g.selectInitialIndex=function(){var e=this.options.initialIndex;if(this.isInitActivated)this.select(this.selectedIndex,!1,!0);else{if(e&&"string"==typeof e)if(this.queryCell(e))return void this.selectCell(e,!1,!0);var t=0;e&&this.slides[e]&&(t=e),this.select(t,!1,!0)}},g.selectCell=function(e,t,i){var e=this.queryCell(e);e&&(e=this.getCellSlideIndex(e),this.select(e,t,i))},g.getCellSlideIndex=function(e){for(var t=0;t<this.slides.length;t++)if(-1!=this.slides[t].cells.indexOf(e))return t},g.getCell=function(e){for(var t=0;t<this.cells.length;t++){var i=this.cells[t];if(i.element==e)return i}},g.getCells=function(e){e=r.makeArray(e);var t=[];return e.forEach(function(e){e=this.getCell(e);e&&t.push(e)},this),t},g.getCellElements=function(){return this.cells.map(function(e){return e.element})},g.getParentCell=function(e){var t=this.getCell(e);return t||(e=r.getParent(e,".flickity-slider > *"),this.getCell(e))},g.getAdjacentCellElements=function(e,t){if(!e)return this.selectedSlide.getCellElements();t=void 0===t?this.selectedIndex:t;var i=this.slides.length;if(i<=1+2*e)return this.getCellElements();for(var n=[],s=t-e;s<=t+e;s++){var o=this.options.wrapAround?r.modulo(s,i):s,o=this.slides[o];o&&(n=n.concat(o.getCellElements()))}return n},g.queryCell=function(e){if("number"==typeof e)return this.cells[e];if("string"==typeof e){if(e.match(/^[#.]?[\d/]/))return;e=this.element.querySelector(e)}return this.getCell(e)},g.uiChange=function(){this.emitEvent("uiChange")},g.childUIPointerDown=function(e){"touchstart"!=e.type&&e.preventDefault(),this.focus()},g.onresize=function(){this.watchCSS(),this.resize()},r.debounceMethod(p,"onresize",150),g.resize=function(){var e;!this.isActive||this.isAnimating||this.isDragging||(this.getSize(),this.options.wrapAround&&(this.x=r.modulo(this.x,this.slideableWidth)),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize(),this.emitEvent("resize"),e=this.selectedElements&&this.selectedElements[0],this.selectCell(e,!1,!0))},g.watchCSS=function(){this.options.watchCSS&&(-1!=l(this.element,":after").content.indexOf("flickity")?this.activate():this.deactivate())},g.onkeydown=function(e){var t=document.activeElement&&document.activeElement!=this.element;this.options.accessibility&&!t&&(t=p.keyboardHandlers[e.keyCode])&&t.call(this)},p.keyboardHandlers={37:function(){var e=this.options.rightToLeft?"next":"previous";this.uiChange(),this[e]()},39:function(){var e=this.options.rightToLeft?"previous":"next";this.uiChange(),this[e]()}},g.focus=function(){var e=n.pageYOffset;this.element.focus({preventScroll:!0}),n.pageYOffset!=e&&n.scrollTo(n.pageXOffset,e)},g.deactivate=function(){this.isActive&&(this.element.classList.remove("flickity-enabled"),this.element.classList.remove("flickity-rtl"),this.unselectSelectedSlide(),this.cells.forEach(function(e){e.destroy()}),this.element.removeChild(this.viewport),c(this.slider.children,this.element),this.options.accessibility&&(this.element.removeAttribute("tabIndex"),this.element.removeEventListener("keydown",this)),this.isActive=!1,this.emitEvent("deactivate"))},g.destroy=function(){this.deactivate(),n.removeEventListener("resize",this),this.allOff(),this.emitEvent("destroy"),o&&this.$element&&o.removeData(this.element,"flickity"),delete this.element.flickityGUID,delete d[this.guid]},r.extend(g,s),p.data=function(e){e=(e=r.getQueryElement(e))&&e.flickityGUID;return e&&d[e]},r.htmlInit(p,"flickity"),o&&o.bridget&&o.bridget("flickity",p),p.setJQuery=function(e){o=e},p.Cell=i,p.Slide=a,p}),function(t,i){"function"==typeof define&&define.amd?define("unipointer/unipointer",["ev-emitter/ev-emitter"],function(e){return i(t,e)}):"object"==typeof module&&module.exports?module.exports=i(t,require("ev-emitter")):t.Unipointer=i(t,t.EvEmitter)}(window,function(n,e){function t(){}var e=t.prototype=Object.create(e.prototype),i=(e.bindStartEvent=function(e){this._bindStartEvent(e,!0)},e.unbindStartEvent=function(e){this._bindStartEvent(e,!1)},e._bindStartEvent=function(e,t){var t=(t=void 0===t||t)?"addEventListener":"removeEventListener",i="mousedown";"ontouchstart"in n?i="touchstart":n.PointerEvent&&(i="pointerdown"),e[t](i,this)},e.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},e.getTouch=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i.identifier==this.pointerIdentifier)return i}},e.onmousedown=function(e){var t=e.button;t&&0!==t&&1!==t||this._pointerDown(e,e)},e.ontouchstart=function(e){this._pointerDown(e,e.changedTouches[0])},e.onpointerdown=function(e){this._pointerDown(e,e)},e._pointerDown=function(e,t){e.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==t.pointerId?t.pointerId:t.identifier,this.pointerDown(e,t))},e.pointerDown=function(e,t){this._bindPostStartEvents(e),this.emitEvent("pointerDown",[e,t])},{mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]});return e._bindPostStartEvents=function(e){e&&((e=i[e.type]).forEach(function(e){n.addEventListener(e,this)},this),this._boundPointerEvents=e)},e._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(e){n.removeEventListener(e,this)},this),delete this._boundPointerEvents)},e.onmousemove=function(e){this._pointerMove(e,e)},e.onpointermove=function(e){e.pointerId==this.pointerIdentifier&&this._pointerMove(e,e)},e.ontouchmove=function(e){var t=this.getTouch(e.changedTouches);t&&this._pointerMove(e,t)},e._pointerMove=function(e,t){this.pointerMove(e,t)},e.pointerMove=function(e,t){this.emitEvent("pointerMove",[e,t])},e.onmouseup=function(e){this._pointerUp(e,e)},e.onpointerup=function(e){e.pointerId==this.pointerIdentifier&&this._pointerUp(e,e)},e.ontouchend=function(e){var t=this.getTouch(e.changedTouches);t&&this._pointerUp(e,t)},e._pointerUp=function(e,t){this._pointerDone(),this.pointerUp(e,t)},e.pointerUp=function(e,t){this.emitEvent("pointerUp",[e,t])},e._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},e._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},e.pointerDone=function(){},e.onpointercancel=function(e){e.pointerId==this.pointerIdentifier&&this._pointerCancel(e,e)},e.ontouchcancel=function(e){var t=this.getTouch(e.changedTouches);t&&this._pointerCancel(e,t)},e._pointerCancel=function(e,t){this._pointerDone(),this.pointerCancel(e,t)},e.pointerCancel=function(e,t){this.emitEvent("pointerCancel",[e,t])},t.getPointerPoint=function(e){return{x:e.pageX,y:e.pageY}},t}),function(t,i){"function"==typeof define&&define.amd?define("unidragger/unidragger",["unipointer/unipointer"],function(e){return i(t,e)}):"object"==typeof module&&module.exports?module.exports=i(t,require("unipointer")):t.Unidragger=i(t,t.Unipointer)}(window,function(o,e){function t(){}var i=t.prototype=Object.create(e.prototype),n=(i.bindHandles=function(){this._bindHandles(!0)},i.unbindHandles=function(){this._bindHandles(!1)},i._bindHandles=function(e){for(var t=(e=void 0===e||e)?"addEventListener":"removeEventListener",i=e?this._touchActionValue:"",n=0;n<this.handles.length;n++){var s=this.handles[n];this._bindStartEvent(s,e),s[t]("click",this),o.PointerEvent&&(s.style.touchAction=i)}},i._touchActionValue="none",i.pointerDown=function(e,t){this.okayPointerDown(e)&&(this.pointerDownPointer={pageX:t.pageX,pageY:t.pageY},e.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(e),this.emitEvent("pointerDown",[e,t]))},{TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0}),s={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return i.okayPointerDown=function(e){var t=n[e.target.nodeName],e=s[e.target.type],t=!t||e;return t||this._pointerReset(),t},i.pointerDownBlur=function(){var e=document.activeElement;e&&e.blur&&e!=document.body&&e.blur()},i.pointerMove=function(e,t){var i=this._dragPointerMove(e,t);this.emitEvent("pointerMove",[e,t,i]),this._dragMove(e,t,i)},i._dragPointerMove=function(e,t){var i={x:t.pageX-this.pointerDownPointer.pageX,y:t.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(i)&&this._dragStart(e,t),i},i.hasDragStarted=function(e){return 3<Math.abs(e.x)||3<Math.abs(e.y)},i.pointerUp=function(e,t){this.emitEvent("pointerUp",[e,t]),this._dragPointerUp(e,t)},i._dragPointerUp=function(e,t){this.isDragging?this._dragEnd(e,t):this._staticClick(e,t)},i._dragStart=function(e,t){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(e,t)},i.dragStart=function(e,t){this.emitEvent("dragStart",[e,t])},i._dragMove=function(e,t,i){this.isDragging&&this.dragMove(e,t,i)},i.dragMove=function(e,t,i){e.preventDefault(),this.emitEvent("dragMove",[e,t,i])},i._dragEnd=function(e,t){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(e,t)},i.dragEnd=function(e,t){this.emitEvent("dragEnd",[e,t])},i.onclick=function(e){this.isPreventingClicks&&e.preventDefault()},i._staticClick=function(e,t){this.isIgnoringMouseUp&&"mouseup"==e.type||(this.staticClick(e,t),"mouseup"!=e.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},i.staticClick=function(e,t){this.emitEvent("staticClick",[e,t])},t.getPointerPoint=e.getPointerPoint,t}),function(n,s){"function"==typeof define&&define.amd?define("flickity/js/drag",["./flickity","unidragger/unidragger","fizzy-ui-utils/utils"],function(e,t,i){return s(n,e,t,i)}):"object"==typeof module&&module.exports?module.exports=s(n,require("./flickity"),require("unidragger"),require("fizzy-ui-utils")):n.Flickity=s(n,n.Flickity,n.Unidragger,n.fizzyUIUtils)}(window,function(i,e,t,o){o.extend(e.defaults,{draggable:">1",dragThreshold:3}),e.createMethods.push("_createDrag");var n=e.prototype,s=(o.extend(n,t.prototype),n._touchActionValue="pan-y",n._createDrag=function(){this.on("activate",this.onActivateDrag),this.on("uiChange",this._uiChangeDrag),this.on("deactivate",this.onDeactivateDrag),this.on("cellChange",this.updateDraggable)},n.onActivateDrag=function(){this.handles=[this.viewport],this.bindHandles(),this.updateDraggable()},n.onDeactivateDrag=function(){this.unbindHandles(),this.element.classList.remove("is-draggable")},n.updateDraggable=function(){">1"==this.options.draggable?this.isDraggable=1<this.slides.length:this.isDraggable=this.options.draggable,this.isDraggable?this.element.classList.add("is-draggable"):this.element.classList.remove("is-draggable")},n.bindDrag=function(){this.options.draggable=!0,this.updateDraggable()},n.unbindDrag=function(){this.options.draggable=!1,this.updateDraggable()},n._uiChangeDrag=function(){delete this.isFreeScrolling},n.pointerDown=function(e,t){this.isDraggable?this.okayPointerDown(e)&&(this._pointerDownPreventDefault(e),this.pointerDownFocus(e),document.activeElement!=this.element&&this.pointerDownBlur(),this.dragX=this.x,this.viewport.classList.add("is-pointer-down"),this.pointerDownScroll=r(),i.addEventListener("scroll",this),this._pointerDownDefault(e,t)):this._pointerDownDefault(e,t)},n._pointerDownDefault=function(e,t){this.pointerDownPointer={pageX:t.pageX,pageY:t.pageY},this._bindPostStartEvents(e),this.dispatchEvent("pointerDown",e,[t])},{INPUT:!0,TEXTAREA:!0,SELECT:!0});function r(){return{x:i.pageXOffset,y:i.pageYOffset}}return n.pointerDownFocus=function(e){s[e.target.nodeName]||this.focus()},n._pointerDownPreventDefault=function(e){var t="touchstart"==e.type,i="touch"==e.pointerType,n=s[e.target.nodeName];t||i||n||e.preventDefault()},n.hasDragStarted=function(e){return Math.abs(e.x)>this.options.dragThreshold},n.pointerUp=function(e,t){delete this.isTouchScrolling,this.viewport.classList.remove("is-pointer-down"),this.dispatchEvent("pointerUp",e,[t]),this._dragPointerUp(e,t)},n.pointerDone=function(){i.removeEventListener("scroll",this),delete this.pointerDownScroll},n.dragStart=function(e,t){this.isDraggable&&(this.dragStartPosition=this.x,this.startAnimation(),i.removeEventListener("scroll",this),this.dispatchEvent("dragStart",e,[t]))},n.pointerMove=function(e,t){var i=this._dragPointerMove(e,t);this.dispatchEvent("pointerMove",e,[t,i]),this._dragMove(e,t,i)},n.dragMove=function(e,t,i){var n,s;this.isDraggable&&(e.preventDefault(),this.previousDragX=this.dragX,n=this.options.rightToLeft?-1:1,this.options.wrapAround&&(i.x%=this.slideableWidth),n=this.dragStartPosition+i.x*n,!this.options.wrapAround&&this.slides.length&&(n=(n=(s=Math.max(-this.slides[0].target,this.dragStartPosition))<n?.5*(n+s):n)<(s=Math.min(-this.getLastSlide().target,this.dragStartPosition))?.5*(n+s):n),this.dragX=n,this.dragMoveTime=new Date,this.dispatchEvent("dragMove",e,[t,i]))},n.dragEnd=function(e,t){var i,n;this.isDraggable&&(this.options.freeScroll&&(this.isFreeScrolling=!0),i=this.dragEndRestingSelect(),this.options.freeScroll&&!this.options.wrapAround?(n=this.getRestingPosition(),this.isFreeScrolling=-n>this.slides[0].target&&-n<this.getLastSlide().target):this.options.freeScroll||i!=this.selectedIndex||(i+=this.dragEndBoostSelect()),delete this.previousDragX,this.isDragSelect=this.options.wrapAround,this.select(i),delete this.isDragSelect,this.dispatchEvent("dragEnd",e,[t]))},n.dragEndRestingSelect=function(){var e=this.getRestingPosition(),t=Math.abs(this.getSlideDistance(-e,this.selectedIndex)),i=this._getClosestResting(e,t,1),e=this._getClosestResting(e,t,-1);return(i.distance<e.distance?i:e).index},n._getClosestResting=function(e,t,i){for(var n=this.selectedIndex,s=1/0,o=this.options.contain&&!this.options.wrapAround?function(e,t){return e<=t}:function(e,t){return e<t};o(t,s)&&(s=t,null!==(t=this.getSlideDistance(-e,n+=i)));)t=Math.abs(t);return{distance:s,index:n-i}},n.getSlideDistance=function(e,t){var i=this.slides.length,n=this.options.wrapAround&&1<i,s=n?o.modulo(t,i):t,s=this.slides[s];return s?(n=n?this.slideableWidth*Math.floor(t/i):0,e-(s.target+n)):null},n.dragEndBoostSelect=function(){var e,t;return void 0===this.previousDragX||!this.dragMoveTime||100<new Date-this.dragMoveTime?0:(e=this.getSlideDistance(-this.dragX,this.selectedIndex),t=this.previousDragX-this.dragX,0<e&&0<t?1:e<0&&t<0?-1:0)},n.staticClick=function(e,t){var i=this.getParentCell(e.target),n=i&&i.element,i=i&&this.cells.indexOf(i);this.dispatchEvent("staticClick",e,[t,n,i])},n.onscroll=function(){var e=r(),t=this.pointerDownScroll.x-e.x,e=this.pointerDownScroll.y-e.y;(3<Math.abs(t)||3<Math.abs(e))&&this._pointerDone()},e}),function(e,n){"function"==typeof define&&define.amd?define("flickity/js/prev-next-button",["./flickity","unipointer/unipointer","fizzy-ui-utils/utils"],function(e,t,i){return n(0,e,t,i)}):"object"==typeof module&&module.exports?module.exports=n(0,require("./flickity"),require("unipointer"),require("fizzy-ui-utils")):n(0,e.Flickity,e.Unipointer,e.fizzyUIUtils)}(window,function(e,t,i,n){"use strict";var s="http://www.w3.org/2000/svg";function o(e,t){this.direction=e,this.parent=t,this._create()}(o.prototype=Object.create(i.prototype))._create=function(){this.isEnabled=!0,this.isPrevious=-1==this.direction;var e=this.parent.options.rightToLeft?1:-1,e=(this.isLeft=this.direction==e,this.element=document.createElement("button")),t=(e.className="flickity-button flickity-prev-next-button",e.className+=this.isPrevious?" previous":" next",e.setAttribute("type","button"),this.disable(),e.setAttribute("aria-label",this.isPrevious?"Previous":"Next"),this.createSVG());e.appendChild(t),this.parent.on("select",this.update.bind(this)),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},o.prototype.activate=function(){this.bindStartEvent(this.element),this.element.addEventListener("click",this),this.parent.element.appendChild(this.element)},o.prototype.deactivate=function(){this.parent.element.removeChild(this.element),this.unbindStartEvent(this.element),this.element.removeEventListener("click",this)},o.prototype.createSVG=function(){var e=document.createElementNS(s,"svg"),t=(e.setAttribute("class","flickity-button-icon"),e.setAttribute("viewBox","0 0 100 100"),document.createElementNS(s,"path")),i="string"!=typeof(i=this.parent.options.arrowShape)?"M "+i.x0+",50 L "+i.x1+","+(i.y1+50)+" L "+i.x2+","+(i.y2+50)+" L "+i.x3+",50  L "+i.x2+","+(50-i.y2)+" L "+i.x1+","+(50-i.y1)+" Z":i;return t.setAttribute("d",i),t.setAttribute("class","arrow"),this.isLeft||t.setAttribute("transform","translate(100, 100) rotate(180) "),e.appendChild(t),e},o.prototype.handleEvent=n.handleEvent,o.prototype.onclick=function(){var e;this.isEnabled&&(this.parent.uiChange(),e=this.isPrevious?"previous":"next",this.parent[e]())},o.prototype.enable=function(){this.isEnabled||(this.element.disabled=!1,this.isEnabled=!0)},o.prototype.disable=function(){this.isEnabled&&(this.element.disabled=!0,this.isEnabled=!1)},o.prototype.update=function(){var e=this.parent.slides;this.parent.options.wrapAround&&1<e.length?this.enable():(e=e.length?e.length-1:0,e=this.isPrevious?0:e,this[this.parent.selectedIndex==e?"disable":"enable"]())},o.prototype.destroy=function(){this.deactivate(),this.allOff()},n.extend(t.defaults,{prevNextButtons:!0,arrowShape:{x0:10,x1:60,y1:50,x2:70,y2:40,x3:30}}),t.createMethods.push("_createPrevNextButtons");i=t.prototype;return i._createPrevNextButtons=function(){this.options.prevNextButtons&&(this.prevButton=new o(-1,this),this.nextButton=new o(1,this),this.on("activate",this.activatePrevNextButtons))},i.activatePrevNextButtons=function(){this.prevButton.activate(),this.nextButton.activate(),this.on("deactivate",this.deactivatePrevNextButtons)},i.deactivatePrevNextButtons=function(){this.prevButton.deactivate(),this.nextButton.deactivate(),this.off("deactivate",this.deactivatePrevNextButtons)},t.PrevNextButton=o,t}),function(e,n){"function"==typeof define&&define.amd?define("flickity/js/page-dots",["./flickity","unipointer/unipointer","fizzy-ui-utils/utils"],function(e,t,i){return n(0,e,t,i)}):"object"==typeof module&&module.exports?module.exports=n(0,require("./flickity"),require("unipointer"),require("fizzy-ui-utils")):n(0,e.Flickity,e.Unipointer,e.fizzyUIUtils)}(window,function(e,t,i,n){function s(e){this.parent=e,this._create()}(s.prototype=Object.create(i.prototype))._create=function(){this.holder=document.createElement("ol"),this.holder.className="flickity-page-dots",this.dots=[],this.handleClick=this.onClick.bind(this),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},s.prototype.activate=function(){this.setDots(),this.holder.addEventListener("click",this.handleClick),this.bindStartEvent(this.holder),this.parent.element.appendChild(this.holder)},s.prototype.deactivate=function(){this.holder.removeEventListener("click",this.handleClick),this.unbindStartEvent(this.holder),this.parent.element.removeChild(this.holder)},s.prototype.setDots=function(){var e=this.parent.slides.length-this.dots.length;0<e?this.addDots(e):e<0&&this.removeDots(-e)},s.prototype.addDots=function(e){for(var t=document.createDocumentFragment(),i=[],n=this.dots.length,s=n+e,o=n;o<s;o++){var r=document.createElement("li");r.className="dot",r.setAttribute("aria-label","Page dot "+(o+1)),t.appendChild(r),i.push(r)}this.holder.appendChild(t),this.dots=this.dots.concat(i)},s.prototype.removeDots=function(e){this.dots.splice(this.dots.length-e,e).forEach(function(e){this.holder.removeChild(e)},this)},s.prototype.updateSelected=function(){this.selectedDot&&(this.selectedDot.className="dot",this.selectedDot.removeAttribute("aria-current")),this.dots.length&&(this.selectedDot=this.dots[this.parent.selectedIndex],this.selectedDot.className="dot is-selected",this.selectedDot.setAttribute("aria-current","step"))},s.prototype.onTap=s.prototype.onClick=function(e){var e=e.target;"LI"==e.nodeName&&(this.parent.uiChange(),e=this.dots.indexOf(e),this.parent.select(e))},s.prototype.destroy=function(){this.deactivate(),this.allOff()},t.PageDots=s,n.extend(t.defaults,{pageDots:!0}),t.createMethods.push("_createPageDots");i=t.prototype;return i._createPageDots=function(){this.options.pageDots&&(this.pageDots=new s(this),this.on("activate",this.activatePageDots),this.on("select",this.updateSelectedPageDots),this.on("cellChange",this.updatePageDots),this.on("resize",this.updatePageDots),this.on("deactivate",this.deactivatePageDots))},i.activatePageDots=function(){this.pageDots.activate()},i.updateSelectedPageDots=function(){this.pageDots.updateSelected()},i.updatePageDots=function(){this.pageDots.setDots()},i.deactivatePageDots=function(){this.pageDots.deactivate()},t.PageDots=s,t}),function(e,t){"function"==typeof define&&define.amd?define("flickity/js/player",["ev-emitter/ev-emitter","fizzy-ui-utils/utils","./flickity"],t):"object"==typeof module&&module.exports?module.exports=t(require("ev-emitter"),require("fizzy-ui-utils"),require("./flickity")):t(e.EvEmitter,e.fizzyUIUtils,e.Flickity)}(window,function(e,t,i){function n(e){this.parent=e,this.state="stopped",this.onVisibilityChange=this.visibilityChange.bind(this),this.onVisibilityPlay=this.visibilityPlay.bind(this)}(n.prototype=Object.create(e.prototype)).play=function(){"playing"!=this.state&&(document.hidden?document.addEventListener("visibilitychange",this.onVisibilityPlay):(this.state="playing",document.addEventListener("visibilitychange",this.onVisibilityChange),this.tick()))},n.prototype.tick=function(){var e,t;"playing"==this.state&&(e="number"==typeof(e=this.parent.options.autoPlay)?e:3e3,(t=this).clear(),this.timeout=setTimeout(function(){t.parent.next(!0),t.tick()},e))},n.prototype.stop=function(){this.state="stopped",this.clear(),document.removeEventListener("visibilitychange",this.onVisibilityChange)},n.prototype.clear=function(){clearTimeout(this.timeout)},n.prototype.pause=function(){"playing"==this.state&&(this.state="paused",this.clear())},n.prototype.unpause=function(){"paused"==this.state&&this.play()},n.prototype.visibilityChange=function(){this[document.hidden?"pause":"unpause"]()},n.prototype.visibilityPlay=function(){this.play(),document.removeEventListener("visibilitychange",this.onVisibilityPlay)},t.extend(i.defaults,{pauseAutoPlayOnHover:!0}),i.createMethods.push("_createPlayer");e=i.prototype;return e._createPlayer=function(){this.player=new n(this),this.on("activate",this.activatePlayer),this.on("uiChange",this.stopPlayer),this.on("pointerDown",this.stopPlayer),this.on("deactivate",this.deactivatePlayer)},e.activatePlayer=function(){this.options.autoPlay&&(this.player.play(),this.element.addEventListener("mouseenter",this))},e.playPlayer=function(){this.player.play()},e.stopPlayer=function(){this.player.stop()},e.pausePlayer=function(){this.player.pause()},e.unpausePlayer=function(){this.player.unpause()},e.deactivatePlayer=function(){this.player.stop(),this.element.removeEventListener("mouseenter",this)},e.onmouseenter=function(){this.options.pauseAutoPlayOnHover&&(this.player.pause(),this.element.addEventListener("mouseleave",this))},e.onmouseleave=function(){this.player.unpause(),this.element.removeEventListener("mouseleave",this)},i.Player=n,i}),function(e,i){"function"==typeof define&&define.amd?define("flickity/js/add-remove-cell",["./flickity","fizzy-ui-utils/utils"],function(e,t){return i(0,e,t)}):"object"==typeof module&&module.exports?module.exports=i(0,require("./flickity"),require("fizzy-ui-utils")):i(0,e.Flickity,e.fizzyUIUtils)}(window,function(e,t,n){var i=t.prototype;return i.insert=function(e,t){var i,n,s,o,r,e=this._makeCells(e);e&&e.length&&(i=this.cells.length,t=void 0===t?i:t,r=e,n=document.createDocumentFragment(),r.forEach(function(e){n.appendChild(e.element)}),r=n,(s=t==i)?this.slider.appendChild(r):(o=this.cells[t].element,this.slider.insertBefore(r,o)),0===t?this.cells=e.concat(this.cells):s?this.cells=this.cells.concat(e):(r=this.cells.splice(t,i-t),this.cells=this.cells.concat(e).concat(r)),this._sizeCells(e),this.cellChange(t,!0))},i.append=function(e){this.insert(e,this.cells.length)},i.prepend=function(e){this.insert(e,0)},i.remove=function(e){var i,e=this.getCells(e);e&&e.length&&(i=this.cells.length-1,e.forEach(function(e){e.remove();var t=this.cells.indexOf(e);i=Math.min(t,i),n.removeFrom(this.cells,e)},this),this.cellChange(i,!0))},i.cellSizeChange=function(e){var e=this.getCell(e);e&&(e.getSize(),e=this.cells.indexOf(e),this.cellChange(e))},i.cellChange=function(e,t){var i=this.selectedElement,i=(this._positionCells(e),this._getWrapShiftCells(),this.setGallerySize(),this.getCell(i));i&&(this.selectedIndex=this.getCellSlideIndex(i)),this.selectedIndex=Math.min(this.slides.length-1,this.selectedIndex),this.emitEvent("cellChange",[e]),this.select(this.selectedIndex),t&&this.positionSliderAtSelected()},t}),function(e,i){"function"==typeof define&&define.amd?define("flickity/js/lazyload",["./flickity","fizzy-ui-utils/utils"],function(e,t){return i(0,e,t)}):"object"==typeof module&&module.exports?module.exports=i(0,require("./flickity"),require("fizzy-ui-utils")):i(0,e.Flickity,e.fizzyUIUtils)}(window,function(e,t,s){"use strict";t.createMethods.push("_createLazyload");var i=t.prototype;function n(e,t){this.img=e,this.flickity=t,this.load()}return i._createLazyload=function(){this.on("select",this.lazyLoad)},i.lazyLoad=function(){var t,e=this.options.lazyLoad;e&&(e=this.getAdjacentCellElements("number"==typeof e?e:0),t=[],e.forEach(function(e){e=function(e){if("IMG"==e.nodeName){var t=e.getAttribute("data-flickity-lazyload"),i=e.getAttribute("data-flickity-lazyload-src"),n=e.getAttribute("data-flickity-lazyload-srcset");if(t||i||n)return[e]}t=e.querySelectorAll("img[data-flickity-lazyload], img[data-flickity-lazyload-src], img[data-flickity-lazyload-srcset]");return s.makeArray(t)}(e);t=t.concat(e)}),t.forEach(function(e){new n(e,this)},this))},n.prototype.handleEvent=s.handleEvent,n.prototype.load=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this);var e=this.img.getAttribute("data-flickity-lazyload")||this.img.getAttribute("data-flickity-lazyload-src"),t=this.img.getAttribute("data-flickity-lazyload-srcset");this.img.src=e,t&&this.img.setAttribute("srcset",t),this.img.removeAttribute("data-flickity-lazyload"),this.img.removeAttribute("data-flickity-lazyload-src"),this.img.removeAttribute("data-flickity-lazyload-srcset")},n.prototype.onload=function(e){this.complete(e,"flickity-lazyloaded")},n.prototype.onerror=function(e){this.complete(e,"flickity-lazyerror")},n.prototype.complete=function(e,t){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this);var i=this.flickity.getParentCell(this.img),i=i&&i.element;this.flickity.cellSizeChange(i),this.img.classList.add(t),this.flickity.dispatchEvent("lazyLoad",e,i)},t.LazyLoader=n,t}),function(e){"function"==typeof define&&define.amd?define("flickity/js/index",["./flickity","./drag","./prev-next-button","./page-dots","./player","./add-remove-cell","./lazyload"],e):"object"==typeof module&&module.exports&&(module.exports=e(require("./flickity"),require("./drag"),require("./prev-next-button"),require("./page-dots"),require("./player"),require("./add-remove-cell"),require("./lazyload")))}((window,function(e){return e})),function(e,t){"function"==typeof define&&define.amd?define("flickity-as-nav-for/as-nav-for",["flickity/js/index","fizzy-ui-utils/utils"],t):"object"==typeof module&&module.exports?module.exports=t(require("flickity"),require("fizzy-ui-utils")):e.Flickity=t(e.Flickity,e.fizzyUIUtils)}(window,function(i,n){i.createMethods.push("_createAsNavFor");var e=i.prototype;return e._createAsNavFor=function(){this.on("activate",this.activateAsNavFor),this.on("deactivate",this.deactivateAsNavFor),this.on("destroy",this.destroyAsNavFor);var e,t=this.options.asNavFor;t&&(e=this,setTimeout(function(){e.setNavCompanion(t)}))},e.setNavCompanion=function(e){e=n.getQueryElement(e);var t,e=i.data(e);e&&e!=this&&(this.navCompanion=e,(t=this).onNavCompanionSelect=function(){t.navCompanionSelect()},e.on("select",this.onNavCompanionSelect),this.on("staticClick",this.onNavStaticClick),this.navCompanionSelect(!0))},e.navCompanionSelect=function(e){var t,i,n=this.navCompanion&&this.navCompanion.selectedCells;n&&(t=n[0],t=this.navCompanion.cells.indexOf(t),n=t+n.length-1,i=Math.floor((i=this.navCompanion.cellAlign,(n-t)*i+t)),this.selectCell(i,!1,e),this.removeNavSelectedElements(),i>=this.cells.length||(e=this.cells.slice(t,1+n),this.navSelectedElements=e.map(function(e){return e.element}),this.changeNavSelectedClass("add")))},e.changeNavSelectedClass=function(t){this.navSelectedElements.forEach(function(e){e.classList[t]("is-nav-selected")})},e.activateAsNavFor=function(){this.navCompanionSelect(!0)},e.removeNavSelectedElements=function(){this.navSelectedElements&&(this.changeNavSelectedClass("remove"),delete this.navSelectedElements)},e.onNavStaticClick=function(e,t,i,n){"number"==typeof n&&this.navCompanion.selectCell(n)},e.deactivateAsNavFor=function(){this.removeNavSelectedElements()},e.destroyAsNavFor=function(){this.navCompanion&&(this.navCompanion.off("select",this.onNavCompanionSelect),this.off("staticClick",this.onNavStaticClick),delete this.navCompanion)},i}),function(t,i){"use strict";"function"==typeof define&&define.amd?define("imagesloaded/imagesloaded",["ev-emitter/ev-emitter"],function(e){return i(t,e)}):"object"==typeof module&&module.exports?module.exports=i(t,require("ev-emitter")):t.imagesLoaded=i(t,t.EvEmitter)}("undefined"!=typeof window?window:this,function(t,e){var o=t.jQuery,r=t.console;function a(e,t){for(var i in t)e[i]=t[i];return e}var l=Array.prototype.slice;function h(e,t,i){if(!(this instanceof h))return new h(e,t,i);var n,s=e;(s="string"==typeof e?document.querySelectorAll(e):s)?(this.elements=(n=s,Array.isArray(n)?n:"object"==typeof n&&"number"==typeof n.length?l.call(n):[n]),this.options=a({},this.options),"function"==typeof t?i=t:a(this.options,t),i&&this.on("always",i),this.getImages(),o&&(this.jqDeferred=new o.Deferred),setTimeout(this.check.bind(this))):r.error("Bad element for imagesLoaded "+(s||e))}(h.prototype=Object.create(e.prototype)).options={},h.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},h.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&c[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var s=i[n];this.addImage(s)}if("string"==typeof this.options.background)for(var o=e.querySelectorAll(this.options.background),n=0;n<o.length;n++){var r=o[n];this.addElementBackgroundImages(r)}}};var c={1:!0,9:!0,11:!0};function i(e){this.img=e}function n(e,t){this.url=e,this.element=t,this.img=new Image}return h.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var s=n&&n[2];s&&this.addBackground(s,e),n=i.exec(t.backgroundImage)}},h.prototype.addImage=function(e){e=new i(e);this.images.push(e)},h.prototype.addBackground=function(e,t){e=new n(e,t);this.images.push(e)},h.prototype.check=function(){var n=this;function t(e,t,i){setTimeout(function(){n.progress(e,t,i)})}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(e){e.once("progress",t),e.check()}):this.complete()},h.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&r&&r.log("progress: "+i,e,t)},h.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred&&(e=this.hasAnyBroken?"reject":"resolve",this.jqDeferred[e](this))},(i.prototype=Object.create(e.prototype)).check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},i.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},i.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},i.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},i.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},i.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},i.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},(n.prototype=Object.create(i.prototype)).check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},n.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},n.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},(h.makeJQueryPlugin=function(e){(e=e||t.jQuery)&&((o=e).fn.imagesLoaded=function(e,t){return new h(this,e,t).jqDeferred.promise(o(this))})})(),h}),function(e,i){"function"==typeof define&&define.amd?define(["flickity/js/index","imagesloaded/imagesloaded"],function(e,t){return i(0,e,t)}):"object"==typeof module&&module.exports?module.exports=i(0,require("flickity"),require("imagesloaded")):e.Flickity=i(0,e.Flickity,e.imagesLoaded)}(window,function(e,t,n){"use strict";t.createMethods.push("_createImagesLoaded");var i=t.prototype;return i._createImagesLoaded=function(){this.on("activate",this.imagesLoaded)},i.imagesLoaded=function(){var i;this.options.imagesLoaded&&n((i=this).slider).on("progress",function(e,t){t=i.getParentCell(t.img),i.cellSizeChange(t&&t.element),i.options.freeScroll||i.positionSliderAtSelected()})},t}),function(n){n.version={versionStr:"3.1.0",major:parseInt("3",10),minor:parseInt("1",10),revision:parseInt("0",10)};var e,t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},i=Object.prototype.toString,s=Object.prototype.hasOwnProperty;n.isFunction=function(e){return"function"===n.type(e)},n.isArray=Array.isArray||function(e){return"array"===n.type(e)},n.isWindow=function(e){return e&&"object"==typeof e&&"setInterval"in e},n.type=function(e){return null==e?String(e):t[i.call(e)]||"object"},n.isPlainObject=function(e){if(!e||"object"!==OpenSeadragon.type(e)||e.nodeType||n.isWindow(e))return!1;if(e.constructor&&!s.call(e,"constructor")&&!s.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t,i;for(i in e)t=i;return void 0===t||s.call(e,t)},n.isEmptyObject=function(e){for(var t in e)return!1;return!0},n.freezeObject=function(e){return Object.freeze?n.freezeObject=Object.freeze:n.freezeObject=function(e){return e},n.freezeObject(e)},n.supportsCanvas=(e=document.createElement("canvas"),!(!n.isFunction(e.getContext)||!e.getContext("2d"))),n.isCanvasTainted=function(e){var t=!1;try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){t=!0}return t},n.supportsAddEventListener=!(!document.documentElement.addEventListener||!document.addEventListener),n.supportsRemoveEventListener=!(!document.documentElement.removeEventListener||!document.removeEventListener),n.supportsEventListenerOptions=function(){var e=0;if(n.supportsAddEventListener)try{var t={get capture(){return e++,!1},get once(){return e++,!1},get passive(){return e++,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=0}return 3<=e}(),n.getCurrentPixelDensityRatio=function(){var e,t;return n.supportsCanvas?(t=document.createElement("canvas").getContext("2d"),e=window.devicePixelRatio||1,t=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,Math.max(e,1)/t):1},n.pixelDensityRatio=n.getCurrentPixelDensityRatio()}(OpenSeadragon),function(u){var e;function t(e){}u.extend=function(){var e,t,i,n,s,o=arguments[0]||{},r=arguments.length,a=!1,l=1;for("boolean"==typeof o&&(a=o,o=arguments[1]||{},l=2),"object"==typeof o||OpenSeadragon.isFunction(o)||(o={}),r===l&&(o=this,--l);l<r;l++)if(null!==(e=arguments[l])||void 0!==e)for(t in e)s=o[t],o!==(i=e[t])&&(a&&i&&(OpenSeadragon.isPlainObject(i)||(n=OpenSeadragon.isArray(i)))?(s=n?(n=!1,s&&OpenSeadragon.isArray(s)?s:[]):s&&OpenSeadragon.isPlainObject(s)?s:{},o[t]=OpenSeadragon.extend(a,s,i)):void 0!==i&&(o[t]=i));return o},u.extend(u,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:"object"==typeof navigator&&"string"==typeof(e=navigator.userAgent)&&(-1!==e.indexOf("iPhone")||-1!==e.indexOf("iPad")||-1!==e.indexOf("iPod")),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},SIGNAL:"----seadragon----",delegate:function(t,i){return function(){var e=arguments;return i.apply(t,void 0===e?[]:e)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(e){return u._viewers.get(this.getElement(e))},getElement:function(e){return"string"==typeof e?document.getElementById(e):e},getElementPosition:function(e){for(var t,i=new u.Point,n=w(e=u.getElement(e),t="fixed"===u.getElementStyle(e).position);n;)i.x+=e.offsetLeft,i.y+=e.offsetTop,t&&(i=i.plus(u.getPageScroll())),n=w(e=n,t="fixed"===u.getElementStyle(e).position);return i},getElementOffset:function(e){var t,i=(e=u.getElement(e))&&e.ownerDocument,n={top:0,left:0};return i?(t=i.documentElement,void 0!==e.getBoundingClientRect&&(n=e.getBoundingClientRect()),i=i===i.window?i:9===i.nodeType&&(i.defaultView||i.parentWindow),new u.Point(n.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0),n.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0))):new u.Point},getElementSize:function(e){return e=u.getElement(e),new u.Point(e.clientWidth,e.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(e){return(e=u.getElement(e)).currentStyle}:function(e){return e=u.getElement(e),window.getComputedStyle(e,"")},getCssPropertyWithVendorPrefix:function(e){var a={};return u.getCssPropertyWithVendorPrefix=function(e){if(void 0!==a[e])return a[e];var t=document.createElement("div").style,i=null;if(void 0!==t[e])i=e;else for(var n=["Webkit","Moz","MS","O","webkit","moz","ms","o"],s=u.capitalizeFirstLetter(e),o=0;o<n.length;o++){var r=n[o]+s;if(void 0!==t[r]){i=r;break}}return a[e]=i},u.getCssPropertyWithVendorPrefix(e)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,t){return(e%=t)<0&&(e+=t),e},pointInElement:function(e,t){e=u.getElement(e);var i=u.getElementOffset(e),e=u.getElementSize(e);return t.x>=i.x&&t.x<i.x+e.x&&t.y<i.y+e.y&&t.y>=i.y},getMousePosition:function(e){if("number"==typeof e.pageX)u.getMousePosition=function(e){var t=new u.Point;return t.x=e.pageX,t.y=e.pageY,t};else{if("number"!=typeof e.clientX)throw new Error("Unknown event mouse position, no known technique.");u.getMousePosition=function(e){var t=new u.Point;return t.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop,t}}return u.getMousePosition(e)},getPageScroll:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.pageXOffset)u.getPageScroll=function(){return new u.Point(window.pageXOffset,window.pageYOffset)};else if(t.scrollLeft||t.scrollTop)u.getPageScroll=function(){return new u.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!e.scrollLeft&&!e.scrollTop)return new u.Point(0,0);u.getPageScroll=function(){return new u.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return u.getPageScroll()},setPageScroll:function(e){if(void 0!==window.scrollTo)u.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var t=u.getPageScroll();if(t.x===e.x&&t.y===e.y)return;document.body.scrollLeft=e.x,document.body.scrollTop=e.y;var i=u.getPageScroll();if(i.x!==t.x&&i.y!==t.y)return void(u.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y});if(document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y,(i=u.getPageScroll()).x!==t.x&&i.y!==t.y)return void(u.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y});u.setPageScroll=function(e){}}u.setPageScroll(e)},getWindowSize:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.innerWidth)u.getWindowSize=function(){return new u.Point(window.innerWidth,window.innerHeight)};else if(e.clientWidth||e.clientHeight)u.getWindowSize=function(){return new u.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!t.clientWidth&&!t.clientHeight)throw new Error("Unknown window size, no known technique.");u.getWindowSize=function(){return new u.Point(document.body.clientWidth,document.body.clientHeight)}}return u.getWindowSize()},makeCenteredNode:function(e){e=u.getElement(e);var t=[u.makeNeutralElement("div"),u.makeNeutralElement("div"),u.makeNeutralElement("div")];return u.extend(t[0].style,{display:"table",height:"100%",width:"100%"}),u.extend(t[1].style,{display:"table-row"}),u.extend(t[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),t[0].appendChild(t[1]),t[1].appendChild(t[2]),t[2].appendChild(e),t[0]},makeNeutralElement:function(e){var t=document.createElement(e);return(e=t.style).background="transparent none",e.border="none",e.margin="0px",e.padding="0px",e.position="static",t},now:function(){return Date.now?u.now=Date.now:u.now=function(){return(new Date).getTime()},u.now()},makeTransparentImage:function(e){var t=u.makeNeutralElement("img");return t.src=e,t},setElementOpacity:function(e,t,i){e=u.getElement(e),i&&!u.Browser.alpha&&(t=Math.round(t)),u.Browser.opacity?e.style.opacity=t<1?t:"":t<1?(t=Math.round(100*t),e.style.filter="alpha(opacity="+t+")"):e.style.filter=""},setElementTouchActionNone:function(e){void 0!==(e=u.getElement(e)).style.touchAction?e.style.touchAction="none":void 0!==e.style.msTouchAction&&(e.style.msTouchAction="none")},setElementPointerEvents:function(e,t){void 0!==(e=u.getElement(e)).style&&void 0!==e.style.pointerEvents&&(e.style.pointerEvents=t)},setElementPointerEventsNone:function(e){u.setElementPointerEvents(e,"none")},addClass:function(e,t){(e=u.getElement(e)).className?-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=" "+t):e.className=t},indexOf:function(e,t,i){return Array.prototype.indexOf?this.indexOf=function(e,t,i){return e.indexOf(t,i)}:this.indexOf=function(e,t,i){var n,s,i=i||0;if(!e)throw new TypeError;if(!(0===(s=e.length)||s<=i))for(n=i=i<0?s-Math.abs(i):i;n<s;n++)if(e[n]===t)return n;return-1},this.indexOf(e,t,i)},removeClass:function(e,t){for(var i=[],n=(e=u.getElement(e)).className.split(/\s+/),s=0;s<n.length;s++)n[s]&&n[s]!==t&&i.push(n[s]);e.className=i.join(" ")},normalizeEventListenerOptions:function(e){return void 0!==e?"boolean"==typeof e?u.supportsEventListenerOptions?{capture:e}:e:u.supportsEventListenerOptions?e:void 0!==e.capture&&e.capture:!!u.supportsEventListenerOptions&&{capture:!1}},addEvent:function(){if(u.supportsAddEventListener)return function(e,t,i,n){n=u.normalizeEventListenerOptions(n),(e=u.getElement(e)).addEventListener(t,i,n)};if(document.documentElement.attachEvent&&document.attachEvent)return function(e,t,i){(e=u.getElement(e)).attachEvent("on"+t,i)};throw new Error("No known event model.")}(),removeEvent:function(){if(u.supportsRemoveEventListener)return function(e,t,i,n){n=u.normalizeEventListenerOptions(n),(e=u.getElement(e)).removeEventListener(t,i,n)};if(document.documentElement.detachEvent&&document.detachEvent)return function(e,t,i){(e=u.getElement(e)).detachEvent("on"+t,i)};throw new Error("No known event model.")}(),cancelEvent:function(e){e.preventDefault()},eventIsCanceled:function(e){return e.defaultPrevented},stopEvent:function(e){e.stopPropagation()},createCallback:function(i,n){for(var s=[],e=2;e<arguments.length;e++)s.push(arguments[e]);return function(){for(var e=s.concat([]),t=0;t<arguments.length;t++)e.push(arguments[t]);return n.apply(i,e)}},getUrlParameter:function(e){return(e=c[e])||null},getUrlProtocol:function(e){return null===(e=e.match(/^([a-z]+:)\/\//i))?window.location.protocol:e[1].toLowerCase()},createAjaxRequest:function(e){var t;try{t=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}if(t)window.XMLHttpRequest?u.createAjaxRequest=function(e){return e?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:u.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");u.createAjaxRequest=function(){return new XMLHttpRequest}}return u.createAjaxRequest(e)},makeAjaxRequest:function(e,t,i){u.isPlainObject(e)&&(t=e.success,i=e.error,n=e.withCredentials,s=e.headers,o=e.responseType||null,r=e.postData||null,e=e.url);var n,s,o,r,a=u.getUrlProtocol(e),l=u.createAjaxRequest("file:"===a);if(!u.isFunction(t))throw new Error("makeAjaxRequest requires a success callback");l.onreadystatechange=function(){4===l.readyState&&(l.onreadystatechange=function(){},200<=l.status&&l.status<300||0===l.status&&"http:"!==a&&"https:"!==a?t(l):u.isFunction(i)?i(l):u.console.error("AJAX request returned %d: %s",l.status,e))};var h=r?"POST":"GET";try{if(l.open(h,e,!0),o&&(l.responseType=o),s)for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&s[c]&&l.setRequestHeader(c,s[c]);n&&(l.withCredentials=!0),l.send(r)}catch(e){u.console.error("%s while making AJAX request: %s",e.name,e.message),l.onreadystatechange=function(){},u.isFunction(i)&&i(l,e)}return l},jsonp:function(e){var i,t=e.url,n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s=e.callbackName||"openseadragon"+u.now(),o=window[s],r=e.param||"callback",a=e.callback,t=t.replace(/(=)\?(&|$)|\?\?/i,"$1"+s+"$2");t+=(/\?/.test(t)?"&":"?")+r+"="+s,window[s]=function(e){if(o)window[s]=o;else try{delete window[s]}catch(e){}a&&u.isFunction(a)&&a(e)},i=document.createElement("script"),void 0===e.async&&!1===e.async||(i.async="async"),e.scriptCharset&&(i.charset=e.scriptCharset),i.src=t,i.onload=i.onreadystatechange=function(e,t){!t&&i.readyState&&!/loaded|complete/.test(i.readyState)||(i.onload=i.onreadystatechange=null,n&&i.parentNode&&n.removeChild(i),i=void 0)},n.insertBefore(i,n.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(e){if(window.DOMParser)u.parseXml=function(e){return(new DOMParser).parseFromString(e,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");u.parseXml=function(e){var t=null;return(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t}}return u.parseXml(e)},parseJSON:function(e){return u.parseJSON=window.JSON.parse,u.parseJSON(e)},imageFormatSupported:function(e){return!!h[(e=e||"").toLowerCase()]},setImageFormatsSupported:function(e){u.extend(h,e)}}),u.console=window.console||{log:t,debug:t,info:t,warn:t,error:t,assert:t};var i,n,s,o,r,a,l,h={bmp:!(u.Browser={vendor:u.BROWSERS.UNKNOWN,version:0,alpha:!0}),jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},c={},d=navigator.appVersion,p=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(u.Browser.vendor=u.BROWSERS.IE,u.Browser.version=parseFloat(p.substring(p.indexOf("MSIE")+5,p.indexOf(";",p.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(0<=p.indexOf("Edge")?(u.Browser.vendor=u.BROWSERS.EDGE,u.Browser.version=parseFloat(p.substring(p.indexOf("Edge")+5))):0<=p.indexOf("Edg")?(u.Browser.vendor=u.BROWSERS.CHROMEEDGE,u.Browser.version=parseFloat(p.substring(p.indexOf("Edg")+4))):0<=p.indexOf("Firefox")?(u.Browser.vendor=u.BROWSERS.FIREFOX,u.Browser.version=parseFloat(p.substring(p.indexOf("Firefox")+8))):0<=p.indexOf("Safari")?(u.Browser.vendor=0<=p.indexOf("Chrome")?u.BROWSERS.CHROME:u.BROWSERS.SAFARI,u.Browser.version=parseFloat(p.substring(p.substring(0,p.indexOf("Safari")).lastIndexOf("/")+1,p.indexOf("Safari")))):null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(p)&&(u.Browser.vendor=u.BROWSERS.IE,u.Browser.version=parseFloat(RegExp.$1)));break;case"Opera":u.Browser.vendor=u.BROWSERS.OPERA,u.Browser.version=parseFloat(d)}for(var g,m=window.location.search.substring(1).split("&"),f=0;f<m.length;f++)if(0<(y=(g=m[f]).indexOf("="))){var v=g.substring(0,y),y=g.substring(y+1);try{c[v]=decodeURIComponent(y)}catch(d){u.console.error("Ignoring malformed URL parameter: %s=%s",v,y)}}function w(e,t){return t&&e!==document.body?document.body:e.offsetParent}u.Browser.alpha=!(u.Browser.vendor===u.BROWSERS.CHROME&&u.Browser.version<2),u.Browser.opacity=!0,u.Browser.vendor===u.BROWSERS.IE&&u.Browser.version<11&&u.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon"),i=window,a=i.requestAnimationFrame||i.mozRequestAnimationFrame||i.webkitRequestAnimationFrame||i.msRequestAnimationFrame,l=i.cancelAnimationFrame||i.mozCancelAnimationFrame||i.webkitCancelAnimationFrame||i.msCancelAnimationFrame,a&&l?(u.requestAnimationFrame=function(){return a.apply(i,arguments)},u.cancelAnimationFrame=function(){return l.apply(i,arguments)}):(s=[],o=[],r=0,u.requestAnimationFrame=function(e){return s.push([++r,e]),n=n||setInterval(function(){if(s.length){var e=u.now(),t=o;for(o=s,s=t;o.length;)o.shift()[1](e)}else clearInterval(n),n=void 0},20),r},u.cancelAnimationFrame=function(e){for(var t=0,i=s.length;t<i;t+=1)if(s[t][0]===e)return void s.splice(t,1);for(t=0,i=o.length;t<i;t+=1)if(o[t][0]===e)return void o.splice(t,1)})}(OpenSeadragon),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.OpenSeadragon=t()}(this,function(){return OpenSeadragon}),function(e){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.fullscreenElement},t.requestFullScreen=function(e){return e.requestFullscreen()},t.exitFullScreen=function(){document.exitFullscreen()},t.fullScreenEventName="fullscreenchange",t.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.msFullscreenElement},t.requestFullScreen=function(e){return e.msRequestFullscreen()},t.exitFullScreen=function(){document.msExitFullscreen()},t.fullScreenEventName="MSFullscreenChange",t.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitFullscreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullscreen()},t.exitFullScreen=function(){document.webkitExitFullscreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullScreen()},t.exitFullScreen=function(){document.webkitCancelFullScreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.mozFullScreenElement},t.requestFullScreen=function(e){return e.mozRequestFullScreen()},t.exitFullScreen=function(){document.mozCancelFullScreen()},t.fullScreenEventName="mozfullscreenchange",t.fullScreenErrorEventName="mozfullscreenerror"),t.isFullScreen=function(){return null!==t.getFullScreenElement()},t.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),t.exitFullScreen()},e.extend(e,t)}(OpenSeadragon),function(o){o.EventSource=function(){this.events={}},o.EventSource.prototype={addOnceHandler:function(i,n,e,s){var o=this,r=(s=s||1,0);this.addHandler(i,function e(t){++r===s&&o.removeHandler(i,e),n(t)},e)},addHandler:function(e,t,i){var n=this.events[e];n||(this.events[e]=n=[]),t&&o.isFunction(t)&&(n[n.length]={handler:t,userData:i||null})},removeHandler:function(e,t){var i,n=this.events[e],s=[];if(n&&o.isArray(n)){for(i=0;i<n.length;i++)n[i].handler!==t&&s.push(n[i]);this.events[e]=s}},numberOfHandlers:function(e){return(e=this.events[e])?e.length:0},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var t in this.events)this.events[t]=[]},getHandler:function(e){var s=this.events[e];return s&&s.length?(s=1===s.length?[s[0]]:Array.apply(null,s),function(e,t){for(var i=s.length,n=0;n<i;n++)s[n]&&(t.eventSource=e,t.userData=s[n].userData,s[n].handler(t))}):null},raiseEvent:function(e,t){(e=this.getHandler(e))&&e(this,t=t||{})}}}(OpenSeadragon),function(c){var a,o,l,e,i=[],u={},r=(c.MouseTracker=function(e){i.push(this);var t=arguments,h=(c.isPlainObject(e)||(e={element:t[0],clickTimeThreshold:t[1],clickDistThreshold:t[2]}),this.hash=Math.random(),this.element=c.getElement(e.element),this.clickTimeThreshold=e.clickTimeThreshold||c.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=e.clickDistThreshold||c.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=e.dblClickTimeThreshold||c.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=e.dblClickDistThreshold||c.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=e.userData||null,this.stopDelay=e.stopDelay||50,this.preProcessEventHandler=e.preProcessEventHandler||null,this.contextMenuHandler=e.contextMenuHandler||null,this.enterHandler=e.enterHandler||null,this.leaveHandler=e.leaveHandler||null,this.exitHandler=e.exitHandler||null,this.overHandler=e.overHandler||null,this.outHandler=e.outHandler||null,this.pressHandler=e.pressHandler||null,this.nonPrimaryPressHandler=e.nonPrimaryPressHandler||null,this.releaseHandler=e.releaseHandler||null,this.nonPrimaryReleaseHandler=e.nonPrimaryReleaseHandler||null,this.moveHandler=e.moveHandler||null,this.scrollHandler=e.scrollHandler||null,this.clickHandler=e.clickHandler||null,this.dblClickHandler=e.dblClickHandler||null,this.dragHandler=e.dragHandler||null,this.dragEndHandler=e.dragEndHandler||null,this.pinchHandler=e.pinchHandler||null,this.stopHandler=e.stopHandler||null,this.keyDownHandler=e.keyDownHandler||null,this.keyUpHandler=e.keyUpHandler||null,this.keyHandler=e.keyHandler||null,this.focusHandler=e.focusHandler||null,this.blurHandler=e.blurHandler||null,this);u[this.hash]={click:function(e){var t;O(h,t={originalEvent:e=e,eventType:"click",pointerType:"mouse",isEmulated:!1}),t.preventDefault&&!t.defaultPrevented&&c.cancelEvent(e),t.stopPropagation&&c.stopEvent(e)},dblclick:function(e){var t;O(h,t={originalEvent:e=e,eventType:"dblclick",pointerType:"mouse",isEmulated:!1}),t.preventDefault&&!t.defaultPrevented&&c.cancelEvent(e),t.stopPropagation&&c.stopEvent(e)},keydown:function(e){var t,i,n;i=null,O(t=h,n={originalEvent:e=e,eventType:"keydown",pointerType:"",isEmulated:!1}),!t.keyDownHandler||n.preventGesture||n.defaultPrevented||(i={eventSource:t,keyCode:e.keyCode||e.charCode,ctrl:e.ctrlKey,shift:e.shiftKey,alt:e.altKey,meta:e.metaKey,originalEvent:e,preventDefault:n.preventDefault||n.defaultPrevented,userData:t.userData},t.keyDownHandler(i)),(i&&i.preventDefault||n.preventDefault&&!n.defaultPrevented)&&c.cancelEvent(e),n.stopPropagation&&c.stopEvent(e)},keyup:function(e){var t,i,n;i=null,O(t=h,n={originalEvent:e=e,eventType:"keyup",pointerType:"",isEmulated:!1}),!t.keyUpHandler||n.preventGesture||n.defaultPrevented||(i={eventSource:t,keyCode:e.keyCode||e.charCode,ctrl:e.ctrlKey,shift:e.shiftKey,alt:e.altKey,meta:e.metaKey,originalEvent:e,preventDefault:n.preventDefault||n.defaultPrevented,userData:t.userData},t.keyUpHandler(i)),(i&&i.preventDefault||n.preventDefault&&!n.defaultPrevented)&&c.cancelEvent(e),n.stopPropagation&&c.stopEvent(e)},keypress:function(e){var t,i,n;i=null,O(t=h,n={originalEvent:e=e,eventType:"keypress",pointerType:"",isEmulated:!1}),!t.keyHandler||n.preventGesture||n.defaultPrevented||(i={eventSource:t,keyCode:e.keyCode||e.charCode,ctrl:e.ctrlKey,shift:e.shiftKey,alt:e.altKey,meta:e.metaKey,originalEvent:e,preventDefault:n.preventDefault||n.defaultPrevented,userData:t.userData},t.keyHandler(i)),(i&&i.preventDefault||n.preventDefault&&!n.defaultPrevented)&&c.cancelEvent(e),n.stopPropagation&&c.stopEvent(e)},focus:function(e){var t,i;O(t=h,i={originalEvent:e=e,eventType:"focus",pointerType:"",isEmulated:!1}),t.focusHandler&&!i.preventGesture&&t.focusHandler({eventSource:t,originalEvent:e,userData:t.userData})},blur:function(e){var t,i;O(t=h,i={originalEvent:e=e,eventType:"blur",pointerType:"",isEmulated:!1}),t.blurHandler&&!i.preventGesture&&t.blurHandler({eventSource:t,originalEvent:e,userData:t.userData})},contextmenu:function(e){var t,i,n;i=null,O(t=h,n={originalEvent:e=e,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1}),!t.contextMenuHandler||n.preventGesture||n.defaultPrevented||(i={eventSource:t,position:x(y(e),t.element),originalEvent:n.originalEvent,preventDefault:n.preventDefault||n.defaultPrevented,userData:t.userData},t.contextMenuHandler(i)),(i&&i.preventDefault||n.preventDefault&&!n.defaultPrevented)&&c.cancelEvent(e),n.stopPropagation&&c.stopEvent(e)},wheel:function(e){T(h,e,e)},mousewheel:function(e){n(h,e)},DOMMouseScroll:function(e){n(h,e)},MozMousePixelScroll:function(e){n(h,e)},losecapture:function(e){var t,i,n;t=h,e=e,i={id:c.MouseTracker.mousePointerId,type:"mouse"},O(t,n={originalEvent:e,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1}),e.target===t.element&&A(t,i,!1),n.stopPropagation&&c.stopEvent(e)},mouseenter:function(e){E(h,e)},mouseleave:function(e){S(h,e)},mouseover:function(e){_(h,e)},mouseout:function(e){P(h,e)},mousedown:function(e){C(h,e)},mouseup:function(e){k(h,e)},mousemove:function(e){D(h,e)},touchstart:function(e){var t,i,n=h,s=e,o=s.changedTouches.length,r=n.getActivePointersListByType("touch"),a=c.now(),l=(r.getLength()>s.touches.length-o&&c.console.warn("Tracked touch contact count doesn't match event.touches.length"),{originalEvent:s,eventType:"pointerdown",pointerType:"touch",isEmulated:!1});for(O(n,l),t=0;t<o;t++)H(n,l,i={id:s.changedTouches[t].identifier,type:"touch",isPrimary:0===r.getLength(),currentPos:y(s.changedTouches[t]),currentTime:a}),F(n,l,i,0),A(n,i,!0);l.preventDefault&&!l.defaultPrevented&&c.cancelEvent(s),l.stopPropagation&&c.stopEvent(s)},touchend:function(e){var t,i,n=h,s=e,o=s.changedTouches.length,r=c.now(),a={originalEvent:s,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(O(n,a),t=0;t<o;t++)N(n,a,i={id:s.changedTouches[t].identifier,type:"touch",currentPos:y(s.changedTouches[t]),currentTime:r},0),A(n,i,!1),B(n,a,i);a.preventDefault&&!a.defaultPrevented&&c.cancelEvent(s),a.stopPropagation&&c.stopEvent(s)},touchmove:function(e){var t,i=h,n=e,s=n.changedTouches.length,o=c.now(),r={originalEvent:n,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(O(i,r),t=0;t<s;t++)j(i,r,{id:n.changedTouches[t].identifier,type:"touch",currentPos:y(n.changedTouches[t]),currentTime:o});r.preventDefault&&!r.defaultPrevented&&c.cancelEvent(n),r.stopPropagation&&c.stopEvent(n)},touchcancel:function(e){var t,i=h,n=e,s=n.changedTouches.length,e={originalEvent:n,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(O(i,e),t=0;t<s;t++)W(i,0,{id:n.changedTouches[t].identifier,type:"touch"});e.stopPropagation&&c.stopEvent(n)},gesturestart:function(e){c.eventIsCanceled(e)||e.preventDefault()},gesturechange:function(e){c.eventIsCanceled(e)||e.preventDefault()},gotpointercapture:function(e){var t,i;t=h,i={originalEvent:e=e,eventType:"gotpointercapture",pointerType:f(e),isEmulated:!1},O(t,i),e.target===t.element&&A(t,{id:e.pointerId,type:f(e)},!0),i.stopPropagation&&c.stopEvent(e)},lostpointercapture:function(e){var t,i;t=h,i={originalEvent:e=e,eventType:"lostpointercapture",pointerType:f(e),isEmulated:!1},O(t,i),e.target===t.element&&A(t,{id:e.pointerId,type:f(e)},!1),i.stopPropagation&&c.stopEvent(e)},pointerenter:function(e){E(h,e)},pointerleave:function(e){S(h,e)},pointerover:function(e){_(h,e)},pointerout:function(e){P(h,e)},pointerdown:function(e){C(h,e)},pointerup:function(e){k(h,e)},pointermove:function(e){D(h,e)},pointercancel:function(e){var t,i,n;t=h,i={id:(e=e).pointerId,type:f(e)},O(t,n={originalEvent:e,eventType:"pointercancel",pointerType:i.type,isEmulated:!1}),W(t,0,i),n.stopPropagation&&c.stopEvent(e)},pointerupcaptured:function(e){var t;e=e,(t=h).getActivePointersListByType(f(e)).getById(e.pointerId)&&R(t,e),c.stopEvent(e)},pointermovecaptured:function(e){var t;e=e,(t=h).getActivePointersListByType(f(e)).getById(e.pointerId)&&L(t,e),c.stopEvent(e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,c.MouseTracker.havePointerEvents&&c.setElementPointerEvents(this.element,"auto"),this.exitHandler&&c.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),e.startDisabled||this.setTracking(!0)},c.MouseTracker.prototype={destroy:function(){var e;for(t(this),this.element=null,e=0;e<i.length;e++)if(i[e]===this){i.splice(e,1);break}u[this.hash]=null,delete u[this.hash]},isTracking:function(){return u[this.hash].tracking},setTracking:function(e){return(e?function(e){var t,i,n=u[e.hash];if(!n.tracking){for(i=0;i<c.MouseTracker.subscribeEvents.length;i++)t=c.MouseTracker.subscribeEvents[i],c.addEvent(e.element,t,n[t],t===c.MouseTracker.wheelEventName&&{passive:!1,capture:!1});s(e),n.tracking=!0}}:t)(this),this},getActivePointersListByType:function(e){for(var t,i=u[this.hash],n=i.activePointersLists.length,s=0;s<n;s++)if(i.activePointersLists[s].type===e)return i.activePointersLists[s];return t=new c.MouseTracker.GesturePointList(e),i.activePointersLists.push(t),t},getActivePointerCount:function(){for(var e=u[this.hash],t=e.activePointersLists.length,i=0,n=0;n<t;n++)i+=e.activePointersLists[n].getLength();return i},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},function(){try{return window.self!==window.top}catch(e){return!0}}());function h(e){try{return e.addEventListener&&e.removeEventListener}catch(e){}}function d(e,t){return e.hash.toString()+t.type+t.id.toString()}function M(){var e,t,i,n,s=a.length,o=c.now(),r=o-l;for(l=o,e=0;e<s;e++)(i=(t=a[e]).gPoint).direction=Math.atan2(i.currentPos.y-t.lastPos.y,i.currentPos.x-t.lastPos.x),n=t.lastPos.distanceTo(i.currentPos),t.lastPos=i.currentPos,i.speed=1e3*n/(1+r)*.75+.25*i.speed}function s(e){for(var t,i,n,s,o=u[e.hash],r=o.activePointersLists.length,a=0;a<r;a++)if(0<(i=o.activePointersLists[a]).getLength()){for(s=[],n=i.asArray(),t=0;t<n.length;t++)s.push(n[t]);for(t=0;t<s.length;t++)z(e,i,s[t])}for(a=0;a<r;a++)o.activePointersLists.pop();o.sentDragEvent=!1}function t(e){var t,i,n=u[e.hash];if(n.tracking){for(i=0;i<c.MouseTracker.subscribeEvents.length;i++)t=c.MouseTracker.subscribeEvents[i],c.removeEvent(e.element,t,n[t],!1);s(e),n.tracking=!1}}function p(e,t){if(e=u[e.hash],"pointerevent"===t)return{upName:"pointerup",upHandler:e.pointerupcaptured,moveName:"pointermove",moveHandler:e.pointermovecaptured};if("mouse"===t)return{upName:"pointerup",upHandler:e.pointerupcaptured,moveName:"pointermove",moveHandler:e.pointermovecaptured};if("touch"===t)return{upName:"touchend",upHandler:e.touchendcaptured,moveName:"touchmove",moveHandler:e.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function g(e,t){var i;if(c.MouseTracker.havePointerCapture)if(c.MouseTracker.havePointerEvents){if(!(i=e.getActivePointersListByType(t.type).getById(t.id))||!i.captured)return;try{e.element.releasePointerCapture(t.id)}catch(e){}}else e.element.releaseCapture();else i=p(e,c.MouseTracker.havePointerEvents?"pointerevent":t.type),r&&h(window.top)&&c.removeEvent(window.top,i.upName,i.upHandler,!0),c.removeEvent(c.MouseTracker.captureElement,i.moveName,i.moveHandler,!0),c.removeEvent(c.MouseTracker.captureElement,i.upName,i.upHandler,!0);A(e,t,!1)}function m(e){return c.MouseTracker.havePointerEvents?e.pointerId:c.MouseTracker.mousePointerId}function f(e){return c.MouseTracker.havePointerEvents?e.pointerType||(c.Browser.vendor===c.BROWSERS.IE?"mouse":""):"mouse"}function v(e){return!c.MouseTracker.havePointerEvents||e.isPrimary}function y(e){return c.getMousePosition(e)}function w(e,t){return x(y(e),t)}function x(e,t){return t=c.getElementOffset(t),e.minus(t)}function b(e,t){return new c.Point((e.x+t.x)/2,(e.y+t.y)/2)}function n(e,t){var i={target:t.target||t.srcElement,type:"wheel",shiftKey:t.shiftKey||!1,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX||t.clientX,pageY:t.pageY||t.clientY,deltaMode:"MozMousePixelScroll"===t.type?0:1,deltaX:0,deltaZ:0};"mousewheel"===c.MouseTracker.wheelEventName?i.deltaY=-t.wheelDelta/c.DEFAULT_SETTINGS.pixelsPerWheelLine:i.deltaY=t.detail,T(e,i,t)}function T(e,t,i){var n,s=null,o=t.deltaY<0?1:-1;O(e,n={originalEvent:t,eventType:"wheel",pointerType:"mouse",isEmulated:t!==i}),!e.scrollHandler||n.preventGesture||n.defaultPrevented||(s={eventSource:e,pointerType:"mouse",position:w(t,e.element),scroll:o,shift:t.shiftKey,isTouchEvent:!1,originalEvent:i,preventDefault:n.preventDefault||n.defaultPrevented,userData:e.userData},e.scrollHandler(s)),n.stopPropagation&&c.stopEvent(i),(s&&s.preventDefault||n.preventDefault&&!n.defaultPrevented)&&c.cancelEvent(i)}function E(e,t){var i={id:m(t),type:f(t),isPrimary:v(t),currentPos:y(t),currentTime:c.now()};O(e,t={originalEvent:t,eventType:"pointerenter",pointerType:i.type,isEmulated:!1}),H(e,t,i)}function S(e,t){var i={id:m(t),type:f(t),isPrimary:v(t),currentPos:y(t),currentTime:c.now()};O(e,t={originalEvent:t,eventType:"pointerleave",pointerType:i.type,isEmulated:!1}),B(e,t,i)}function _(e,t){var i,n,s,o={id:m(t),type:f(t),isPrimary:v(t),currentPos:y(t),currentTime:c.now()},r={originalEvent:t,eventType:"pointerover",pointerType:o.type,isEmulated:!1};O(e,r),i=r,o=o,s=(e=e).getActivePointersListByType(o.type),(n=s.getById(o.id))?o=n:(o.captured=!1,o.insideElementPressed=!1),e.overHandler&&e.overHandler({eventSource:e,pointerType:o.type,position:x(o.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:o.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:i.originalEvent,userData:e.userData}),r.preventDefault&&!r.defaultPrevented&&c.cancelEvent(t),r.stopPropagation&&c.stopEvent(t)}function P(e,t){var i,n,s,o={id:m(t),type:f(t),isPrimary:v(t),currentPos:y(t),currentTime:c.now()},r={originalEvent:t,eventType:"pointerout",pointerType:o.type,isEmulated:!1};O(e,r),i=r,o=o,s=(e=e).getActivePointersListByType(o.type),(n=s.getById(o.id))?o=n:(o.captured=!1,o.insideElementPressed=!1),e.outHandler&&e.outHandler({eventSource:e,pointerType:o.type,position:o.currentPos&&x(o.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:o.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:i.originalEvent,userData:e.userData}),r.preventDefault&&!r.defaultPrevented&&c.cancelEvent(t),r.stopPropagation&&c.stopEvent(t)}function C(e,t){var i={id:m(t),type:f(t),isPrimary:v(t),currentPos:y(t),currentTime:c.now()},n=c.MouseTracker.havePointerEvents&&"touch"===i.type&&c.Browser.vendor!==c.BROWSERS.IE,s={originalEvent:t,eventType:"pointerdown",pointerType:i.type,isEmulated:!1};if(O(e,s),F(e,s,i,t.button),s.preventDefault&&!s.defaultPrevented&&c.cancelEvent(t),s.stopPropagation&&c.stopEvent(t),s.shouldCapture)if(n)A(e,i,!0);else{var o=e,t=i;if(c.MouseTracker.havePointerCapture)if(c.MouseTracker.havePointerEvents)try{o.element.setPointerCapture(t.id)}catch(o){return void c.console.warn("setPointerCapture() called on invalid pointer ID")}else o.element.setCapture(!0);else s=p(o,c.MouseTracker.havePointerEvents?"pointerevent":t.type),r&&h(window.top)&&c.addEvent(window.top,s.upName,s.upHandler,!0),c.addEvent(c.MouseTracker.captureElement,s.upName,s.upHandler,!0),c.addEvent(c.MouseTracker.captureElement,s.moveName,s.moveHandler,!0);A(o,t,!0)}}function k(e,t){R(e,t)}function R(e,t){var i,n={originalEvent:t,eventType:"pointerup",pointerType:(i={id:m(t),type:f(t),isPrimary:v(t),currentPos:y(t),currentTime:c.now()}).type,isEmulated:!1};O(e,n),N(e,n,i,t.button),n.preventDefault&&!n.defaultPrevented&&c.cancelEvent(t),n.stopPropagation&&c.stopEvent(t),n.shouldReleaseCapture&&(t.target===e.element?g(e,i):A(e,i,!1))}function D(e,t){L(e,t)}function L(e,t){var i={id:m(t),type:f(t),isPrimary:v(t),currentPos:y(t),currentTime:c.now()},n={originalEvent:t,eventType:"pointermove",pointerType:i.type,isEmulated:!1};O(e,n),j(e,n,i),n.preventDefault&&!n.defaultPrevented&&c.cancelEvent(t),n.stopPropagation&&c.stopEvent(t)}function I(e,t){t.speed=0,t.direction=0,t.contactPos=t.currentPos,t.contactTime=t.currentTime,t.lastPos=t.currentPos,t.lastTime=t.currentTime,e.add(t)}function z(e,t,i){var n=t.getById(i.id);n?(n.captured&&(c.console.warn("stopTrackingPointer() called on captured pointer"),g(e,n)),t.removeContact(),t.removeById(i.id)):t.getLength()}function O(e,t){t.eventSource=e,t.eventPhase=t.originalEvent&&void 0!==t.originalEvent.eventPhase?t.originalEvent.eventPhase:0,t.defaultPrevented=c.eventIsCanceled(t.originalEvent),t.shouldCapture=!1,t.shouldReleaseCapture=!1,t.userData=e.userData;var i=e,n=t;switch(n.eventType){case"pointermove":n.isStoppable=!0,n.isCancelable=!0,n.preventDefault=!1,n.preventGesture=!i.hasGestureHandlers,n.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":n.isStoppable=!0,n.isCancelable=!0,n.preventDefault=!1,n.preventGesture=!1,n.stopPropagation=!1;break;case"pointerdown":case"pointerup":n.isStoppable=!0,n.isCancelable=!0,n.preventDefault=!1,n.preventGesture=!i.hasGestureHandlers,n.stopPropagation=!1;break;case"wheel":n.isStoppable=!0,n.isCancelable=!0,n.preventDefault=!1,n.preventGesture=!i.hasScrollHandler,n.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":n.isStoppable=!0,n.isCancelable=!1,n.preventDefault=!1,n.preventGesture=!1,n.stopPropagation=!1;break;case"click":n.isStoppable=!0,n.isCancelable=!0,n.preventDefault=!!i.clickHandler,n.preventGesture=!1,n.stopPropagation=!1;break;case"dblclick":n.isStoppable=!0,n.isCancelable=!0,n.preventDefault=!!i.dblClickHandler,n.preventGesture=!1,n.stopPropagation=!1;break;default:n.isStoppable=!1,n.isCancelable=!1,n.preventDefault=!1,n.preventGesture=!1,n.stopPropagation=!1}e.preProcessEventHandler&&e.preProcessEventHandler(t)}function A(e,t,i){(t=(e=e.getActivePointersListByType(t.type)).getById(t.id))?i&&!t.captured?(t.captured=!0,e.captureCount++):!i&&t.captured&&(t.captured=!1,e.captureCount--,e.captureCount<0)&&(e.captureCount=0,c.console.warn("updatePointerCaptured() - pointsList.captureCount went negative")):c.console.warn("updatePointerCaptured() called on untracked pointer")}function H(e,t,i){var n,s=e.getActivePointersListByType(i.type);(n=s.getById(i.id))?(n.insideElement=!0,n.lastPos=n.currentPos,n.lastTime=n.currentTime,n.currentPos=i.currentPos,n.currentTime=i.currentTime,i=n):(i.captured=!1,i.insideElementPressed=!1,i.insideElement=!0,I(s,i)),e.enterHandler&&e.enterHandler({eventSource:e,pointerType:i.type,position:x(i.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:i.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===i.type,originalEvent:t.originalEvent,userData:e.userData})}function B(e,t,i){var n,s=e.getActivePointersListByType(i.type);(n=s.getById(i.id))?(n.captured?(n.insideElement=!1,n.lastPos=n.currentPos,n.lastTime=n.currentTime,n.currentPos=i.currentPos,n.currentTime=i.currentTime):z(e,s,n),i=n):(i.captured=!1,i.insideElementPressed=!1),(e.leaveHandler||e.exitHandler)&&(t={eventSource:e,pointerType:i.type,position:i.currentPos&&x(i.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:i.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===i.type,originalEvent:t.originalEvent,userData:e.userData},e.leaveHandler&&e.leaveHandler(t),e.exitHandler)&&e.exitHandler(t)}function F(e,t,i,n){var s,o=u[e.hash],r=e.getActivePointersListByType(i.type);void 0!==t.originalEvent.buttons?r.buttons=t.originalEvent.buttons:0===n?r.buttons|=1:1===n?r.buttons|=4:2===n?r.buttons|=2:3===n?r.buttons|=8:4===n?r.buttons|=16:5===n&&(r.buttons|=32),0===n?((s=r.getById(i.id))?(s.insideElementPressed=!0,s.insideElement=!0,s.originalTarget=t.originalEvent.target,s.contactPos=i.currentPos,s.contactTime=i.currentTime,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=i.currentPos,s.currentTime=i.currentTime,i=s):(i.captured=!1,i.insideElementPressed=!0,i.insideElement=!0,i.originalTarget=t.originalEvent.target,I(r,i)),r.addContact(),t.preventGesture||t.defaultPrevented?(t.shouldCapture=!1,t.shouldReleaseCapture=!1):(t.shouldCapture=!0,t.shouldReleaseCapture=!1,t.preventDefault=!0,(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&c.MouseTracker.gesturePointVelocityTracker.addPoint(e,i),1===r.contacts?e.pressHandler&&!t.preventGesture&&e.pressHandler({eventSource:e,pointerType:i.type,position:x(i.contactPos,e.element),buttons:r.buttons,isTouchEvent:"touch"===i.type,originalEvent:t.originalEvent,userData:e.userData}):2===r.contacts&&e.pinchHandler&&"touch"===i.type&&(o.pinchGPoints=r.asArray(),o.lastPinchDist=o.currentPinchDist=o.pinchGPoints[0].currentPos.distanceTo(o.pinchGPoints[1].currentPos),o.lastPinchCenter=o.currentPinchCenter=b(o.pinchGPoints[0].currentPos,o.pinchGPoints[1].currentPos)))):(t.shouldCapture=!1,t.shouldReleaseCapture=!1,!e.nonPrimaryPressHandler||t.preventGesture||t.defaultPrevented||(t.preventDefault=!0,e.nonPrimaryPressHandler({eventSource:e,pointerType:i.type,position:x(i.currentPos,e.element),button:n,buttons:r.buttons,isTouchEvent:"touch"===i.type,originalEvent:t.originalEvent,userData:e.userData})))}function N(e,t,i,n){var s,o,r,a=u[e.hash],l=e.getActivePointersListByType(i.type),h=!1;void 0!==t.originalEvent.buttons?l.buttons=t.originalEvent.buttons:0===n?l.buttons^=-2:1===n?l.buttons^=-5:2===n?l.buttons^=-3:3===n?l.buttons^=-9:4===n?l.buttons^=-17:5===n&&(l.buttons^=-33),t.shouldCapture=!1,0===n?((o=l.getById(i.id))?(l.removeContact(),o.captured&&(h=!0),o.lastPos=o.currentPos,o.lastTime=o.currentTime,o.currentPos=i.currentPos,o.currentTime=i.currentTime,o.insideElement||z(e,l,o),s=o.currentPos,r=o.currentTime):(i.captured=!1,i.insideElementPressed=!1,i.insideElement=!0,I(l,i),o=i),t.preventGesture||t.defaultPrevented||(h?(t.shouldReleaseCapture=!0,t.preventDefault=!0,(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&c.MouseTracker.gesturePointVelocityTracker.removePoint(e,o),0===l.contacts?(e.releaseHandler&&s&&e.releaseHandler({eventSource:e,pointerType:o.type,position:x(s,e.element),buttons:l.buttons,insideElementPressed:o.insideElementPressed,insideElementReleased:o.insideElement,isTouchEvent:"touch"===o.type,originalEvent:t.originalEvent,userData:e.userData}),e.dragEndHandler&&a.sentDragEvent&&e.dragEndHandler({eventSource:e,pointerType:o.type,position:x(o.currentPos,e.element),speed:o.speed,direction:o.direction,shift:t.originalEvent.shiftKey,isTouchEvent:"touch"===o.type,originalEvent:t.originalEvent,userData:e.userData}),a.sentDragEvent=!1,(e.clickHandler||e.dblClickHandler)&&o.insideElement&&(r=r-o.contactTime<=e.clickTimeThreshold&&o.contactPos.distanceTo(s)<=e.clickDistThreshold,e.clickHandler&&e.clickHandler({eventSource:e,pointerType:o.type,position:x(o.currentPos,e.element),quick:r,shift:t.originalEvent.shiftKey,isTouchEvent:"touch"===o.type,originalEvent:t.originalEvent,originalTarget:o.originalTarget,userData:e.userData}),e.dblClickHandler)&&r&&(l.clicks++,1===l.clicks?(a.lastClickPos=s,a.dblClickTimeOut=setTimeout(function(){l.clicks=0},e.dblClickTimeThreshold)):2===l.clicks&&(clearTimeout(a.dblClickTimeOut),l.clicks=0,a.lastClickPos.distanceTo(s)<=e.dblClickDistThreshold&&e.dblClickHandler({eventSource:e,pointerType:o.type,position:x(o.currentPos,e.element),shift:t.originalEvent.shiftKey,isTouchEvent:"touch"===o.type,originalEvent:t.originalEvent,userData:e.userData}),a.lastClickPos=null))):2===l.contacts&&e.pinchHandler&&"touch"===o.type&&(a.pinchGPoints=l.asArray(),a.lastPinchDist=a.currentPinchDist=a.pinchGPoints[0].currentPos.distanceTo(a.pinchGPoints[1].currentPos),a.lastPinchCenter=a.currentPinchCenter=b(a.pinchGPoints[0].currentPos,a.pinchGPoints[1].currentPos))):(t.shouldReleaseCapture=!1,e.releaseHandler&&s&&(e.releaseHandler({eventSource:e,pointerType:o.type,position:x(s,e.element),buttons:l.buttons,insideElementPressed:o.insideElementPressed,insideElementReleased:o.insideElement,isTouchEvent:"touch"===o.type,originalEvent:t.originalEvent,userData:e.userData}),t.preventDefault=!0)))):(t.shouldReleaseCapture=!1,!e.nonPrimaryReleaseHandler||t.preventGesture||t.defaultPrevented||(t.preventDefault=!0,e.nonPrimaryReleaseHandler({eventSource:e,pointerType:i.type,position:x(i.currentPos,e.element),button:n,buttons:l.buttons,isTouchEvent:"touch"===i.type,originalEvent:t.originalEvent,userData:e.userData})))}function j(n,s,o){var e,t,i=u[n.hash],r=n.getActivePointersListByType(o.type);void 0!==s.originalEvent.buttons&&(r.buttons=s.originalEvent.buttons),(e=r.getById(o.id))&&(e.lastPos=e.currentPos,e.lastTime=e.currentTime,e.currentPos=o.currentPos,e.currentTime=o.currentTime,s.shouldCapture=!1,s.shouldReleaseCapture=!1,n.stopHandler&&"mouse"===o.type&&(clearTimeout(n.stopTimeOut),n.stopTimeOut=setTimeout(function(){var e=n,t=s.originalEvent,i=o.type;e.stopHandler&&e.stopHandler({eventSource:e,pointerType:i,position:w(t,e.element),buttons:e.getActivePointersListByType(i).buttons,isTouchEvent:"touch"===i,originalEvent:t,userData:e.userData})},n.stopDelay)),0===r.contacts?n.moveHandler&&n.moveHandler({eventSource:n,pointerType:o.type,position:x(o.currentPos,n.element),buttons:r.buttons,isTouchEvent:"touch"===o.type,originalEvent:s.originalEvent,userData:n.userData}):1===r.contacts?(n.moveHandler&&(e=r.asArray()[0],n.moveHandler({eventSource:n,pointerType:e.type,position:x(e.currentPos,n.element),buttons:r.buttons,isTouchEvent:"touch"===e.type,originalEvent:s.originalEvent,userData:n.userData})),!n.dragHandler||s.preventGesture||s.defaultPrevented||(t=(e=r.asArray()[0]).currentPos.minus(e.lastPos),n.dragHandler({eventSource:n,pointerType:e.type,position:x(e.currentPos,n.element),buttons:r.buttons,delta:t,speed:e.speed,direction:e.direction,shift:s.originalEvent.shiftKey,isTouchEvent:"touch"===e.type,originalEvent:s.originalEvent,userData:n.userData}),s.preventDefault=!0,i.sentDragEvent=!0)):2===r.contacts&&(n.moveHandler&&(e=r.asArray(),n.moveHandler({eventSource:n,pointerType:e[0].type,position:x(b(e[0].currentPos,e[1].currentPos),n.element),buttons:r.buttons,isTouchEvent:"touch"===e[0].type,originalEvent:s.originalEvent,userData:n.userData})),!n.pinchHandler||"touch"!==o.type||s.preventGesture||s.defaultPrevented||(t=i.pinchGPoints[0].currentPos.distanceTo(i.pinchGPoints[1].currentPos))===i.currentPinchDist||(i.lastPinchDist=i.currentPinchDist,i.currentPinchDist=t,i.lastPinchCenter=i.currentPinchCenter,i.currentPinchCenter=b(i.pinchGPoints[0].currentPos,i.pinchGPoints[1].currentPos),n.pinchHandler({eventSource:n,pointerType:"touch",gesturePoints:i.pinchGPoints,lastCenter:x(i.lastPinchCenter,n.element),center:x(i.currentPinchCenter,n.element),lastDistance:i.lastPinchDist,distance:i.currentPinchDist,shift:s.originalEvent.shiftKey,originalEvent:s.originalEvent,userData:n.userData}),s.preventDefault=!0)))}function W(e,t,i){var n=e.getActivePointersListByType(i.type);(i=n.getById(i.id))&&z(e,n,i)}c.MouseTracker.gesturePointVelocityTracker=(a=[],l=o=0,{addPoint:function(e,t){e=d(e,t),a.push({guid:e,gPoint:t,lastPos:t.currentPos}),1===a.length&&(l=c.now(),o=window.setInterval(M,50))},removePoint:function(e,t){for(var i=d(e,t),n=a.length,s=0;s<n;s++)if(a[s].guid===i){a.splice(s,1),0==--n&&window.clearInterval(o);break}}}),c.MouseTracker.captureElement=document,c.MouseTracker.wheelEventName=c.Browser.vendor===c.BROWSERS.IE&&8<c.Browser.version||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",c.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",c.MouseTracker.wheelEventName],"DOMMouseScroll"===c.MouseTracker.wheelEventName&&c.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(c.MouseTracker.havePointerEvents=!0,c.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),c.MouseTracker.havePointerCapture=(e=document.createElement("div"),c.isFunction(e.setPointerCapture)&&c.isFunction(e.releasePointerCapture)),c.MouseTracker.havePointerCapture&&c.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(c.MouseTracker.havePointerEvents=!1,c.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),c.MouseTracker.mousePointerId="legacy-mouse",c.MouseTracker.havePointerCapture=(e=document.createElement("div"),c.isFunction(e.setCapture)&&c.isFunction(e.releaseCapture)),c.MouseTracker.havePointerCapture&&c.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&c.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&c.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),c.MouseTracker.GesturePointList=function(e){this._gPoints=[],this.type=e,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},c.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(e){return this._gPoints.push(e)},removeById:function(e){for(var t=this._gPoints.length,i=0;i<t;i++)if(this._gPoints[i].id===e){this._gPoints.splice(i,1);break}return this._gPoints.length},getByIndex:function(e){return e<this._gPoints.length?this._gPoints[e]:null},getById:function(e){for(var t=this._gPoints.length,i=0;i<t;i++)if(this._gPoints[i].id===e)return this._gPoints[i];return null},getPrimary:function(e){for(var t=this._gPoints.length,i=0;i<t;i++)if(this._gPoints[i].isPrimary)return this._gPoints[i];return null},addContact:function(){++this.contacts,1<this.contacts&&("mouse"===this.type||"pen"===this.type)&&(c.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}}}(OpenSeadragon),function(s){s.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},s.Control=function(e,t,i){var n=e.parentNode;"number"==typeof t&&(s.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),t={anchor:t}),t.attachToViewer=void 0===t.attachToViewer||t.attachToViewer,this.autoFade=void 0===t.autoFade||t.autoFade,this.element=e,this.anchor=t.anchor,this.container=i,this.anchor===s.ControlAnchor.ABSOLUTE?(this.wrapper=s.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof t.top?t.top+"px":t.top,this.wrapper.style.left="number"==typeof t.left?t.left+"px":t.left,this.wrapper.style.height="number"==typeof t.height?t.height+"px":t.height,this.wrapper.style.width="number"==typeof t.width?t.width+"px":t.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=s.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===s.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),t.attachToViewer?this.anchor===s.ControlAnchor.TOP_RIGHT||this.anchor===s.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):n.appendChild(this.wrapper)},s.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==s.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!==this.wrapper.style.display},setVisible:function(e){this.wrapper.style.display=e?this.anchor===s.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(e){this.element[s.SIGNAL]&&s.Browser.vendor===s.BROWSERS.IE?s.setElementOpacity(this.element,e,!0):s.setElementOpacity(this.wrapper,e,!0)}}}(OpenSeadragon),function(s){function n(e,t){for(var i=e.controls,n=i.length-1;0<=n;n--)if(i[n].element===t)return n;return-1}s.ControlDock=function(e){var t,i,n=["topleft","topright","bottomright","bottomleft"];for(s.extend(!0,this,{id:"controldock-"+s.now()+"-"+Math.floor(1e6*Math.random()),container:s.makeNeutralElement("div"),controls:[]},e),this.container.onsubmit=function(){return!1},this.element&&(this.element=s.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),i=0;i<n.length;i++)this.controls[t=n[i]]=s.makeNeutralElement("div"),this.controls[t].style.position="absolute",t.match("left")&&(this.controls[t].style.left="0px"),t.match("right")&&(this.controls[t].style.right="0px"),t.match("top")&&(this.controls[t].style.top="0px"),t.match("bottom")&&(this.controls[t].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},s.ControlDock.prototype={addControl:function(e,t){var i=null;if(!(0<=n(this,e=s.getElement(e)))){switch(t.anchor){case s.ControlAnchor.TOP_RIGHT:i=this.controls.topright,e.style.position="relative",e.style.paddingRight="0px",e.style.paddingTop="0px";break;case s.ControlAnchor.BOTTOM_RIGHT:i=this.controls.bottomright,e.style.position="relative",e.style.paddingRight="0px",e.style.paddingBottom="0px";break;case s.ControlAnchor.BOTTOM_LEFT:i=this.controls.bottomleft,e.style.position="relative",e.style.paddingLeft="0px",e.style.paddingBottom="0px";break;case s.ControlAnchor.TOP_LEFT:i=this.controls.topleft,e.style.position="relative",e.style.paddingLeft="0px",e.style.paddingTop="0px";break;case s.ControlAnchor.ABSOLUTE:i=this.container,e.style.margin="0px",e.style.padding="0px";break;default:case s.ControlAnchor.NONE:i=this.container,e.style.margin="0px",e.style.padding="0px"}this.controls.push(new s.Control(e,t,i)),e.style.display="inline-block"}},removeControl:function(e){return 0<=(e=n(this,e=s.getElement(e)))&&(this.controls[e].destroy(),this.controls.splice(e,1)),this},clearControls:function(){for(;0<this.controls.length;)this.controls.pop().destroy();return this},areControlsEnabled:function(){for(var e=this.controls.length-1;0<=e;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){for(var t=this.controls.length-1;0<=t;t--)this.controls[t].setVisible(e);return this}}}(OpenSeadragon),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(m){var c={},s=1;function a(e){return e=m.getElement(e),new m.Point(0===e.clientWidth?1:e.clientWidth,0===e.clientHeight?1:e.clientHeight)}function h(e,t){var i,n,s,o,r,a;return t instanceof m.Overlay?t:(i=null,t.element?i=m.getElement(t.element):(r=t.id||"openseadragon-overlay-"+Math.floor(1e7*Math.random()),(i=m.getElement(t.id))||((i=document.createElement("a")).href="#/overlay/"+r),i.id=r,m.addClass(i,t.className||"openseadragon-overlay")),n=t.location,s=t.width,o=t.height,n||(r=t.x,a=t.y,void 0!==t.px&&(r=(e=e.viewport.imageToViewportRectangle(new m.Rect(t.px,t.py,s||0,o||0))).x,a=e.y,s=void 0!==s?e.width:void 0,o=void 0!==o?e.height:void 0),n=new m.Point(r,a)),(a=t.placement)&&"string"===m.type(a)&&(a=m.Placement[t.placement.toUpperCase()]),new m.Overlay({element:i,location:n,placement:a,onDraw:t.onDraw,checkResize:t.checkResize,width:s,height:o,rotationMode:t.rotationMode}))}function o(e,t){for(var i=e.length-1;0<=i;i--)if(e[i].element===t)return i;return-1}function l(e,t){return m.requestAnimationFrame(function(){t(e)})}function r(s){m.requestAnimationFrame(function(){var e,t,i,n=s;if(n.controlsShouldFade){for(e=m.now(),t=1-(e-=n.controlsFadeBeginTime)/n.controlsFadeLength,t=Math.min(1,t),t=Math.max(0,t),i=n.controls.length-1;0<=i;i--)n.controls[i].autoFade&&n.controls[i].setOpacity(t);0<t&&r(n)}})}function u(e){e.autoHideControls&&(e.controlsShouldFade=!0,e.controlsFadeBeginTime=m.now()+e.controlsFadeDelay,window.setTimeout(function(){r(e)},e.controlsFadeDelay))}function d(e){var t;for(e.controlsShouldFade=!1,t=e.controls.length-1;0<=t;t--)e.controls[t].setOpacity(1)}function f(){d(this)}function v(){u(this)}function p(e){var t={tracker:e.eventSource,position:e.position,originalEvent:e.originalEvent,preventDefault:e.preventDefault};this.raiseEvent("canvas-contextmenu",t),e.preventDefault=t.preventDefault}function g(e){var t={originalEvent:e.originalEvent,preventDefaultAction:!1,preventVerticalPan:e.preventVerticalPan||!this.panVertical,preventHorizontalPan:e.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||e.ctrl||e.alt||e.meta)e.preventDefault=!1;else switch(e.keyCode){case 38:t.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),e.preventDefault=!0;break;case 40:t.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),e.preventDefault=!0;break;case 37:t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),e.preventDefault=!0;break;case 39:t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),e.preventDefault=!0;break;default:e.preventDefault=!1}}function y(e){var t={originalEvent:e.originalEvent,preventDefaultAction:!1,preventVerticalPan:e.preventVerticalPan||!this.panVertical,preventHorizontalPan:e.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||e.ctrl||e.alt||e.meta)e.preventDefault=!1;else switch(e.keyCode){case 43:case 61:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),e.preventDefault=!0;break;case 45:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),e.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),e.preventDefault=!0;break;case 119:case 87:t.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(0,-40))),this.viewport.applyConstraints()),e.preventDefault=!0;break;case 115:case 83:t.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(0,40))),this.viewport.applyConstraints()),e.preventDefault=!0;break;case 97:t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(-40,0))),this.viewport.applyConstraints()),e.preventDefault=!0;break;case 100:t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new m.Point(40,0))),this.viewport.applyConstraints()),e.preventDefault=!0;break;case 114:this.viewport.flipped?this.viewport.setRotation(m.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(m.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),e.preventDefault=!0;break;case 82:this.viewport.flipped?this.viewport.setRotation(m.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(m.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),e.preventDefault=!0;break;case 102:this.viewport.toggleFlip(),e.preventDefault=!0;break;case 106:this.goToPreviousPage();break;case 107:this.goToNextPage();break;default:e.preventDefault=!1}}function w(e){document.activeElement!==this.canvas&&this.canvas.focus(),this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var t={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,originalTarget:e.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",t),!t.preventDefaultAction&&this.viewport&&e.quick&&(t=this.gestureSettingsByDeviceType(e.pointerType)).clickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function x(e){var t={tracker:e.eventSource,position:e.position,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",t),!t.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType)).dblClickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function b(e){var t,i,n,s={tracker:e.eventSource,pointerType:e.pointerType,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-drag",s),(t=this.gestureSettingsByDeviceType(e.pointerType)).dragToPan&&!s.preventDefaultAction&&this.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.flipped&&(e.delta.x=-e.delta.x),this.constrainDuringPan&&(i=this.viewport.deltaPointsFromPixels(e.delta.negate()),this.viewport.centerSpringX.target.value+=i.x,this.viewport.centerSpringY.target.value+=i.y,n=this.viewport.getBounds(),s=this.viewport.getConstrainedBounds(),this.viewport.centerSpringX.target.value-=i.x,this.viewport.centerSpringY.target.value-=i.y,n.x!==s.x&&(e.delta.x=0),n.y!==s.y)&&(e.delta.y=0),this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate()),t.flickEnabled&&!this.constrainDuringPan))}function T(e){var t,i,n={tracker:e.eventSource,pointerType:e.pointerType,position:e.position,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-drag-end",n),!n.preventDefaultAction&&this.viewport&&((t=this.gestureSettingsByDeviceType(e.pointerType)).flickEnabled&&e.speed>=t.flickMinSpeed&&(i=0,this.panHorizontal&&(i=t.flickMomentum*e.speed*Math.cos(e.direction)),n=0,this.panVertical&&(n=t.flickMomentum*e.speed*Math.sin(e.direction)),e=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),n=this.viewport.pointFromPixel(new m.Point(e.x-i,e.y-n)),this.viewport.panTo(n,!1)),this.viewport.applyConstraints())}function E(e){this.raiseEvent("canvas-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function S(e){this.raiseEvent("canvas-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function _(e){this.raiseEvent("canvas-press",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function P(e){this.raiseEvent("canvas-release",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function C(e){this.raiseEvent("canvas-nonprimary-press",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function k(e){this.raiseEvent("canvas-nonprimary-release",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function R(e){var t,i,n,s={tracker:e.eventSource,pointerType:e.pointerType,gesturePoints:e.gesturePoints,lastCenter:e.lastCenter,center:e.center,lastDistance:e.lastDistance,distance:e.distance,shift:e.shift,originalEvent:e.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};this.raiseEvent("canvas-pinch",s),this.viewport&&(!(t=this.gestureSettingsByDeviceType(e.pointerType)).pinchToZoom||s.preventDefaultPanAction&&s.preventDefaultZoomAction||(i=this.viewport.pointFromPixel(e.center,!0),t.zoomToRefPoint&&!s.preventDefaultPanAction&&(n=this.viewport.pointFromPixel(e.lastCenter,!0).minus(i),this.panHorizontal||(n.x=0),this.panVertical||(n.y=0),this.viewport.panBy(n,!0)),s.preventDefaultZoomAction||this.viewport.zoomBy(e.distance/e.lastDistance,i,!0),this.viewport.applyConstraints()),t.pinchRotate)&&!s.preventDefaultRotateAction&&(s=Math.atan2(e.gesturePoints[0].currentPos.y-e.gesturePoints[1].currentPos.y,e.gesturePoints[0].currentPos.x-e.gesturePoints[1].currentPos.x),e=Math.atan2(e.gesturePoints[0].lastPos.y-e.gesturePoints[1].lastPos.y,e.gesturePoints[0].lastPos.x-e.gesturePoints[1].lastPos.x),this.viewport.setRotation(this.viewport.getRotation()+(s-e)*(180/Math.PI)))}function D(e){var t,i,n;(n=m.now())-this._lastScrollTime>this.minScrollDeltaTime?(this._lastScrollTime=n,t={tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",t),!t.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x),(i=this.gestureSettingsByDeviceType(e.pointerType)).scrollToZoom)&&(n=Math.pow(this.zoomPerScroll,e.scroll),this.viewport.zoomBy(n,i.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()),e.preventDefault=t.preventDefault):e.preventDefault=!0}function L(e){c[this.hash].mouseInside=!0,d(this),this.raiseEvent("container-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function I(e){e.pointers<1&&(c[this.hash].mouseInside=!1,c[this.hash].animating||u(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function z(e){var t,i,n,s,o,r;!(t=e)._opening&&c[t.hash]&&(t.autoResize&&(i=a(t.container),r=c[t.hash].prevContainerSize,i.equals(r)||(n=t.viewport,t.preserveImageSizeOnResize?(s=r.x/i.x,r=n.getZoom()*s,s=n.getCenter(),n.resize(i,!1),n.zoomTo(r,null,!0),n.panTo(s,!0)):(o=n.getBounds(),n.resize(i,!0),n.fitBoundsWithConstraints(o,!0)),c[t.hash].prevContainerSize=i,c[t.hash].forceRedraw=!0)),o=t.viewport.update(),i=t.world.update()||o,o&&t.raiseEvent("viewport-change"),t.referenceStrip&&(i=t.referenceStrip.update(t.viewport)||i),!(o=c[t.hash].animating)&&i&&(t.raiseEvent("animation-start"),d(t)),(o=o&&!i)&&(c[t.hash].animating=!1),(i||o||c[t.hash].forceRedraw||t.world.needsDraw())&&((r=t).imageLoader.clear(),r.drawer.clear(),r.world.draw(),r.raiseEvent("update-viewport",{}),t._drawOverlays(),t.navigator&&t.navigator.update(t.viewport),c[t.hash].forceRedraw=!1,i)&&t.raiseEvent("animation"),o&&(t.raiseEvent("animation-finish"),c[t.hash].mouseInside||u(t)),c[t.hash].animating=i),e.isOpen()?e._updateRequestId=l(e,z):e._updateRequestId=!1}function O(e,t){return e?e+t:t}function A(){c[this.hash].lastZoomTime=m.now(),c[this.hash].zoomFactor=this.zoomPerSecond,c[this.hash].zooming=!0,i(this)}function M(){c[this.hash].lastZoomTime=m.now(),c[this.hash].zoomFactor=1/this.zoomPerSecond,c[this.hash].zooming=!0,i(this)}function H(){c[this.hash].zooming=!1}function i(e){m.requestAnimationFrame(m.delegate(e,t))}function t(){var e,t;c[this.hash].zooming&&this.viewport&&(t=(e=m.now())-c[this.hash].lastZoomTime,t=Math.pow(c[this.hash].zoomFactor,t/1e3),this.viewport.zoomBy(t),this.viewport.applyConstraints(),c[this.hash].lastZoomTime=e,i(this))}function B(){this.viewport&&(c[this.hash].zooming=!1,this.viewport.zoomBy(+this.zoomPerClick),this.viewport.applyConstraints())}function F(){this.viewport&&(c[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function N(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function j(){this.viewport&&this.viewport.goHome()}function W(){this.isFullPage()&&!m.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function U(){var e;this.viewport&&(e=this.viewport.getRotation(),e=this.viewport.flipped?m.positiveModulo(e+this.rotationIncrement,360):m.positiveModulo(e-this.rotationIncrement,360),this.viewport.setRotation(e))}function $(){var e;this.viewport&&(e=this.viewport.getRotation(),e=this.viewport.flipped?m.positiveModulo(e-this.rotationIncrement,360):m.positiveModulo(e+this.rotationIncrement,360),this.viewport.setRotation(e))}function V(){this.viewport.toggleFlip()}m.Viewer=function(e){var t,i=arguments,n=this;if((e=m.isPlainObject(e)?e:{id:i[0],xmlPath:1<i.length?i[1]:void 0,prefixUrl:2<i.length?i[2]:void 0,controls:3<i.length?i[3]:void 0,overlays:4<i.length?i[4]:void 0}).config&&(m.extend(!0,e,e.config),delete e.config),m.extend(!0,this,{id:e.id,hash:e.hash||s++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},m.DEFAULT_SETTINGS,e),void 0===this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(void 0!==c[this.hash]&&m.console.warn("Hash "+this.hash+" has already been used."),c[this.hash]={fsBoundsDelta:new m.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=m.now(),m.EventSource.call(this),this.addHandler("open-failed",function(e){e=m.getString("Errors.OpenFailed",e.eventSource,e.message),n._showMessage(e)}),m.ControlDock.call(this,e),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=m.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(i=this.canvas.style).width="100%",i.height="100%",i.overflow="hidden",i.position="absolute",i.top="0px",i.left="0px",m.setElementTouchActionNone(this.canvas),""!==e.tabIndex&&(this.canvas.tabIndex=void 0===e.tabIndex?0:e.tabIndex),this.container.className="openseadragon-container",(i=this.container.style).width="100%",i.height="100%",i.position="relative",i.overflow="hidden",i.left="0px",i.top="0px",i.textAlign="left",m.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new m.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:m.delegate(this,p),keyDownHandler:m.delegate(this,g),keyHandler:m.delegate(this,y),clickHandler:m.delegate(this,w),dblClickHandler:m.delegate(this,x),dragHandler:m.delegate(this,b),dragEndHandler:m.delegate(this,T),enterHandler:m.delegate(this,E),leaveHandler:m.delegate(this,S),pressHandler:m.delegate(this,_),releaseHandler:m.delegate(this,P),nonPrimaryPressHandler:m.delegate(this,C),nonPrimaryReleaseHandler:m.delegate(this,k),scrollHandler:m.delegate(this,D),pinchHandler:m.delegate(this,R)}),this.outerTracker=new m.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:m.delegate(this,L),leaveHandler:m.delegate(this,I)}),this.toolbar&&(this.toolbar=new m.ControlDock({element:this.toolbar})),this.bindStandardControls(),c[this.hash].prevContainerSize=a(this.container),this.world=new m.World({viewer:this}),this.world.addHandler("add-item",function(e){n.source=n.world.getItemAt(0).source,c[n.hash].forceRedraw=!0,n._updateRequestId||(n._updateRequestId=l(n,z))}),this.world.addHandler("remove-item",function(e){n.world.getItemCount()?n.source=n.world.getItemAt(0).source:n.source=null,c[n.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(e){n.viewport&&n.viewport._setContentBounds(n.world.getHomeBounds(),n.world.getContentFactor())}),this.world.addHandler("item-index-change",function(e){n.source=n.world.getItemAt(0).source}),this.viewport=new m.Viewport({containerSize:c[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new m.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:e.timeout}),this.tileCache=new m.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new m.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=m.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(t=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(t,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(t=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(t,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new m.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),t=0;t<this.customControls.length;t++)this.addControl(this.customControls[t].id,{anchor:this.customControls[t].anchor});m.requestAnimationFrame(function(){u(n)}),void 0===this.imageSmoothingEnabled||this.imageSmoothingEnabled||this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),m._viewers.set(this.element,this)},m.extend(m.Viewer.prototype,m.EventSource.prototype,m.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(e){return m.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(e)},openTileSource:function(e){return m.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(e)},get buttons(){return m.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(i,e){var s=this;if(this.close(),i)if(this.sequenceMode&&m.isArray(i))this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0===e||isNaN(e)||(this.initialPage=e),this.tileSources=i,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip)&&this.addReferenceStrip(),this._updateSequenceButtons(this._sequenceIndex);else if((i=m.isArray(i)?i:[i]).length){this._opening=!0;function o(){if(a+l===n)if(a){!s._firstOpen&&s.preserveViewport||(s.viewport.goHome(!0),s.viewport.update()),s._firstOpen=!1;var e=i[0];if(e.tileSource&&(e=e.tileSource),s.overlays&&!s.preserveOverlays)for(var t=0;t<s.overlays.length;t++)s.currentOverlays[t]=h(s,s.overlays[t]);s._drawOverlays(),s._opening=!1,s.raiseEvent("open",{source:e})}else s._opening=!1,s.raiseEvent("open-failed",r)}for(var r,n=i.length,a=0,l=0,t=0;t<i.length;t++)!function(i){void 0!==(i=m.isPlainObject(i)&&i.tileSource?i:{tileSource:i}).index&&(m.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete i.index),void 0===i.collectionImmediately&&(i.collectionImmediately=!0);var n=i.success,t=(i.success=function(e){if(a++,i.tileSource.overlays)for(var t=0;t<i.tileSource.overlays.length;t++)s.addOverlay(i.tileSource.overlays[t]);n&&n(e),o()},i.error);i.error=function(e){l++,r=r||e,t&&t(e),o()},s.addTiledImage(i)}(i[t])}return this},close:function(){return c[this.hash]&&(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),c[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close")),this},destroy:function(){if(c[this.hash]){if(this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(m.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),c[this.navigator.hash]=null,delete c[this.navigator.hash],this.navigator=null),this.removeAllHandlers(),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),c[this.hash]=null,delete c[this.hash],this.canvas=null,this.container=null,m._viewers.delete(this.element),this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.outerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){for(var e=this.controls.length,t=0;t<this.controls.length;t++)e=e&&this.controls[t].isVisible();return e},setControlsEnabled:function(e){return(e?d:u)(this),this.raiseEvent("controls-enabled",{enabled:e}),this},setDebugMode:function(e){for(var t=0;t<this.world.getItemCount();t++)this.world.getItemAt(t).debugMode=e;this.debugMode=e,this.forceRedraw()},isFullPage:function(){return c[this.hash].fullPage},setFullPage:function(e){var t,i,n=document.body,s=n.style,o=document.documentElement.style,r=this;if(e!==this.isFullPage()){var a={fullPage:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",a),!a.preventDefaultAction){if(e){for(this.elementSize=m.getElementSize(this.element),this.pageScroll=m.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=s.margin,this.docMargin=o.margin,s.margin="0",o.margin="0",this.bodyPadding=s.padding,this.docPadding=o.padding,s.padding="0",o.padding="0",this.bodyWidth=s.width,this.docWidth=o.width,s.width="100%",o.width="100%",this.bodyHeight=s.height,this.docHeight=o.height,s.height="100%",o.height="100%",this.bodyDisplay=s.display,s.display="block",this.previousBody=[],c[this.hash].prevElementParent=this.element.parentNode,c[this.hash].prevNextSibling=this.element.nextSibling,c[this.hash].prevElementWidth=this.element.style.width,c[this.hash].prevElementHeight=this.element.style.height,t=n.childNodes.length,i=0;i<t;i++)this.previousBody.push(n.childNodes[0]),n.removeChild(n.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,n.appendChild(this.toolbar.element),m.addClass(this.toolbar.element,"fullpage")),m.addClass(this.element,"fullpage"),n.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=m.getElementSize(this.element).y-m.getElementSize(this.toolbar.element).y+"px"),c[this.hash].fullPage=!0,m.delegate(this,L)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,s.margin=this.bodyMargin,o.margin=this.docMargin,s.padding=this.bodyPadding,o.padding=this.docPadding,s.width=this.bodyWidth,o.width=this.docWidth,s.height=this.bodyHeight,o.height=this.docHeight,s.display=this.bodyDisplay,n.removeChild(this.element),t=this.previousBody.length,i=0;i<t;i++)n.appendChild(this.previousBody.shift());m.removeClass(this.element,"fullpage"),c[this.hash].prevElementParent.insertBefore(this.element,c[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(n.removeChild(this.toolbar.element),m.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=c[this.hash].prevElementWidth,this.element.style.height=c[this.hash].prevElementHeight;var l=0,h=function(){m.setPageScroll(r.pageScroll);var e=m.getPageScroll();++l<10&&(e.x!==r.pageScroll.x||e.y!==r.pageScroll.y)&&m.requestAnimationFrame(h)};m.requestAnimationFrame(h),c[this.hash].fullPage=!1,m.delegate(this,I)({})}this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:e})}}return this},setFullScreen:function(e){var t=this;if(!m.supportsFullScreen)return this.setFullPage(e);if(m.isFullScreen()!==e){var i={fullScreen:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",i),!i.preventDefaultAction)if(e){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var n=function(){var e=m.isFullScreen();e||(m.removeEvent(document,m.fullScreenEventName,n),m.removeEvent(document,m.fullScreenErrorEventName,n),t.setFullPage(!1),t.isFullPage()&&(t.element.style.width=t.fullPageStyleWidth,t.element.style.height=t.fullPageStyleHeight)),t.navigator&&t.viewport&&setTimeout(function(){t.navigator.update(t.viewport)}),t.raiseEvent("full-screen",{fullScreen:e})};m.addEvent(document,m.fullScreenEventName,n),m.addEvent(document,m.fullScreenErrorEventName,n),m.requestFullScreen(document.body)}else m.exitFullScreen()}return this},isVisible:function(){return"hidden"!==this.container.style.visibility},isFullScreen:function(){return m.isFullScreen()&&this.isFullPage()},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},addTiledImage:function(i){m.console.assert(i,"[Viewer.addTiledImage] options is required"),m.console.assert(i.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),m.console.assert(!i.replace||-1<i.index&&i.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var n=this,s=(i.replace&&(i.replaceItem=n.world.getItemAt(i.index)),this._hideMessage(),void 0===i.placeholderFillStyle&&(i.placeholderFillStyle=this.placeholderFillStyle),void 0===i.opacity&&(i.opacity=this.opacity),void 0===i.preload&&(i.preload=this.preload),void 0===i.compositeOperation&&(i.compositeOperation=this.compositeOperation),void 0===i.crossOriginPolicy&&(i.crossOriginPolicy=(void 0!==i.tileSource.crossOriginPolicy?i.tileSource:this).crossOriginPolicy),void 0===i.ajaxWithCredentials&&(i.ajaxWithCredentials=this.ajaxWithCredentials),void 0===i.loadTilesWithAjax&&(i.loadTilesWithAjax=this.loadTilesWithAjax),void 0===i.ajaxHeaders||null===i.ajaxHeaders?i.ajaxHeaders=this.ajaxHeaders:m.isPlainObject(i.ajaxHeaders)&&m.isPlainObject(this.ajaxHeaders)&&(i.ajaxHeaders=m.extend({},this.ajaxHeaders,i.ajaxHeaders)),{options:i});function t(e){for(var t=0;t<n._loadQueue.length;t++)if(n._loadQueue[t]===s){n._loadQueue.splice(t,1);break}0===n._loadQueue.length&&o(s),n.raiseEvent("add-item-failed",e),i.error&&i.error(e)}function o(e){n.collectionMode&&(n.world.arrange({immediately:e.options.collectionImmediately,rows:n.collectionRows,columns:n.collectionColumns,layout:n.collectionLayout,tileSize:n.collectionTileSize,tileMargin:n.collectionTileMargin}),n.world.setAutoRefigureSizes(!0))}if(m.isArray(i.tileSource))setTimeout(function(){t({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:i.tileSource,options:i})});else{this._loadQueue.push(s);function r(e){s.tileSource=e,p()}function a(e){e.options=i,t(e),p()}var l=this,h=i.tileSource,c=i,u=l;if("string"===m.type(h))if(h.match(/^\s*<.*>\s*$/))h=m.parseXml(h);else if(h.match(/^\s*[{[].*[}\]]\s*$/))try{var e=m.parseJSON(h);h=e}catch(e){}function d(e,t){e.ready?r(e):(e.addHandler("ready",function(){r(e)}),e.addHandler("open-failed",function(e){a({message:e.message,source:t})}))}setTimeout(function(){var e,t;"string"===m.type(h)?(h=new m.TileSource({url:h,crossOriginPolicy:(void 0!==c.crossOriginPolicy?c:l).crossOriginPolicy,ajaxWithCredentials:l.ajaxWithCredentials,ajaxHeaders:c.ajaxHeaders||l.ajaxHeaders,splitHashDataForPost:l.splitHashDataForPost,useCanvas:l.useCanvas,success:function(e){r(e.tileSource)}})).addHandler("open-failed",function(e){a(e)}):m.isPlainObject(h)||h.nodeType?(void 0!==h.crossOriginPolicy||void 0===c.crossOriginPolicy&&void 0===l.crossOriginPolicy||(h.crossOriginPolicy=(void 0!==c.crossOriginPolicy?c:l).crossOriginPolicy),void 0===h.ajaxWithCredentials&&(h.ajaxWithCredentials=l.ajaxWithCredentials),void 0===h.useCanvas&&(h.useCanvas=l.useCanvas),m.isFunction(h.getTileUrl)?((e=new m.TileSource(h)).getTileUrl=h.getTileUrl,r(e)):(t=m.TileSource.determineType(u,h))?(e=t.prototype.configure.apply(u,[h]),d(new t(e),h)):a({message:"Unable to load TileSource",source:h})):d(h,h)})}function p(){for(var e,t,i;n._loadQueue.length&&(e=n._loadQueue[0]).tileSource;)n._loadQueue.splice(0,1),e.options.replace&&(-1!==(i=n.world.getIndexOfItem(e.options.replaceItem))&&(e.options.index=i),n.world.removeItem(e.options.replaceItem)),t=new m.TiledImage({viewer:n,source:e.tileSource,viewport:n.viewport,drawer:n.drawer,tileCache:n.tileCache,imageLoader:n.imageLoader,x:e.options.x,y:e.options.y,width:e.options.width,height:e.options.height,fitBounds:e.options.fitBounds,fitBoundsPlacement:e.options.fitBoundsPlacement,clip:e.options.clip,placeholderFillStyle:e.options.placeholderFillStyle,opacity:e.options.opacity,preload:e.options.preload,degrees:e.options.degrees,flipped:e.options.flipped,compositeOperation:e.options.compositeOperation,springStiffness:n.springStiffness,animationTime:n.animationTime,minZoomImageRatio:n.minZoomImageRatio,wrapHorizontal:n.wrapHorizontal,wrapVertical:n.wrapVertical,immediateRender:n.immediateRender,blendTime:n.blendTime,alwaysBlend:n.alwaysBlend,minPixelRatio:n.minPixelRatio,smoothTileEdgesMinZoom:n.smoothTileEdgesMinZoom,iOSDevice:n.iOSDevice,crossOriginPolicy:e.options.crossOriginPolicy,ajaxWithCredentials:e.options.ajaxWithCredentials,loadTilesWithAjax:e.options.loadTilesWithAjax,ajaxHeaders:e.options.ajaxHeaders,debugMode:n.debugMode,subPixelRoundingForTransparency:n.subPixelRoundingForTransparency}),n.collectionMode&&n.world.setAutoRefigureSizes(!1),n.navigator&&(i=m.extend({},e.options,{replace:!1,originalTiledImage:t,tileSource:e.tileSource}),n.navigator.addTiledImage(i)),n.world.addItem(t,{index:e.options.index}),0===n._loadQueue.length&&o(e),1!==n.world.getItemCount()||n.preserveViewport||n.viewport.goHome(!0),e.options.success&&e.options.success({item:t})}},addSimpleImage:function(e){m.console.assert(e,"[Viewer.addSimpleImage] options is required"),m.console.assert(e.url,"[Viewer.addSimpleImage] options.url is required"),delete(e=m.extend({},e,{tileSource:{type:"image",url:e.url}})).url,this.addTiledImage(e)},addLayer:function(t){var i=this,e=(m.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead."),m.extend({},t,{success:function(e){i.raiseEvent("add-layer",{options:t,drawer:e.item})},error:function(e){i.raiseEvent("add-layer-failed",e)}}));return this.addTiledImage(e),this},getLayerAtLevel:function(e){return m.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(e)},getLevelOfLayer:function(e){return m.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(e)},getLayersCount:function(){return m.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(e,t){return m.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(e,t)},removeLayer:function(e){return m.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(e)},forceRedraw:function(){return c[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var e=m.delegate(this,f),t=m.delegate(this,v),i=m.delegate(this,this.goToNextPage),n=m.delegate(this,this.goToPreviousPage),s=this.navImages,o=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(o=!1),this.previousButton=new m.Button({element:this.previousButton?m.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.PreviousPage"),srcRest:O(this.prefixUrl,s.previous.REST),srcGroup:O(this.prefixUrl,s.previous.GROUP),srcHover:O(this.prefixUrl,s.previous.HOVER),srcDown:O(this.prefixUrl,s.previous.DOWN),onRelease:n,onFocus:e,onBlur:t}),this.nextButton=new m.Button({element:this.nextButton?m.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.NextPage"),srcRest:O(this.prefixUrl,s.next.REST),srcGroup:O(this.prefixUrl,s.next.GROUP),srcHover:O(this.prefixUrl,s.next.HOVER),srcDown:O(this.prefixUrl,s.next.DOWN),onRelease:i,onFocus:e,onBlur:t}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),o)&&(this.paging=new m.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:m.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||m.ControlAnchor.TOP_LEFT})),this},bindStandardControls:function(){var e=m.delegate(this,A),t=m.delegate(this,H),i=m.delegate(this,B),n=m.delegate(this,M),s=m.delegate(this,F),o=m.delegate(this,j),r=m.delegate(this,W),a=m.delegate(this,U),l=m.delegate(this,$),h=m.delegate(this,V),c=m.delegate(this,f),u=m.delegate(this,v),d=this.navImages,p=[],g=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(g=!1),this.showZoomControl&&(p.push(this.zoomInButton=new m.Button({element:this.zoomInButton?m.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.ZoomIn"),srcRest:O(this.prefixUrl,d.zoomIn.REST),srcGroup:O(this.prefixUrl,d.zoomIn.GROUP),srcHover:O(this.prefixUrl,d.zoomIn.HOVER),srcDown:O(this.prefixUrl,d.zoomIn.DOWN),onPress:e,onRelease:t,onClick:i,onEnter:e,onExit:t,onFocus:c,onBlur:u})),p.push(this.zoomOutButton=new m.Button({element:this.zoomOutButton?m.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.ZoomOut"),srcRest:O(this.prefixUrl,d.zoomOut.REST),srcGroup:O(this.prefixUrl,d.zoomOut.GROUP),srcHover:O(this.prefixUrl,d.zoomOut.HOVER),srcDown:O(this.prefixUrl,d.zoomOut.DOWN),onPress:n,onRelease:t,onClick:s,onEnter:n,onExit:t,onFocus:c,onBlur:u}))),this.showHomeControl&&p.push(this.homeButton=new m.Button({element:this.homeButton?m.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.Home"),srcRest:O(this.prefixUrl,d.home.REST),srcGroup:O(this.prefixUrl,d.home.GROUP),srcHover:O(this.prefixUrl,d.home.HOVER),srcDown:O(this.prefixUrl,d.home.DOWN),onRelease:o,onFocus:c,onBlur:u})),this.showFullPageControl&&p.push(this.fullPageButton=new m.Button({element:this.fullPageButton?m.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.FullPage"),srcRest:O(this.prefixUrl,d.fullpage.REST),srcGroup:O(this.prefixUrl,d.fullpage.GROUP),srcHover:O(this.prefixUrl,d.fullpage.HOVER),srcDown:O(this.prefixUrl,d.fullpage.DOWN),onRelease:r,onFocus:c,onBlur:u})),this.showRotationControl&&(p.push(this.rotateLeftButton=new m.Button({element:this.rotateLeftButton?m.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.RotateLeft"),srcRest:O(this.prefixUrl,d.rotateleft.REST),srcGroup:O(this.prefixUrl,d.rotateleft.GROUP),srcHover:O(this.prefixUrl,d.rotateleft.HOVER),srcDown:O(this.prefixUrl,d.rotateleft.DOWN),onRelease:a,onFocus:c,onBlur:u})),p.push(this.rotateRightButton=new m.Button({element:this.rotateRightButton?m.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.RotateRight"),srcRest:O(this.prefixUrl,d.rotateright.REST),srcGroup:O(this.prefixUrl,d.rotateright.GROUP),srcHover:O(this.prefixUrl,d.rotateright.HOVER),srcDown:O(this.prefixUrl,d.rotateright.DOWN),onRelease:l,onFocus:c,onBlur:u}))),this.showFlipControl&&p.push(this.flipButton=new m.Button({element:this.flipButton?m.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:m.getString("Tooltips.Flip"),srcRest:O(this.prefixUrl,d.flip.REST),srcGroup:O(this.prefixUrl,d.flip.GROUP),srcHover:O(this.prefixUrl,d.flip.HOVER),srcDown:O(this.prefixUrl,d.flip.DOWN),onRelease:h,onFocus:c,onBlur:u})),g?(this.buttonGroup=new m.ButtonGroup({buttons:p,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",m.delegate(this,N)),(this.toolbar||this).addControl(this.navControl,{anchor:this.navigationControlAnchor||m.ControlAnchor.TOP_LEFT})):this.customButtons=p),this},currentPage:function(){return this._sequenceIndex},goToPage:function(e){return this.tileSources&&0<=e&&e<this.tileSources.length&&(this._sequenceIndex=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e),this.raiseEvent("page",{page:e})),this},addOverlay:function(e,t,i,n){return i=m.isPlainObject(e)?e:{element:e,location:t,placement:i,onDraw:n},e=m.getElement(i.element),0<=o(this.currentOverlays,e)||(n=h(this,i),this.currentOverlays.push(n),n.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:e,location:i.location,placement:i.placement})),this},updateOverlay:function(e,t,i){var n;return e=m.getElement(e),0<=(n=o(this.currentOverlays,e))&&(this.currentOverlays[n].update(t,i),c[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:e,location:t,placement:i})),this},removeOverlay:function(e){var t;return e=m.getElement(e),0<=(t=o(this.currentOverlays,e))&&(this.currentOverlays[t].destroy(),this.currentOverlays.splice(t,1),c[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:e})),this},clearOverlays:function(){for(;0<this.currentOverlays.length;)this.currentOverlays.pop().destroy();return c[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(e){return e=m.getElement(e),0<=(e=o(this.currentOverlays,e))?this.currentOverlays[e]:null},_updateSequenceButtons:function(e){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==e?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(0<e?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(e){this._hideMessage();var t=m.makeNeutralElement("div");t.appendChild(document.createTextNode(e)),this.messageDiv=m.makeCenteredNode(t),m.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)},gestureSettingsByDeviceType:function(e){switch(e){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){for(var e=this.currentOverlays.length,t=0;t<e;t++)this.currentOverlays[t].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){this.showReferenceStrip=!0,this.sequenceMode?!this.referenceStrip&&this.tileSources.length&&1<this.tileSources.length&&(this.referenceStrip=new m.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex)):m.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),m.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){m.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var e=m.pixelDensityRatio,t=m.getCurrentPixelDensityRatio();e!==t&&(m.pixelDensityRatio=t,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var e=this._sequenceIndex-1;this.navPrevNextWrap&&e<0&&(e+=this.tileSources.length),this.goToPage(e)},goToNextPage:function(){var e=this._sequenceIndex+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)},isAnimating:function(){return c[this.hash].animating}})}(OpenSeadragon),function(a){function l(e){var t={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-click",t),!t.preventDefaultAction&&e.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)&&(this.viewer.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x),e=this.viewport.pointFromPixel(e.position),this.panVertical?this.panHorizontal||(e.x=this.viewer.viewport.getCenter(!0).x):e.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(e),this.viewer.viewport.applyConstraints())}function h(e){var t={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",t),!t.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.flipped&&(e.delta.x=-e.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)),this.viewer.constrainDuringPan)&&this.viewer.viewport.applyConstraints()}function c(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function u(e){var t={tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent,preventDefault:e.preventDefault};this.viewer.raiseEvent("navigator-scroll",t),e.preventDefault=t.preventDefault}function d(e,t){i(e,"rotate("+t+"deg)")}function i(e,t){e.style.webkitTransform=t,e.style.mozTransform=t,e.style.msTransform=t,e.style.oTransform=t,e.style.transform=t}a.Navigator=function(e){var t,i,n,s=e.viewer,o=this;function r(e){d(o.displayRegionContainer,e),d(o.displayRegion,-e),o.viewport.setRotation(e)}e.id?(this.element=document.getElementById(e.id),e.controlOptions={anchor:a.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(e.id="navigator-"+a.now(),this.element=a.makeNeutralElement("div"),e.controlOptions={anchor:a.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:e.autoFade},e.position&&("BOTTOM_RIGHT"===e.position?e.controlOptions.anchor=a.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"===e.position?e.controlOptions.anchor=a.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"===e.position?e.controlOptions.anchor=a.ControlAnchor.TOP_RIGHT:"TOP_LEFT"===e.position?e.controlOptions.anchor=a.ControlAnchor.TOP_LEFT:"ABSOLUTE"===e.position&&(e.controlOptions.anchor=a.ControlAnchor.ABSOLUTE,e.controlOptions.top=e.top,e.controlOptions.left=e.left,e.controlOptions.height=e.height,e.controlOptions.width=e.width))),this.element.id=e.id,this.element.className+=" navigator",(e=a.extend(!0,{sizeRatio:a.DEFAULT_SETTINGS.navigatorSizeRatio},e,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:e.autoResize,minZoomImageRatio:1,background:e.background,opacity:e.opacity,borderColor:e.borderColor,displayRegionColor:e.displayRegionColor})).minPixelRatio=this.minPixelRatio=s.minPixelRatio,a.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new a.Point(1,1),this.totalBorderWidths=new a.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),e.controlOptions.anchor!==a.ControlAnchor.NONE&&(n=this.element.style,i=this.borderWidth,n.margin="0px",n.border=i+"px solid "+e.borderColor,n.padding="0px",n.background=e.background,n.opacity=e.opacity,n.overflow="hidden"),this.displayRegion=a.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",i=this.displayRegion.style,n=this.borderWidth,i.position="relative",i.top="0px",i.left="0px",i.fontSize="0px",i.overflow="hidden",i.border=n+"px solid "+e.displayRegionColor,i.margin="0px",i.padding="0px",i.background="transparent",i.float="left",i.cssFloat="left",i.styleFloat="left",i.zIndex=999999999,i.cursor="default",a.setElementPointerEventsNone(this.displayRegion),a.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=a.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",a.setElementPointerEventsNone(this.displayRegionContainer),a.setElementTouchActionNone(this.displayRegionContainer),s.addControl(this.element,e.controlOptions),this._resizeWithViewer=e.controlOptions.anchor!==a.ControlAnchor.ABSOLUTE&&e.controlOptions.anchor!==a.ControlAnchor.NONE,e.width&&e.height?(this.setWidth(e.width),this.setHeight(e.height)):this._resizeWithViewer&&(t=a.getElementSize(s.element),this.element.style.height=Math.round(t.y*e.sizeRatio)+"px",this.element.style.width=Math.round(t.x*e.sizeRatio)+"px",this.oldViewerSize=t,t=a.getElementSize(this.element),this.elementArea=t.x*t.y),this.oldContainerSize=new a.Point(0,0),a.Viewer.apply(this,[e]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),e.navigatorRotate&&(r(e.viewer.viewport?e.viewer.viewport.getRotation():e.viewer.degrees||0),e.viewer.addHandler("rotate",function(e){r(e.degrees)})),this.innerTracker.destroy(),this.innerTracker=new a.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:a.delegate(this,h),clickHandler:a.delegate(this,l),releaseHandler:a.delegate(this,c),scrollHandler:a.delegate(this,u),preProcessEventHandler:function(e){"wheel"===e.eventType&&(e.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",a.setElementPointerEventsNone(this.canvas),a.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){o.viewport&&o.viewport.goHome(!0)}),s.world.addHandler("item-index-change",function(t){window.setTimeout(function(){var e=o.world.getItemAt(t.previousIndex);o.world.setItemIndex(e,t.newIndex)},1)}),s.world.addHandler("remove-item",function(e){e=e.item,(e=o._getMatchingItem(e))&&o.world.removeItem(e)}),this.update(s.viewport)},a.extend(a.Navigator.prototype,a.EventSource.prototype,a.Viewer.prototype,{updateSize:function(){var e;this.viewport&&!(e=new a.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight)).equals(this.oldContainerSize)&&(this.viewport.resize(e,!0),this.viewport.goHome(!0),this.oldContainerSize=e,this.drawer.clear(),this.world.draw())},setWidth:function(e){this.width=e,this.element.style.width="number"==typeof e?e+"px":e,this._resizeWithViewer=!1},setHeight:function(e){this.height=e,this.element.style.height="number"==typeof e?e+"px":e,this._resizeWithViewer=!1},setFlip:function(e){return this.viewport.setFlip(e),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(e){i(this.displayRegion,e),i(this.canvas,e),i(this.element,e)},update:function(e){var t,i,n=a.getElementSize(this.viewer.element);this._resizeWithViewer&&n.x&&n.y&&!n.equals(this.oldViewerSize)&&(this.oldViewerSize=n,i=this.maintainSizeRatio||!this.elementArea?(t=n.x*this.sizeRatio,n.y*this.sizeRatio):(t=Math.sqrt(this.elementArea*(n.x/n.y)),this.elementArea/t),this.element.style.width=Math.round(t)+"px",this.element.style.height=Math.round(i)+"px",this.elementArea||(this.elementArea=t*i),this.updateSize()),e&&this.viewport&&(n=e.getBoundsNoRotate(!0),t=this.viewport.pixelFromPointNoRotate(n.getTopLeft(),!1),i=this.viewport.pixelFromPointNoRotate(n.getBottomRight(),!1).minus(this.totalBorderWidths),(e=this.displayRegion.style).display=this.world.getItemCount()?"block":"none",e.top=Math.round(t.y)+"px",e.left=Math.round(t.x)+"px",n=Math.abs(t.x-i.x),i=Math.abs(t.y-i.y),e.width=Math.round(Math.max(n,0))+"px",e.height=Math.round(Math.max(i,0))+"px")},addTiledImage:function(e){var n=this,s=e.originalTiledImage;return delete e.original,e=a.extend({},e,{success:function(e){var t=e.item;function i(){n._matchBounds(t,s)}t._originalForNavigator=s,n._matchBounds(t,s,!0),n._matchOpacity(t,s),n._matchCompositeOperation(t,s),s.addHandler("bounds-change",i),s.addHandler("clip-change",i),s.addHandler("opacity-change",function(){n._matchOpacity(t,s)}),s.addHandler("composite-operation-change",function(){n._matchCompositeOperation(t,s)})}}),a.Viewer.prototype.addTiledImage.apply(this,[e])},destroy:function(){return a.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(e){for(var t,i=this.world.getItemCount(),n=0;n<i;n++)if((t=this.world.getItemAt(n))._originalForNavigator===e)return t;return null},_matchBounds:function(e,t,i){var n=t.getBoundsNoRotate();e.setPosition(n.getTopLeft(),i),e.setWidth(n.width,i),e.setRotation(t.getRotation(),i),e.setClip(t.getClip()),e.setFlip(t.getFlip())},_matchOpacity:function(e,t){e.setOpacity(t.opacity)},_matchCompositeOperation:function(e,t){e.setCompositeOperation(t.compositeOperation)}})}(OpenSeadragon),function(r){var a={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};r.extend(r,{getString:function(e){for(var t=e.split("."),i=null,n=arguments,s=a,o=0;o<t.length-1;o++)s=s[t[o]]||{};return"string"!=typeof(i=s[t[o]])&&(r.console.error("Untranslated source string:",e),i=""),i.replace(/\{\d+\}/g,function(e){return(e=parseInt(e.match(/\d+/),10)+1)<n.length?n[e]:""})},setString:function(e,t){for(var i=e.split("."),n=a,s=0;s<i.length-1;s++)n[i[s]]||(n[i[s]]={}),n=n[i[s]];n[i[s]]=t}})}(OpenSeadragon),function(o){o.Point=function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},o.Point.prototype={clone:function(){return new o.Point(this.x,this.y)},plus:function(e){return new o.Point(this.x+e.x,this.y+e.y)},minus:function(e){return new o.Point(this.x-e.x,this.y-e.y)},times:function(e){return new o.Point(this.x*e,this.y*e)},divide:function(e){return new o.Point(this.x/e,this.y/e)},negate:function(){return new o.Point(-this.x,-this.y)},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},squaredDistanceTo:function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},apply:function(e){return new o.Point(e(this.x),e(this.y))},equals:function(e){return e instanceof o.Point&&this.x===e.x&&this.y===e.y},rotate:function(e,t){if(t=t||new o.Point(0,0),e%90==0)switch(o.positiveModulo(e,360)){case 0:n=1,s=0;break;case 90:n=0,s=1;break;case 180:n=-1,s=0;break;case 270:n=0,s=-1}else var i=e*Math.PI/180,n=Math.cos(i),s=Math.sin(i);return i=n*(this.x-t.x)-s*(this.y-t.y)+t.x,t=s*(this.x-t.x)+n*(this.y-t.y)+t.y,new o.Point(i,t)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(h){h.TileSource=function(e,t,i,n,s,o){var r,a=this,l=arguments,l=h.isPlainObject(e)?e:{width:l[0],height:l[1],tileSize:l[2],tileOverlap:l[3],minLevel:l[4],maxLevel:l[5]};if(h.EventSource.call(this),h.extend(!0,this,l),!this.success)for(r=0;r<arguments.length;r++)if(h.isFunction(arguments[r])){this.success=arguments[r];break}this.success&&this.addHandler("ready",function(e){a.success(e)}),"string"===h.type(e)&&(this.url=e),this.url?(this.aspectRatio=1,this.dimensions=new h.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=l.width&&l.height?l.width/l.height:1,this.dimensions=new h.Point(l.width,l.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=l.tileOverlap||0,this.minLevel=l.minLevel||0,this.maxLevel=void 0!==l.maxLevel&&null!==l.maxLevel?l.maxLevel:l.width&&l.height?Math.ceil(Math.log(Math.max(l.width,l.height))/Math.log(2)):0,this.success&&h.isFunction(this.success)&&this.success(this))},h.TileSource.prototype={getTileSize:function(e){return h.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(e){return this._tileWidth||this.getTileSize(e)},getTileHeight:function(e){return this._tileHeight||this.getTileSize(e)},setMaxLevel:function(e){this.maxLevel=e,this._memoizeLevelScale()},getLevelScale:function(e){return this._memoizeLevelScale(),this.getLevelScale(e)},_memoizeLevelScale:function(){for(var t={},e=0;e<=this.maxLevel;e++)t[e]=1/Math.pow(2,this.maxLevel-e);this.getLevelScale=function(e){return t[e]}},getNumTiles:function(e){var t=this.getLevelScale(e),i=Math.ceil(t*this.dimensions.x/this.getTileWidth(e)),e=Math.ceil(t*this.dimensions.y/this.getTileHeight(e));return new h.Point(i,e)},getPixelRatio:function(e){var e=1/(t=this.dimensions.times(this.getLevelScale(e))).x*h.pixelDensityRatio,t=1/t.y*h.pixelDensityRatio;return new h.Point(e,t)},getClosestLevel:function(){for(var e,t=this.minLevel+1;t<=this.maxLevel&&!(1<(e=this.getNumTiles(t)).x||1<e.y);t++);return t-1},getTileAtPoint:function(e,t){var i=0<=t.x&&t.x<=1&&0<=t.y&&t.y<=1/this.aspectRatio,n=(h.console.assert(i,"[TileSource.getTileAtPoint] must be called with a valid point."),this.dimensions.x*this.getLevelScale(e)),i=t.x*n,n=t.y*n;return i=Math.floor(i/this.getTileWidth(e)),n=Math.floor(n/this.getTileHeight(e)),1<=t.x&&(i=this.getNumTiles(e).x-1),t.y>=1/this.aspectRatio-1e-15&&(n=this.getNumTiles(e).y-1),new h.Point(i,n)},getTileBounds:function(e,t,i,n){var s=this.dimensions.times(this.getLevelScale(e)),o=this.getTileWidth(e),r=this.getTileHeight(e),a=0===t?0:o*t-this.tileOverlap,e=0===i?0:r*i-this.tileOverlap,t=o+(0===t?1:2)*this.tileOverlap,r=r+(0===i?1:2)*this.tileOverlap,i=1/s.x;return t=Math.min(t,s.x-a),r=Math.min(r,s.y-e),n?new h.Rect(0,0,t,r):new h.Rect(a*i,e*i,t*i,r*i)},getImageInfo:function(n){var t,i,e,s,o,r,a=this,l=(n&&-1<(o=(s=(e=n.split("/"))[e.length-1]).lastIndexOf("."))&&(e[e.length-1]=s.slice(0,o)),null);this.splitHashDataForPost&&-1!==(r=n.indexOf("#"))&&(l=n.substring(r+1),n=n.substr(0,r)),t=function(e){"string"==typeof e&&(e=h.parseXml(e));var t=h.TileSource.determineType(a,e,n);t?(void 0===(i=t.prototype.configure.apply(a,[e,n,l])).ajaxWithCredentials&&(i.ajaxWithCredentials=a.ajaxWithCredentials),i=new t(i),a.ready=!0,a.raiseEvent("ready",{tileSource:i})):a.raiseEvent("open-failed",{message:"Unable to load TileSource",source:n})},n.match(/\.js$/)?(r=n.split("/").pop().replace(".js",""),h.jsonp({url:n,async:!1,callbackName:r,callback:t})):h.makeAjaxRequest({url:n,postData:l,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(e){e=function(e){var t,i,n,s=e.responseText;e.status;if(!e)throw new Error(h.getString("Errors.Security"));if(200!==e.status&&0!==e.status)throw t=404===(n=e.status)?"Not Found":e.statusText,new Error(h.getString("Errors.Status",n,t));if(s.match(/\s*<.*/))try{i=e.responseXML&&e.responseXML.documentElement?e.responseXML:h.parseXml(s)}catch(t){i=e.responseText}else if(s.match(/\s*[{[].*/))try{i=h.parseJSON(s)}catch(t){i=s}else i=s;return i}(e),t(e)},error:function(e,t){var i;try{i="HTTP "+e.status+" attempting to load TileSource: "+n}catch(e){i=(void 0!==t&&t.toString?t.toString():"Unknown error")+" attempting to load TileSource: "+n}h.console.error(i),a.raiseEvent("open-failed",{message:i,source:n,postData:l})}})},supports:function(e,t){return!1},configure:function(e,t,i){throw new Error("Method not implemented.")},getTileUrl:function(e,t,i){throw new Error("Method not implemented.")},getTilePostData:function(e,t,i){return null},getTileAjaxHeaders:function(e,t,i){return{}},getTileHashKey:function(e,t,i,n,s,o){return s?n+"+"+JSON.stringify(s):n},tileExists:function(e,t,i){var n=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&0<=t&&0<=i&&t<n.x&&i<n.y}},h.extend(!0,h.TileSource.prototype,h.EventSource.prototype),h.TileSource.determineType=function(e,t,i){for(var n in OpenSeadragon)if(n.match(/.+TileSource$/)&&h.isFunction(OpenSeadragon[n])&&h.isFunction(OpenSeadragon[n].prototype.supports)&&OpenSeadragon[n].prototype.supports.call(e,t,i))return OpenSeadragon[n];return h.console.error("No TileSource was able to open %s %s",i,t),null}}(OpenSeadragon),function(d){function u(e,t){for(var i,n=(h=t.Image).Url,s=h.Format,o=h.Size,r=h.DisplayRect||[],a=parseInt(o.Width,10),l=parseInt(o.Height,10),o=parseInt(h.TileSize,10),h=parseInt(h.Overlap,10),c=[],u=0;u<r.length;u++)i=r[u].Rect,c.push(new d.DisplayRect(parseInt(i.X,10),parseInt(i.Y,10),parseInt(i.Width,10),parseInt(i.Height,10),parseInt(i.MinLevel,10),parseInt(i.MaxLevel,10)));return d.extend(!0,{width:a,height:l,tileSize:o,tileOverlap:h,minLevel:null,maxLevel:null,tilesUrl:n,fileFormat:s,displayRects:c},t)}d.DziTileSource=function(e,t,i,n,s,o,r,a,l){var h,c,u,e=d.isPlainObject(e)?e:{width:e,height:t,tileSize:i,tileOverlap:n,tilesUrl:s,fileFormat:o,displayRects:r,minLevel:a,maxLevel:l};if(this._levelRects={},this.tilesUrl=e.tilesUrl,this.fileFormat=e.fileFormat,this.displayRects=e.displayRects,this.displayRects)for(h=this.displayRects.length-1;0<=h;h--)for(u=(c=this.displayRects[h]).minLevel;u<=c.maxLevel;u++)this._levelRects[u]||(this._levelRects[u]=[]),this._levelRects[u].push(c);d.TileSource.apply(this,[e])},d.extend(d.DziTileSource.prototype,d.TileSource.prototype,{supports:function(e,t){var i;return e.Image?i=e.Image.xmlns:!e.documentElement||"Image"!==e.documentElement.localName&&"Image"!==e.documentElement.tagName||(i=e.documentElement.namespaceURI),-1!==(i=(i||"").toLowerCase()).indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==i.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(e,t,i){return e=(d.isPlainObject(e)?u:function(e,t){if(!t||!t.documentElement)throw new Error(d.getString("Errors.Xml"));var i,n,s,o,r,a=t.documentElement,l=a.localName||a.tagName,h=t.documentElement.namespaceURI,t=null,c=[];if("Image"===l)try{if(void 0===(o=a.getElementsByTagName("Size")[0])&&(o=a.getElementsByTagNameNS(h,"Size")[0]),t={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:a.getAttribute("Url"),Format:a.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(a.getAttribute("Overlap"),10),TileSize:parseInt(a.getAttribute("TileSize"),10),Size:{Height:parseInt(o.getAttribute("Height"),10),Width:parseInt(o.getAttribute("Width"),10)}}},!d.imageFormatSupported(t.Image.Format))throw new Error(d.getString("Errors.ImageFormat",t.Image.Format.toUpperCase()));for(void 0===(i=a.getElementsByTagName("DisplayRect"))&&(i=a.getElementsByTagNameNS(h,"DisplayRect")[0]),r=0;r<i.length;r++)void 0===(s=(n=i[r]).getElementsByTagName("Rect")[0])&&(s=n.getElementsByTagNameNS(h,"Rect")[0]),c.push({Rect:{X:parseInt(s.getAttribute("X"),10),Y:parseInt(s.getAttribute("Y"),10),Width:parseInt(s.getAttribute("Width"),10),Height:parseInt(s.getAttribute("Height"),10),MinLevel:parseInt(n.getAttribute("MinLevel"),10),MaxLevel:parseInt(n.getAttribute("MaxLevel"),10)}});return c.length&&(t.Image.DisplayRect=c),u(0,t)}catch(e){throw e instanceof Error?e:new Error(d.getString("Errors.Dzi"))}else{if("Collection"===l)throw new Error(d.getString("Errors.Dzc"));if("Error"===l)throw a=a.getElementsByTagName("Message")[0].firstChild.nodeValue,new Error(a)}throw new Error(d.getString("Errors.Dzi"))})(this,e),t&&!e.tilesUrl&&(e.tilesUrl=t.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),-1!==t.search(/\.(dzi|xml|js)\?/)?e.queryParams=t.match(/\?.*/):e.queryParams=""),e},getTileUrl:function(e,t,i){return[this.tilesUrl,e,"/",t,"_",i,".",this.fileFormat,this.queryParams].join("")},tileExists:function(e,t,i){var n,s,o,r,a,l,h=this._levelRects[e];if(!(this.minLevel&&e<this.minLevel||this.maxLevel&&e>this.maxLevel)){if(!h||!h.length)return!0;for(l=h.length-1;0<=l;l--)if(!(e<(n=h[l]).minLevel||e>n.maxLevel)&&(a=this.getLevelScale(e),s=n.x*a,o=n.y*a,r=s+n.width*a,a=o+n.height*a,s=Math.floor(s/this._tileWidth),o=Math.floor(o/this._tileWidth),r=Math.ceil(r/this._tileWidth),a=Math.ceil(a/this._tileWidth),s<=t)&&t<r&&o<=i&&i<a)return!0}return!1}})}(OpenSeadragon),function(h){function c(e){var t=Array.isArray(e.profile)?e.profile[0]:e.profile,i=-1!==["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"].indexOf(t),t=!1;return 2===e.version&&1<e.profile.length&&e.profile[1].supports&&(t=-1!==e.profile[1].supports.indexOf("sizeByW")),3===e.version&&e.extraFeatures&&(t=-1!==e.extraFeatures.indexOf("sizeByWh")),!i||t}function u(e){for(var t=[],i=0;i<e.sizes.length;i++)t.push({url:e["@id"]+"/full/"+e.sizes[i].width+","+(3===e.version?e.sizes[i].height:"")+"/0/default."+e.tileFormat,width:e.sizes[i].width,height:e.sizes[i].height});return t.sort(function(e,t){return e.width-t.width})}h.IIIFTileSource=function(e){if(h.extend(!0,this,e),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(e.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=e.version,this.tile_width&&this.tile_height)e.tileWidth=this.tile_width,e.tileHeight=this.tile_height;else if(this.tile_width)e.tileSize=this.tile_width;else if(this.tile_height)e.tileSize=this.tile_height;else if(this.tiles)if(1===this.tiles.length)e.tileWidth=this.tiles[0].width,e.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var t=0;t<this.tiles.length;t++)for(var i=0;i<this.tiles[t].scaleFactors.length;i++){var n=this.tiles[t].scaleFactors[i];this.scale_factors.push(n),e.tileSizePerScaleFactor[n]={width:this.tiles[t].width,height:this.tiles[t].height||this.tiles[t].width}}}else if(c(e)){for(var s=Math.min(this.height,this.width),o=[256,512,1024],r=[],a=0;a<o.length;a++)o[a]<=s&&r.push(o[a]);e.tileSize=0<r.length?Math.max.apply(null,r):s}else this.sizes&&0<this.sizes.length?(this.emulateLegacyImagePyramid=!0,e.levels=u(this),h.extend(!0,e,{width:e.levels[e.levels.length-1].width,height:e.levels[e.levels.length-1].height,tileSize:Math.max(e.height,e.width),tileOverlap:0,minLevel:0,maxLevel:e.levels.length-1}),this.levels=e.levels):h.console.error("Nothing in the info.json to construct image pyramids from");var l;e.maxLevel||this.emulateLegacyImagePyramid||(this.scale_factors?(l=Math.max.apply(null,this.scale_factors),e.maxLevel=Math.round(Math.log(l)*Math.LOG2E)):e.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)))),h.TileSource.apply(this,[e])},h.extend(h.IIIFTileSource.prototype,h.TileSource.prototype,{supports:function(e,t){return!!(e.protocol&&"http://iiif.io/api/image"===e.protocol||e["@context"]&&("http://library.stanford.edu/iiif/image-api/1.1/context.json"===e["@context"]||"http://iiif.io/api/image/1/context.json"===e["@context"])||e.profile&&0===e.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")||e.identifier&&e.width&&e.height||e.documentElement&&"info"===e.documentElement.tagName&&"http://library.stanford.edu/iiif/image-api/ns/"===e.documentElement.namespaceURI)},configure:function(e,t,i){if(h.isPlainObject(e)){if(e["@context"]){var n=e["@context"];if(Array.isArray(n))for(var s=0;s<n.length;s++)if("string"==typeof n[s]&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(n[s])||"http://library.stanford.edu/iiif/image-api/1.1/context.json"===n[s])){n=n[s];break}switch(n){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":e.version=1;break;case"http://iiif.io/api/image/2/context.json":e.version=2;break;case"http://iiif.io/api/image/3/context.json":e.version=3;break;default:h.console.error("Data has a @context property which contains no known IIIF context URI.")}}else e["@context"]="http://iiif.io/api/image/1.0/context.json",e["@id"]=t.replace("/info.json",""),e.version=1;if(!e["@id"]&&e.id&&(e["@id"]=e.id),e.preferredFormats)for(var o=0;o<e.preferredFormats.length;o++)if(OpenSeadragon.imageFormatSupported(e.preferredFormats[o])){e.tileFormat=e.preferredFormats[o];break}return e}var r=function(e){if(!e||!e.documentElement)throw new Error(h.getString("Errors.Xml"));var t=e.documentElement;if("info"===t.tagName)try{return function e(t,i,n){var s,o;if(3===t.nodeType&&n)(o=t.nodeValue.trim()).match(/^\d*$/)&&(o=Number(o)),i[n]?(h.isArray(i[n])||(i[n]=[i[n]]),i[n].push(o)):i[n]=o;else if(1===t.nodeType)for(s=0;s<t.childNodes.length;s++)e(t.childNodes[s],i,t.nodeName)}(t,e={}),e}catch(e){throw e instanceof Error?e:new Error(h.getString("Errors.IIIF"))}throw new Error(h.getString("Errors.IIIF"))}(e);return r["@context"]="http://iiif.io/api/image/1.0/context.json",r["@id"]=t.replace("/info.xml",""),r.version=1,r},getTileWidth:function(e){return this.emulateLegacyImagePyramid?h.TileSource.prototype.getTileWidth.call(this,e):(e=Math.pow(2,this.maxLevel-e),this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[e]?this.tileSizePerScaleFactor[e].width:this._tileWidth)},getTileHeight:function(e){return this.emulateLegacyImagePyramid?h.TileSource.prototype.getTileHeight.call(this,e):(e=Math.pow(2,this.maxLevel-e),this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[e]?this.tileSizePerScaleFactor[e].height:this._tileHeight)},getLevelScale:function(e){return this.emulateLegacyImagePyramid?0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel?this.levels[e].width/this.levels[this.maxLevel].width:NaN:h.TileSource.prototype.getLevelScale.call(this,e)},getNumTiles:function(e){return this.emulateLegacyImagePyramid?this.getLevelScale(e)?new h.Point(1,1):new h.Point(0,0):h.TileSource.prototype.getNumTiles.call(this,e)},getTileAtPoint:function(e,t){return this.emulateLegacyImagePyramid?new h.Point(0,0):h.TileSource.prototype.getTileAtPoint.call(this,e,t)},getTileUrl:function(e,t,i){var n,s,o,r,a,l,h,c,u;return this.emulateLegacyImagePyramid?(u=null,0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel?this.levels[e].url:u):(o=Math.pow(.5,this.maxLevel-e),r=Math.ceil(this.width*o),a=Math.ceil(this.height*o),l=this.getTileWidth(e),h=this.getTileHeight(e),c=Math.ceil(l/o),u=Math.ceil(h/o),e=1===this.version?"native."+this.tileFormat:"default."+this.tileFormat,r<l&&a<h?(s=2===this.version&&r===this.width?"full":3===this.version&&r===this.width&&a===this.height?"max":3===this.version?r+","+a:r+",",n="full"):(a=t*c,r=i*u,c=Math.min(c,this.width-a),u=Math.min(u,this.height-r),n=0===t&&0===i&&c===this.width&&u===this.height?"full":[a,r,c,u].join(","),c=Math.ceil(c*o),o=Math.ceil(u*o),s=2===this.version&&c===this.width?"full":3===this.version&&c===this.width&&o===this.height?"max":3===this.version?c+","+o:c+","),[this["@id"],n,s,"0",e].join("/"))},__testonly__:{canBeTiled:c,constructLevels:u}})}(OpenSeadragon),function(o){o.OsmTileSource=function(e,t,i,n,s){(e=o.isPlainObject(e)?e:{width:e,height:t,tileSize:i,tileOverlap:n,tilesUrl:s}).width&&e.height||(e.width=65572864,e.height=65572864),e.tileSize||(e.tileSize=256,e.tileOverlap=0),e.tilesUrl||(e.tilesUrl="http://tile.openstreetmap.org/"),e.minLevel=8,o.TileSource.apply(this,[e])},o.extend(o.OsmTileSource.prototype,o.TileSource.prototype,{supports:function(e,t){return e.type&&"openstreetmaps"===e.type},configure:function(e,t,i){return e},getTileUrl:function(e,t,i){return this.tilesUrl+(e-8)+"/"+t+"/"+i+".png"}})}(OpenSeadragon),function(o){o.TmsTileSource=function(e,t,i,n,s){e=o.isPlainObject(e)?e:{width:e,height:t,tileSize:i,tileOverlap:n,tilesUrl:s},t=256*Math.ceil(e.width/256),i=256*Math.ceil(e.height/256);e.maxLevel=Math.ceil(Math.log(i<t?t/256:i/256)/Math.log(2))-1,e.tileSize=256,e.width=t,e.height=i,o.TileSource.apply(this,[e])},o.extend(o.TmsTileSource.prototype,o.TileSource.prototype,{supports:function(e,t){return e.type&&"tiledmapservice"===e.type},configure:function(e,t,i){return e},getTileUrl:function(e,t,i){var n=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+t+"/"+(n-i)+".png"}})}(OpenSeadragon),function(e){e.ZoomifyTileSource=function(e){void 0===e.tileSize&&(e.tileSize=256),void 0===e.fileFormat&&(e.fileFormat="jpg",this.fileFormat=e.fileFormat);var t={x:e.width,y:e.height};for(e.imageSizes=[{x:e.width,y:e.height}],e.gridSize=[this._getGridSize(e.width,e.height,e.tileSize)];parseInt(t.x,10)>e.tileSize||parseInt(t.y,10)>e.tileSize;)t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),e.imageSizes.push({x:t.x,y:t.y}),e.gridSize.push(this._getGridSize(t.x,t.y,e.tileSize));e.imageSizes.reverse(),e.gridSize.reverse(),e.minLevel=0,e.maxLevel=e.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[e])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(e,t,i){return{x:Math.ceil(e/i),y:Math.ceil(t/i)}},_calculateAbsoluteTileNumber:function(e,t,i){for(var n=0,s={},o=0;o<e;o++)n+=(s=this.gridSize[o]).x*s.y;return n+((s=this.gridSize[e]).x*i+t)},supports:function(e,t){return e.type&&"zoomifytileservice"===e.type},configure:function(e,t,i){return e},getTileUrl:function(e,t,i){var n=this._calculateAbsoluteTileNumber(e,t,i),n=Math.floor(n/256);return this.tilesUrl+"TileGroup"+n+"/"+e+"-"+t+"-"+i+"."+this.fileFormat}})}(OpenSeadragon),function(h){h.LegacyTileSource=function(e){var t,i,n;(t=h.isArray(e)?{type:"legacy-image-pyramid",levels:e}:t).levels=function(e){for(var t,i=[],n=0;n<e.length;n++)(t=e[n]).height&&t.width&&t.url?i.push({url:t.url,width:Number(t.width),height:Number(t.height)}):h.console.error("Unsupported image format: %s",t.url||"<no URL>");return i.sort(function(e,t){return e.height-t.height})}(t.levels),0<t.levels.length?(i=t.levels[t.levels.length-1].width,n=t.levels[t.levels.length-1].height):(n=i=0,h.console.error("No supported image formats found")),h.extend(!0,t,{width:i,height:n,tileSize:Math.max(n,i),tileOverlap:0,minLevel:0,maxLevel:0<t.levels.length?t.levels.length-1:0}),h.TileSource.apply(this,[t]),this.levels=t.levels},h.extend(h.LegacyTileSource.prototype,h.TileSource.prototype,{supports:function(e,t){return e.type&&"legacy-image-pyramid"===e.type||e.documentElement&&"legacy-image-pyramid"===e.documentElement.getAttribute("type")},configure:function(e,t,i){if(h.isPlainObject(e))return e.levels;var n=e;if(!n||!n.documentElement)throw new Error(h.getString("Errors.Xml"));var s,o,r,e=n.documentElement,a=e.tagName,l=null;if("image"===a)try{for(l={type:e.getAttribute("type"),levels:[]},r=e.getElementsByTagName("level"),o=0;o<r.length;o++)s=r[o],l.levels.push({url:s.getAttribute("url"),width:parseInt(s.getAttribute("width"),10),height:parseInt(s.getAttribute("height"),10)});return l.levels}catch(n){throw n instanceof Error?n:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"===a)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"===a)throw new Error("Error: "+n)}throw new Error("Unknown element "+a)},getLevelScale:function(e){return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel?this.levels[e].width/this.levels[this.maxLevel].width:NaN},getNumTiles:function(e){return this.getLevelScale(e)?new h.Point(1,1):new h.Point(0,0)},getTileUrl:function(e,t,i){return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel?this.levels[e].url:null}})}(OpenSeadragon),function(a){a.ImageTileSource=function(e){e=a.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},e),a.TileSource.apply(this,[e])},a.extend(a.ImageTileSource.prototype,a.TileSource.prototype,{supports:function(e,t){return e.type&&"image"===e.type},configure:function(e,t,i){return e},getImageInfo:function(e){var t=this._image=new Image,i=this;this.crossOriginPolicy&&(t.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(t.useCredentials=this.ajaxWithCredentials),a.addEvent(t,"load",function(){i.width=t.naturalWidth,i.height=t.naturalHeight,i.aspectRatio=i.width/i.height,i.dimensions=new a.Point(i.width,i.height),i._tileWidth=i.width,i._tileHeight=i.height,i.tileOverlap=0,i.minLevel=0,i.levels=i._buildLevels(),i.maxLevel=i.levels.length-1,i.ready=!0,i.raiseEvent("ready",{tileSource:i})}),a.addEvent(t,"error",function(){i.raiseEvent("open-failed",{message:"Error loading image at "+e,source:e})}),t.src=e},getLevelScale:function(e){return e>=this.minLevel&&e<=this.maxLevel?this.levels[e].width/this.levels[this.maxLevel].width:NaN},getNumTiles:function(e){return this.getLevelScale(e)?new a.Point(1,1):new a.Point(0,0)},getTileUrl:function(e,t,i){return e>=this.minLevel&&e<=this.maxLevel?this.levels[e].url:null},getContext2D:function(e,t,i){return e>=this.minLevel&&e<=this.maxLevel?this.levels[e].context2D:null},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var e=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(this.buildPyramid&&a.supportsCanvas&&this.useCanvas){var t=this._image.naturalWidth,i=this._image.naturalHeight,n=document.createElement("canvas"),s=n.getContext("2d");if(n.width=t,n.height=i,s.drawImage(this._image,0,0,t,i),e[0].context2D=s,delete this._image,!a.isCanvasTainted(n))for(;2<=t&&2<=i;){var t=Math.floor(t/2),i=Math.floor(i/2),o=document.createElement("canvas"),r=o.getContext("2d");o.width=t,o.height=i,r.drawImage(n,0,0,t,i),e.splice(0,0,{context2D:r,width:t,height:i}),n=o,s=r}}else delete this._image;return e},_freeupCanvasMemory:function(){for(var e=0;e<this.levels.length;e++)this.levels[e].context2D&&(this.levels[e].context2D.canvas.height=0,this.levels[e].context2D.canvas.width=0)}})}(OpenSeadragon),function(s){s.TileSourceCollection=function(e,t,i,n){s.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(n){function s(i){n.requestAnimationFrame(function(){var e,t;(e=i).shouldFade&&(t=n.now(),t=1-(t-=e.fadeBeginTime)/e.fadeLength,t=Math.min(1,t),t=Math.max(0,t),e.imgGroup&&n.setElementOpacity(e.imgGroup,t,!0),0<t)&&s(e)})}function i(e,t){var i;e.element.disabled||(t>=n.ButtonState.GROUP&&e.currentState===n.ButtonState.REST&&((i=e).shouldFade=!1,i.imgGroup&&n.setElementOpacity(i.imgGroup,1,!0),e.currentState=n.ButtonState.GROUP),t>=n.ButtonState.HOVER&&e.currentState===n.ButtonState.GROUP&&(e.imgHover&&(e.imgHover.style.visibility=""),e.currentState=n.ButtonState.HOVER),t>=n.ButtonState.DOWN&&e.currentState===n.ButtonState.HOVER&&(e.imgDown&&(e.imgDown.style.visibility=""),e.currentState=n.ButtonState.DOWN))}function o(e,t){var i;e.element.disabled||(t<=n.ButtonState.HOVER&&e.currentState===n.ButtonState.DOWN&&(e.imgDown&&(e.imgDown.style.visibility="hidden"),e.currentState=n.ButtonState.HOVER),t<=n.ButtonState.GROUP&&e.currentState===n.ButtonState.HOVER&&(e.imgHover&&(e.imgHover.style.visibility="hidden"),e.currentState=n.ButtonState.GROUP),t<=n.ButtonState.REST&&e.currentState===n.ButtonState.GROUP&&((i=e).shouldFade=!0,i.fadeBeginTime=n.now()+i.fadeDelay,window.setTimeout(function(){s(i)},i.fadeDelay),e.currentState=n.ButtonState.REST))}n.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},n.Button=function(e){var t=this;n.EventSource.call(this),n.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:n.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:n.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},e),this.element=e.element||n.makeNeutralElement("div"),e.element||(this.imgRest=n.makeTransparentImage(this.srcRest),this.imgGroup=n.makeTransparentImage(this.srcGroup),this.imgHover=n.makeTransparentImage(this.srcHover),this.imgDown=n.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,n.setElementPointerEventsNone(this.imgRest),n.setElementPointerEventsNone(this.imgGroup),n.setElementPointerEventsNone(this.imgHover),n.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",n.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",n.Browser.vendor===n.BROWSERS.FIREFOX&&n.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=n.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new n.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){e.insideElementPressed?(i(t,n.ButtonState.DOWN),t.raiseEvent("enter",{originalEvent:e.originalEvent})):e.buttonDownAny||i(t,n.ButtonState.HOVER)},focusHandler:function(e){t.tracker.enterHandler(e),t.raiseEvent("focus",{originalEvent:e.originalEvent})},leaveHandler:function(e){o(t,n.ButtonState.GROUP),e.insideElementPressed&&t.raiseEvent("exit",{originalEvent:e.originalEvent})},blurHandler:function(e){t.tracker.leaveHandler(e),t.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(e){i(t,n.ButtonState.DOWN),t.raiseEvent("press",{originalEvent:e.originalEvent})},releaseHandler:function(e){e.insideElementPressed&&e.insideElementReleased?(o(t,n.ButtonState.HOVER),t.raiseEvent("release",{originalEvent:e.originalEvent})):e.insideElementPressed?o(t,n.ButtonState.GROUP):i(t,n.ButtonState.HOVER)},clickHandler:function(e){e.quick&&t.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){13===e.keyCode?(t.raiseEvent("click",{originalEvent:e.originalEvent}),t.raiseEvent("release",{originalEvent:e.originalEvent}),e.preventDefault=!0):e.preventDefault=!1}}),o(this,n.ButtonState.REST)},n.extend(n.Button.prototype,n.EventSource.prototype,{notifyGroupEnter:function(){i(this,n.ButtonState.GROUP)},notifyGroupExit:function(){o(this,n.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,n.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,n.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}})}(OpenSeadragon),function(s){s.ButtonGroup=function(e){s.extend(!0,this,{buttons:[],clickTimeThreshold:s.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:s.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},e);var t,i=this.buttons.concat([]),n=this;if(this.element=e.element||s.makeNeutralElement("div"),!e.group)for(this.element.style.display="inline-block",t=0;t<i.length;t++)this.element.appendChild(i[t].element);s.setElementTouchActionNone(this.element),this.tracker=new s.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){for(var t=0;t<n.buttons.length;t++)n.buttons[t].notifyGroupEnter()},leaveHandler:function(e){var t;if(!e.insideElementPressed)for(t=0;t<n.buttons.length;t++)n.buttons[t].notifyGroupExit()}})},s.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var e=this.buttons.pop();this.element.removeChild(e.element),e.destroy()}this.tracker.destroy(),this.element=null}}}(OpenSeadragon),function(T){T.Rect=function(e,t,i,n,s){var o,r;this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.width="number"==typeof i?i:0,this.height="number"==typeof n?n:0,this.degrees="number"==typeof s?s:0,this.degrees=T.positiveModulo(this.degrees,360),270<=this.degrees?(o=this.getTopRight(),this.x=o.x,this.y=o.y,r=this.height,this.height=this.width,this.width=r,this.degrees-=270):180<=this.degrees?(o=this.getBottomRight(),this.x=o.x,this.y=o.y,this.degrees-=180):90<=this.degrees&&(o=this.getBottomLeft(),this.x=o.x,this.y=o.y,r=this.height,this.height=this.width,this.width=r,this.degrees-=90)},T.Rect.fromSummits=function(e,t,i){var n=e.distanceTo(t),s=e.distanceTo(i);return i=t.minus(e),t=Math.atan(i.y/i.x),i.x<0?t+=Math.PI:i.y<0&&(t+=2*Math.PI),new T.Rect(e.x,e.y,n,s,t/Math.PI*180)},T.Rect.prototype={clone:function(){return new T.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new T.Point(this.x,this.y)},getBottomRight:function(){return new T.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new T.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new T.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new T.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new T.Point(this.width,this.height)},equals:function(e){return e instanceof T.Rect&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height&&this.degrees===e.degrees},times:function(e){return new T.Rect(this.x*e,this.y*e,this.width*e,this.height*e,this.degrees)},translate:function(e){return new T.Rect(this.x+e.x,this.y+e.y,this.width,this.height,this.degrees)},union:function(e){var t=this.getBoundingBox(),i=e.getBoundingBox(),n=Math.min(t.x,i.x),s=Math.min(t.y,i.y);return e=Math.max(t.x+t.width,i.x+i.width),i=Math.max(t.y+t.height,i.y+i.height),new T.Rect(n,s,e-n,i-s)},intersection:function(e){for(var t,i,n,s,o,r,a=1e-10,l=[],h=this.getTopLeft(),c=(e.containsPoint(h,a)&&l.push(h),h=this.getTopRight(),e.containsPoint(h,a)&&l.push(h),h=this.getBottomLeft(),e.containsPoint(h,a)&&l.push(h),h=this.getBottomRight(),e.containsPoint(h,a)&&l.push(h),h=e.getTopLeft(),this.containsPoint(h,a)&&l.push(h),h=e.getTopRight(),this.containsPoint(h,a)&&l.push(h),h=e.getBottomLeft(),this.containsPoint(h,a)&&l.push(h),h=e.getBottomRight(),this.containsPoint(h,a)&&l.push(h),this._getSegments()),u=e._getSegments(),d=0;d<c.length;d++)for(var p=c[d],g=0;g<u.length;g++){var m=u[g];t=p[0],i=p[1],n=m[0],s=m[1],r=o=void 0,o=i.minus(t),r=s.minus(n),(m=0!=(i=-r.x*o.y+o.x*r.y)&&(s=(o.x*(t.y-n.y)-o.y*(t.x-n.x))/i,i=(r.x*(t.y-n.y)-r.y*(t.x-n.x))/i,-a<=s)&&s<=1-a&&-a<=i&&i<=1-a?new T.Point(t.x+i*o.x,t.y+i*o.y):null)&&l.push(m)}if(0===l.length)return null;for(var f=l[0].x,v=l[0].x,y=l[0].y,w=l[0].y,x=1;x<l.length;x++){var b=l[x];b.x<f&&(f=b.x),b.x>v&&(v=b.x),b.y<y&&(y=b.y),b.y>w&&(w=b.y)}return new T.Rect(f,y,v-f,w-y)},_getSegments:function(){var e=this.getTopLeft(),t=this.getTopRight(),i=this.getBottomLeft(),n=this.getBottomRight();return[[e,t],[t,n],[n,i],[i,e]]},rotate:function(e,t){if(0===(e=T.positiveModulo(e,360)))return this.clone();t=t||this.getCenter();var i=this.getTopLeft().rotate(e,t);return e=(e=this.getTopRight().rotate(e,t).minus(i)).apply(function(e){return Math.abs(e)<1e-15?0:e}),t=Math.atan(e.y/e.x),e.x<0?t+=Math.PI:e.y<0&&(t+=2*Math.PI),new T.Rect(i.x,i.y,this.width,this.height,t/Math.PI*180)},getBoundingBox:function(){var e,t,i,n,s,o,r;return 0===this.degrees?this.clone():(e=this.getTopLeft(),t=this.getTopRight(),i=this.getBottomLeft(),r=this.getBottomRight(),n=Math.min(e.x,t.x,i.x,r.x),s=Math.max(e.x,t.x,i.x,r.x),o=Math.min(e.y,t.y,i.y,r.y),r=Math.max(e.y,t.y,i.y,r.y),new T.Rect(n,o,s-n,r-o))},getIntegerBoundingBox:function(){var e=this.getBoundingBox(),t=Math.floor(e.x),i=Math.floor(e.y),n=Math.ceil(e.width+e.x-t),e=Math.ceil(e.height+e.y-i);return new T.Rect(t,i,n,e)},containsPoint:function(e,t){t=t||0;var i=this.getTopLeft(),n=this.getTopRight(),s=this.getBottomLeft(),o=n.minus(i),r=s.minus(i);return(e.x-i.x)*o.x+(e.y-i.y)*o.y>=-t&&(e.x-n.x)*o.x+(e.y-n.y)*o.y<=t&&(e.x-i.x)*r.x+(e.y-i.y)*r.y>=-t&&(e.x-s.x)*r.x+(e.y-s.y)*r.y<=t},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(h){var r={};function a(e){e.quick&&(e="horizontal"===this.scroll?Math.floor(e.position.x/this.panelWidth):Math.floor(e.position.y/this.panelHeight),this.viewer.goToPage(e)),this.element.focus()}function l(e){var t,i,n,s,o;this.dragging=!0,this.element&&(t=Number(this.element.style.marginLeft.replace("px","")),i=Number(this.element.style.marginTop.replace("px","")),n=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),o=h.getElementSize(this.viewer.canvas),"horizontal"===this.scroll?0<-e.delta.x?t>-(n-o.x)&&(this.element.style.marginLeft=t+2*e.delta.x+"px",u(this,o.x,t+2*e.delta.x)):-e.delta.x<0&&t<0&&(this.element.style.marginLeft=t+2*e.delta.x+"px",u(this,o.x,t+2*e.delta.x)):0<-e.delta.y?i>-(s-o.y)&&(this.element.style.marginTop=i+2*e.delta.y+"px",u(this,o.y,i+2*e.delta.y)):-e.delta.y<0&&i<0&&(this.element.style.marginTop=i+2*e.delta.y+"px",u(this,o.y,i+2*e.delta.y)))}function c(e){var t,i,n,s,o;this.element&&(t=Number(this.element.style.marginLeft.replace("px","")),i=Number(this.element.style.marginTop.replace("px","")),n=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),o=h.getElementSize(this.viewer.canvas),"horizontal"===this.scroll?0<e.scroll?t>-(n-o.x)&&(this.element.style.marginLeft=t-60*e.scroll+"px",u(this,o.x,t-60*e.scroll)):e.scroll<0&&t<0&&(this.element.style.marginLeft=t-60*e.scroll+"px",u(this,o.x,t-60*e.scroll)):e.scroll<0?i>o.y-s&&(this.element.style.marginTop=i+60*e.scroll+"px",u(this,o.y,i+60*e.scroll)):0<e.scroll&&i<0&&(this.element.style.marginTop=i+60*e.scroll+"px",u(this,o.y,i+60*e.scroll)),e.preventDefault=!0)}function u(e,t,i){for(var n,s,o,r="horizontal"===e.scroll?e.panelWidth:e.panelHeight,a=Math.ceil(t/r)+5,l=(a=(n=Math.ceil((Math.abs(i)+t)/r)+1)-a)<0?0:a;l<n&&l<e.panels.length;l++)(s=e.panels[l]).activePanel||(o=(o=e.viewer.tileSources[l]).referenceStripThumbnailUrl?{type:"image",url:o.referenceStripThumbnailUrl}:o,o=new h.Viewer({id:s.id,tileSources:[o],element:s,navigatorSizeRatio:e.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:e.viewer.loadTilesWithAjax,ajaxHeaders:e.viewer.ajaxHeaders,useCanvas:e.useCanvas}),h.setElementPointerEventsNone(o.canvas),h.setElementPointerEventsNone(o.container),o.innerTracker.setTracking(!1),o.outerTracker.setTracking(!1),e.miniViewers[s.id]=o,s.activePanel=!0)}function d(e){e=e.eventSource.element,"horizontal"===this.scroll?e.style.marginBottom="0px":e.style.marginLeft="0px"}function p(e){e=e.eventSource.element,"horizontal"===this.scroll?e.style.marginBottom="-"+h.getElementSize(e).y/2+"px":e.style.marginLeft="-"+h.getElementSize(e).x/2+"px"}function g(e){if(e.ctrl||e.alt||e.meta)e.preventDefault=!1;else switch(e.keyCode){case 38:c.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;case 40:case 37:c.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 39:c.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;default:e.preventDefault=!1}}function m(e){if(e.ctrl||e.alt||e.meta)e.preventDefault=!1;else switch(e.keyCode){case 61:c.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;case 45:c.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 48:case 119:case 87:c.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;case 115:case 83:case 97:c.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 100:c.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;default:e.preventDefault=!1}}h.ReferenceStrip=function(e){var t,i,n,s=e.viewer,o=h.getElementSize(s.element);for(e.id||(e.id="referencestrip-"+h.now(),this.element=h.makeNeutralElement("div"),this.element.id=e.id,this.element.className="referencestrip"),e=h.extend(!0,{sizeRatio:h.DEFAULT_SETTINGS.referenceStripSizeRatio,position:h.DEFAULT_SETTINGS.referenceStripPosition,scroll:h.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:h.DEFAULT_SETTINGS.clickTimeThreshold},e,{element:this.element}),h.extend(this,e),r[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,(i=this.element.style).marginTop="0px",i.marginRight="0px",i.marginBottom="0px",i.marginLeft="0px",i.left="0px",i.bottom="0px",i.border="0px",i.background="#000",i.position="relative",h.setElementTouchActionNone(this.element),h.setElementOpacity(this.element,.8),this.viewer=s,this.tracker=new h.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:h.delegate(this,a),dragHandler:h.delegate(this,l),scrollHandler:h.delegate(this,c),enterHandler:h.delegate(this,d),leaveHandler:h.delegate(this,p),keyDownHandler:h.delegate(this,g),keyHandler:h.delegate(this,m),preProcessEventHandler:function(e){"wheel"===e.eventType&&(e.preventDefault=!0)}}),e.width&&e.height?(this.element.style.width=e.width+"px",this.element.style.height=e.height+"px",s.addControl(this.element,{anchor:h.ControlAnchor.BOTTOM_LEFT})):"horizontal"===e.scroll?(this.element.style.width=o.x*e.sizeRatio*s.tileSources.length+12*s.tileSources.length+"px",this.element.style.height=o.y*e.sizeRatio+"px",s.addControl(this.element,{anchor:h.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=o.y*e.sizeRatio*s.tileSources.length+12*s.tileSources.length+"px",this.element.style.width=o.x*e.sizeRatio+"px",s.addControl(this.element,{anchor:h.ControlAnchor.TOP_LEFT})),this.panelWidth=o.x*this.sizeRatio+8,this.panelHeight=o.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},n=0;n<s.tileSources.length;n++)(t=h.makeNeutralElement("div")).id=this.element.id+"-"+n,t.style.width=this.panelWidth+"px",t.style.height=this.panelHeight+"px",t.style.display="inline",t.style.float="left",t.style.cssFloat="left",t.style.styleFloat="left",t.style.padding="2px",h.setElementTouchActionNone(t),h.setElementPointerEventsNone(t),this.element.appendChild(t),t.activePanel=!1,this.panels.push(t);u(this,"vertical"===this.scroll?o.y:o.x,0),this.setFocus(0)},h.ReferenceStrip.prototype={setFocus:function(e){var t,i=this.element.querySelector("#"+this.element.id+"-"+e),n=h.getElementSize(this.viewer.canvas),s=Number(this.element.style.width.replace("px","")),o=Number(this.element.style.height.replace("px","")),r=-Number(this.element.style.marginLeft.replace("px","")),a=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==i&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=i,this.currentSelected.style.background="#999","horizontal"===this.scroll?(t=Number(e)*(this.panelWidth+3))>r+n.x-this.panelWidth?(t=Math.min(t,s-n.x),this.element.style.marginLeft=-t+"px",u(this,n.x,-t)):t<r&&(t=Math.max(0,t-n.x/2),this.element.style.marginLeft=-t+"px",u(this,n.x,-t)):(t=Number(e)*(this.panelHeight+3))>a+n.y-this.panelHeight?(t=Math.min(t,o-n.y),this.element.style.marginTop=-t+"px",u(this,n.y,-t)):t<a&&(t=Math.max(0,t-n.y/2),this.element.style.marginTop=-t+"px",u(this,n.y,-t)),this.currentPage=e,d.call(this,{eventSource:this.tracker}))},update:function(){return!!r[this.id].animating},destroy:function(){if(this.miniViewers)for(var e in this.miniViewers)this.miniViewers[e].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}}}(OpenSeadragon),function(r){r.DisplayRect=function(e,t,i,n,s,o){r.Rect.apply(this,[e,t,i,n]),this.minLevel=s,this.maxLevel=o},r.extend(r.DisplayRect.prototype,r.Rect.prototype)}(OpenSeadragon),function(s){s.Spring=function(e){var t=arguments;"object"!=typeof e&&(e={initial:t.length&&"number"==typeof t[0]?t[0]:void 0,springStiffness:1<t.length?t[1].springStiffness:5,animationTime:1<t.length?t[1].animationTime:1.5}),s.console.assert("number"==typeof e.springStiffness&&0!==e.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),s.console.assert("number"==typeof e.animationTime&&0<=e.animationTime,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),e.exponential&&(this._exponential=!0,delete e.exponential),s.extend(!0,this,e),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:s.now()},s.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},s.Spring.prototype={resetTo:function(e){s.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=e,this.start.time=this.target.time=this.current.time=s.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(e){s.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=e,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(e){this.start.value+=e,this.target.value+=e,this._exponential&&(s.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(e){this._exponential=e,this._exponential&&(s.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=s.now(),t=this._exponential?(e=this.start._logValue,this.target._logValue):(e=this.start.value,this.target.value),i=this.current.time>=this.target.time?t:e+(t-e)*(n=this.springStiffness,i=(this.current.time-this.start.time)/(this.target.time-this.start.time),(1-Math.exp(n*-i))/(1-Math.exp(-n)));var e,t,i,n=this.current.value;return this._exponential?this.current.value=Math.exp(i):this.current.value=i,n!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(t){function i(e){t.extend(!0,this,{timeout:t.DEFAULT_SETTINGS.timeout,jobId:null},e),this.image=null}i.prototype={errorMsg:null,start:function(){var s=this,e=this.abort;this.image=new Image,this.image.onload=function(){s.finish(!0)},this.image.onabort=this.image.onerror=function(){s.errorMsg="Image load aborted",s.finish(!1)},this.jobId=window.setTimeout(function(){s.errorMsg="Image load exceeded timeout ("+s.timeout+" ms)",s.finish(!1)},this.timeout),this.loadWithAjax?(this.request=t.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",postData:this.postData,success:function(t){try{n=new window.Blob([t.response])}catch(e){var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;"TypeError"===e.name&&i&&((i=new i).append(t.response),n=i.getBlob())}0===n.size&&(s.errorMsg="Empty image response.",s.finish(!1));var n=(window.URL||window.webkitURL).createObjectURL(n);s.image.src=n},error:function(e){s.errorMsg="Image load aborted - XHR error: Ajax returned "+e.status,s.finish(!1)}}),this.abort=function(){s.request.abort(),"function"==typeof e&&e()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(e){this.image.onload=this.image.onerror=this.image.onabort=null,e||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},t.ImageLoader=function(e){t.extend(!0,this,{jobLimit:t.DEFAULT_SETTINGS.imageLoaderLimit,timeout:t.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},e)},t.ImageLoader.prototype={addJob:function(n){var s=this,e=new i({src:n.src,loadWithAjax:n.loadWithAjax,ajaxHeaders:n.loadWithAjax?n.ajaxHeaders:null,crossOriginPolicy:n.crossOriginPolicy,ajaxWithCredentials:n.ajaxWithCredentials,postData:n.postData,callback:function(e){var t,i;t=s,e=e,i=n.callback,t.jobsInProgress--,(!t.jobLimit||t.jobsInProgress<t.jobLimit)&&0<t.jobQueue.length&&(t.jobQueue.shift().start(),t.jobsInProgress++),i(e.image,e.errorMsg,e.request)},abort:n.abort,timeout:this.timeout});!this.jobLimit||this.jobsInProgress<this.jobLimit?(e.start(),this.jobsInProgress++):this.jobQueue.push(e)},clear:function(){for(var e=0;e<this.jobQueue.length;e++){var t=this.jobQueue[e];"function"==typeof t.abort&&t.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(d){d.Tile=function(e,t,i,n,s,o,r,a,l,h,c,u){this.level=e,this.x=t,this.y=i,this.bounds=n,this.sourceBounds=h,this.exists=s,this.url=o,this.postData=c,this.context2D=r,this.loadWithAjax=a,this.ajaxHeaders=l,void 0===u&&(d.console.error("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),u=d.TileSource.prototype.getTileHashKey(e,t,i,o,l,c)),this.cacheKey=u,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},d.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(e){this.cacheImageRecord?this.loaded?(this.element||(this.element=d.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!==e&&e.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),d.setElementOpacity(this.element,this.opacity)):d.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):d.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(e,t,i,n,s){var o,r,a=this.position.times(d.pixelDensityRatio),l=this.size.times(d.pixelDensityRatio);this.context2D||this.cacheImageRecord?(r=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&r?(e.save(),e.globalAlpha=this.opacity,"number"==typeof i&&1!==i&&(a=a.times(i),l=l.times(i)),n instanceof d.Point&&(a=a.plus(n)),1===e.globalAlpha&&this._hasTransparencyChannel()&&(s&&(a.x=Math.round(a.x),a.y=Math.round(a.y),l.x=Math.round(l.x),l.y=Math.round(l.y)),e.clearRect(a.x,a.y,l.x,l.y)),t({context:e,tile:this,rendered:r}),i=this.sourceBounds?(o=Math.min(this.sourceBounds.width,r.canvas.width),Math.min(this.sourceBounds.height,r.canvas.height)):(o=r.canvas.width,r.canvas.height),e.translate(a.x+l.x/2,0),this.flipped&&e.scale(-1,1),e.drawImage(r.canvas,0,0,o,i,-l.x/2,a.y,l.x,l.y),e.restore()):d.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):d.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var e;if(this.cacheImageRecord)e=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return d.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;e=this.context2D}return e.canvas.width/(this.size.x*d.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(e,t,i){var n=Math.max(1,Math.ceil((i.x-t.x)/2));return t=Math.max(1,Math.ceil((i.y-t.y)/2)),new d.Point(n,t).minus(this.position.times(d.pixelDensityRatio).times(e||1).apply(function(e){return e%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(o){o.OverlayPlacement=o.Placement,o.OverlayRotationMode=o.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),o.Overlay=function(e,t,i){i=o.isPlainObject(e)?e:{element:e,location:t,placement:i},this.element=i.element,this.style=i.element.style,this._init(i)},o.Overlay.prototype={_init:function(e){this.location=e.location,this.placement=void 0===e.placement?o.Placement.TOP_LEFT:e.placement,this.onDraw=e.onDraw,this.checkResize=void 0===e.checkResize||e.checkResize,this.width=void 0===e.width?null:e.width,this.height=void 0===e.height?null:e.height,this.rotationMode=e.rotationMode||o.OverlayRotationMode.EXACT,this.location instanceof o.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=o.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new o.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(e,t){var i=o.Placement.properties[this.placement];i&&(i.isHorizontallyCentered?e.x-=t.x/2:i.isRight&&(e.x-=t.x),i.isVerticallyCentered?e.y-=t.y/2:i.isBottom&&(e.y-=t.y))},destroy:function(){var e=this.element,t=this.style,i=(e.parentNode&&(e.parentNode.removeChild(e),e.prevElementParent)&&(t.display="none",document.body.appendChild(e)),this.onDraw=null,t.top="",t.left="",t.position="",null!==this.width&&(t.width=""),null!==this.height&&(t.height=""),o.getCssPropertyWithVendorPrefix("transformOrigin")),e=o.getCssPropertyWithVendorPrefix("transform");i&&e&&(t[i]="",t[e]="")},drawHTML:function(e,t){var i=this.element,n=(i.parentNode!==e&&(i.prevElementParent=i.parentNode,i.prevNextSibling=i.nextSibling,e.appendChild(i),this.style.position="absolute",this.size=o.getElementSize(i)),this._getOverlayPositionAndSize(t));e=n.position,i=this.size=n.size,t=n.rotate,this.onDraw?this.onDraw(e,i,this.element):((n=this.style).left=e.x+"px",n.top=e.y+"px",null!==this.width&&(n.width=i.x+"px"),null!==this.height&&(n.height=i.y+"px"),e=o.getCssPropertyWithVendorPrefix("transformOrigin"),i=o.getCssPropertyWithVendorPrefix("transform"),e&&i&&(t?(n[e]=this._getTransformOrigin(),n[i]="rotate("+t+"deg)"):(n[e]="",n[i]="")),n.display="block")},_getOverlayPositionAndSize:function(e){var t,i=e.pixelFromPoint(this.location,!0),n=this._getSizeInPixels(e),s=(this.adjust(i,n),0);return e.degrees&&this.rotationMode!==o.OverlayRotationMode.NO_ROTATION&&(this.rotationMode===o.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height?(t=new o.Rect(i.x,i.y,n.x,n.y),i=(t=this._getBoundingBox(t,e.degrees)).getTopLeft(),n=t.getSize()):s=e.degrees),{position:i,size:n,rotate:s}},_getSizeInPixels:function(e){var t,i=this.size.x,n=this.size.y;return null===this.width&&null===this.height||(t=e.deltaPixelsFromPointsNoRotate(new o.Point(this.width||0,this.height||0),!0),null!==this.width&&(i=t.x),null!==this.height&&(n=t.y)),!this.checkResize||null!==this.width&&null!==this.height||(t=this.size=o.getElementSize(this.element),null===this.width&&(i=t.x),null===this.height&&(n=t.y)),new o.Point(i,n)},_getBoundingBox:function(e,t){var i=this._getPlacementPoint(e);return e.rotate(t,i).getBoundingBox()},_getPlacementPoint:function(e){var t=new o.Point(e.x,e.y),i=o.Placement.properties[this.placement];return i&&(i.isHorizontallyCentered?t.x+=e.width/2:i.isRight&&(t.x+=e.width),i.isVerticallyCentered?t.y+=e.height/2:i.isBottom&&(t.y+=e.height)),t},_getTransformOrigin:function(){var e="",t=o.Placement.properties[this.placement];return t&&(t.isLeft?e="left":t.isRight&&(e="right"),t.isTop?e+=" top":t.isBottom&&(e+=" bottom")),e},update:function(e,t){t=o.isPlainObject(e)?e:{location:e,placement:t},this._init({location:t.location||this.location,placement:(void 0!==t.placement?t:this).placement,onDraw:t.onDraw||this.onDraw,checkResize:t.checkResize||this.checkResize,width:(void 0!==t.width?t:this).width,height:(void 0!==t.height?t:this).height,rotationMode:t.rotationMode||this.rotationMode})},getBounds:function(e){o.console.assert(e,"A viewport must now be passed to Overlay.getBounds.");var t,i=this.width,n=this.height;return null!==i&&null!==n||(t=e.deltaPointsFromPixelsNoRotate(this.size,!0),null===i&&(i=t.x),null===n&&(n=t.y)),t=this.location.clone(),this.adjust(t,new o.Point(i,n)),this._adjustBoundsForRotation(e,new o.Rect(t.x,t.y,i,n))},_adjustBoundsForRotation:function(e,t){return e&&0!==e.degrees&&this.rotationMode!==o.OverlayRotationMode.EXACT?this.rotationMode!==o.OverlayRotationMode.BOUNDING_BOX?t.rotate(-e.degrees,this._getPlacementPoint(t)):null===this.width||null===this.height?t:(t=this._getOverlayPositionAndSize(e),e.viewerElementToViewportRectangle(new o.Rect(t.position.x,t.position.y,t.size.x,t.size.y))):t}}}(OpenSeadragon),function(a){a.Drawer=function(e){a.console.assert(e.viewer,"[Drawer] options.viewer is required");var t=arguments;a.isPlainObject(e)||(e={source:t[0],viewport:t[1],element:t[2]}),a.console.assert(e.viewport,"[Drawer] options.viewport is required"),a.console.assert(e.element,"[Drawer] options.element is required"),e.source&&a.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=e.viewer,this.viewport=e.viewport,this.debugGridColor="string"==typeof e.debugGridColor?[e.debugGridColor]:e.debugGridColor||a.DEFAULT_SETTINGS.debugGridColor,e.opacity&&a.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=a.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=a.getElement(e.element),this.canvas=a.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas&&(t=this._calculateCanvasSize(),this.canvas.width=t.x,this.canvas.height=t.y),this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",a.setElementOpacity(this.canvas,this.opacity,!0),a.setElementPointerEventsNone(this.canvas),a.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},a.Drawer.prototype={addOverlay:function(e,t,i,n){return a.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(e,t,i,n),this},updateOverlay:function(e,t,i){return a.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(e,t,i),this},removeOverlay:function(e){return a.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(e),this},clearOverlays:function(){return a.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(e){return e=this.viewport.pixelFromPointNoRotate(e,!0),new a.Point(e.x*a.pixelDensityRatio,e.y*a.pixelDensityRatio)},clipWithPolygons:function(e,t){var i;this.useCanvas&&((i=this._getContext(t)).beginPath(),e.forEach(function(e){e.forEach(function(e,t){i[0===t?"moveTo":"lineTo"](e.x,e.y)})}),i.clip())},setOpacity:function(e){a.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var t=this.viewer.world,i=0;i<t.getItemCount();i++)t.getItemAt(i).setOpacity(e);return this},getOpacity:function(){a.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var e=this.viewer.world,t=0,i=0;i<e.getItemCount();i++){var n=e.getItemAt(i).getOpacity();t<n&&(t=n)}return t},needsUpdate:function(){return a.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return a.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return a.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return a.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){var e;this.canvas.innerHTML="",this.useCanvas&&(e=this._calculateCanvasSize(),this.canvas.width===e.x&&this.canvas.height===e.y||(this.canvas.width=e.x,this.canvas.height=e.y,this._updateImageSmoothingEnabled(this.context),null!==this.sketchCanvas&&(e=this._calculateSketchCanvasSize(),this.sketchCanvas.width=e.x,this.sketchCanvas.height=e.y,this._updateImageSmoothingEnabled(this.sketchContext))),this._clear())},_clear:function(e,t){this.useCanvas&&(e=this._getContext(e),t?e.clearRect(t.x,t.y,t.width,t.height):(t=e.canvas,e.clearRect(0,0,t.width,t.height)))},viewportToDrawerRectangle:function(e){var t=this.viewport.pixelFromPointNoRotate(e.getTopLeft(),!0);return e=this.viewport.deltaPixelsFromPointsNoRotate(e.getSize(),!0),new a.Rect(t.x*a.pixelDensityRatio,t.y*a.pixelDensityRatio,e.x*a.pixelDensityRatio,e.y*a.pixelDensityRatio)},drawTile:function(e,t,i,n,s,o){a.console.assert(e,"[Drawer.drawTile] tile is required"),a.console.assert(t,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas?(i=this._getContext(i),e.drawCanvas(i,t,n=n||1,s,o)):e.drawHTML(this.canvas)},_getContext:function(e){var i,t=this.context;return e&&(null===this.sketchCanvas&&(this.sketchCanvas=document.createElement("canvas"),e=this._calculateSketchCanvasSize(),this.sketchCanvas.width=e.x,this.sketchCanvas.height=e.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()&&(i=this).viewer.addHandler("rotate",function e(){var t;0!==i.viewport.getRotation()&&(i.viewer.removeHandler("rotate",e),t=i._calculateSketchCanvasSize(),i.sketchCanvas.width=t.x,i.sketchCanvas.height=t.y)}),this._updateImageSmoothingEnabled(this.sketchContext)),t=this.sketchContext),t},saveContext:function(e){this.useCanvas&&this._getContext(e).save()},restoreContext:function(e){this.useCanvas&&this._getContext(e).restore()},setClip:function(e,t){this.useCanvas&&((t=this._getContext(t)).beginPath(),t.rect(e.x,e.y,e.width,e.height),t.clip())},drawRectangle:function(e,t,i){this.useCanvas&&((i=this._getContext(i)).save(),i.fillStyle=t,i.fillRect(e.x,e.y,e.width,e.height),i.restore())},blendSketch:function(e,t,i,n){var s,o=e;a.isPlainObject(o)||(o={opacity:e,scale:t,translate:i,compositeOperation:n}),this.useCanvas&&this.sketchCanvas&&(e=o.opacity,n=o.compositeOperation,s=o.bounds,this.context.save(),this.context.globalAlpha=e,n&&(this.context.globalCompositeOperation=n),s?(s.x<0&&(s.width+=s.x,s.x=0),s.x+s.width>this.canvas.width&&(s.width=this.canvas.width-s.x),s.y<0&&(s.height+=s.y,s.y=0),s.y+s.height>this.canvas.height&&(s.height=this.canvas.height-s.y),this.context.drawImage(this.sketchCanvas,s.x,s.y,s.width,s.height,s.x,s.y,s.width,s.height)):(t=o.scale||1,e=(i=o.translate)instanceof a.Point?i:new a.Point(0,0),s=n=0,i&&(o=this.sketchCanvas.width-this.canvas.width,i=this.sketchCanvas.height-this.canvas.height,n=Math.round(o/2),s=Math.round(i/2)),this.context.drawImage(this.sketchCanvas,e.x-n*t,e.y-s*t,(this.canvas.width+2*n)*t,(this.canvas.height+2*s)*t,-n,-s,this.canvas.width+2*n,this.canvas.height+2*s)),this.context.restore())},drawDebugInfo:function(e,t,i,n){var s,o,r;this.useCanvas&&(r=this.viewer.world.getIndexOfItem(n)%this.debugGridColor.length,(s=this.context).save(),s.lineWidth=2*a.pixelDensityRatio,s.font="small-caps bold "+13*a.pixelDensityRatio+"px arial",s.strokeStyle=this.debugGridColor[r],s.fillStyle=this.debugGridColor[r],0!==this.viewport.degrees&&this._offsetForRotation({degrees:this.viewport.degrees}),n.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:n.getRotation(!0),point:n.viewport.pixelFromPointNoRotate(n._getRotationPoint(!0),!0)}),0===n.viewport.degrees&&n.getRotation(!0)%360==0&&n._drawer.viewer.viewport.getFlip()&&n._drawer._flip(),s.strokeRect(e.position.x*a.pixelDensityRatio,e.position.y*a.pixelDensityRatio,e.size.x*a.pixelDensityRatio,e.size.y*a.pixelDensityRatio),o=(e.position.x+e.size.x/2)*a.pixelDensityRatio,r=(e.position.y+e.size.y/2)*a.pixelDensityRatio,s.translate(o,r),s.rotate(Math.PI/180*-this.viewport.degrees),s.translate(-o,-r),0===e.x&&0===e.y&&(s.fillText("Zoom: "+this.viewport.getZoom(),e.position.x*a.pixelDensityRatio,(e.position.y-30)*a.pixelDensityRatio),s.fillText("Pan: "+this.viewport.getBounds().toString(),e.position.x*a.pixelDensityRatio,(e.position.y-20)*a.pixelDensityRatio)),s.fillText("Level: "+e.level,(e.position.x+10)*a.pixelDensityRatio,(e.position.y+20)*a.pixelDensityRatio),s.fillText("Column: "+e.x,(e.position.x+10)*a.pixelDensityRatio,(e.position.y+30)*a.pixelDensityRatio),s.fillText("Row: "+e.y,(e.position.x+10)*a.pixelDensityRatio,(e.position.y+40)*a.pixelDensityRatio),s.fillText("Order: "+i+" of "+t,(e.position.x+10)*a.pixelDensityRatio,(e.position.y+50)*a.pixelDensityRatio),s.fillText("Size: "+e.size.toString(),(e.position.x+10)*a.pixelDensityRatio,(e.position.y+60)*a.pixelDensityRatio),s.fillText("Position: "+e.position.toString(),(e.position.x+10)*a.pixelDensityRatio,(e.position.y+70)*a.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),n.getRotation(!0)%360!=0&&this._restoreRotationChanges(),0===n.viewport.degrees&&n.getRotation(!0)%360==0&&n._drawer.viewer.viewport.getFlip()&&n._drawer._flip(),s.restore())},debugRect:function(e){var t;this.useCanvas&&((t=this.context).save(),t.lineWidth=2*a.pixelDensityRatio,t.strokeStyle=this.debugGridColor[0],t.fillStyle=this.debugGridColor[0],t.strokeRect(e.x*a.pixelDensityRatio,e.y*a.pixelDensityRatio,e.width*a.pixelDensityRatio,e.height*a.pixelDensityRatio),t.restore())},setImageSmoothingEnabled:function(e){this.useCanvas&&(this._imageSmoothingEnabled=e,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(e){e.msImageSmoothingEnabled=this._imageSmoothingEnabled,e.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(e){return e=this._getContext(e).canvas,new a.Point(e.width,e.height)},getCanvasCenter:function(){return new a.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(e){var t=e.point?e.point.times(a.pixelDensityRatio):this.getCanvasCenter(),i=this._getContext(e.useSketch);i.save(),i.translate(t.x,t.y),this.viewer.viewport.flipped?(i.rotate(Math.PI/180*-e.degrees),i.scale(-1,1)):i.rotate(Math.PI/180*e.degrees),i.translate(-t.x,-t.y)},_flip:function(e){var t=(e=e||{}).point?e.point.times(a.pixelDensityRatio):this.getCanvasCenter();(e=this._getContext(e.useSketch)).translate(t.x,0),e.scale(-1,1),e.translate(-t.x,0)},_restoreRotationChanges:function(e){this._getContext(e).restore()},_calculateCanvasSize:function(){var e=a.pixelDensityRatio,t=this.viewport.getContainerSize();return{x:Math.round(t.x*e),y:Math.round(t.y*e)}},_calculateSketchCanvasSize:function(){var e=this._calculateCanvasSize();return 0===this.viewport.getRotation()?e:{x:e=Math.ceil(Math.sqrt(e.x*e.x+e.y*e.y)),y:e}}}}(OpenSeadragon),function(a){a.Viewport=function(e){var t=arguments;(e=t.length&&t[0]instanceof a.Point?{containerSize:t[0],contentSize:t[1],config:t[2]}:e).config&&(a.extend(!0,e,e.config),delete e.config),this._margins=a.extend({left:0,top:0,right:0,bottom:0},e.margins||{}),delete e.margins,a.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:a.DEFAULT_SETTINGS.springStiffness,animationTime:a.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:a.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:a.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:a.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:a.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:a.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:a.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:a.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:a.DEFAULT_SETTINGS.maxZoomLevel,degrees:a.DEFAULT_SETTINGS.degrees,flipped:a.DEFAULT_SETTINGS.flipped,homeFillsViewer:a.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:a.DEFAULT_SETTINGS.silenceMultiImageWarnings},e),this._updateContainerInnerSize(),this.centerSpringX=new a.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new a.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new a.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new a.Rect(0,0,1,1),1),this.goHome(!0),this.update()},a.Viewport.prototype={resetContentSize:function(e){return a.console.assert(e,"[Viewport.resetContentSize] contentSize is required"),a.console.assert(e instanceof a.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),a.console.assert(0<e.x,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),a.console.assert(0<e.y,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new a.Rect(0,0,1,e.y/e.x),e.x),this},setHomeBounds:function(e,t){a.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(e,t)},_setContentBounds:function(e,t){a.console.assert(e,"[Viewport._setContentBounds] bounds is required"),a.console.assert(e instanceof a.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),a.console.assert(0<e.width,"[Viewport._setContentBounds] bounds.width must be greater than 0"),a.console.assert(0<e.height,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=e.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(t),this._contentBounds=e.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(t),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:t,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){var e;return this.defaultZoomLevel||(e=this._contentAspectRatio/this.getAspectRatio(),(this.homeFillsViewer?1<=e?e:1:1<=e?1:e)/this._contentBounds.width)},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var e=this._contentBounds.getCenter(),t=1/this.getHomeZoom(),i=t/this.getAspectRatio();return new a.Rect(e.x-t/2,e.y-i/2,t,i)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom();return this.minZoomLevel||this.minZoomImageRatio*e},getMaxZoom:function(){var e=this.maxZoomLevel;return e||(e=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,e/=this._contentBounds.width),Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new a.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return a.extend({},this._margins)},setMargins:function(e){a.console.assert("object"===a.type(e),"[Viewport.setMargins] margins must be an object"),this._margins=a.extend({left:0,top:0,right:0,bottom:0},e),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(-this.getRotation())},getBoundsNoRotate:function(e){var t=this.getCenter(e),i=1/this.getZoom(e);return e=i/this.getAspectRatio(),new a.Rect(t.x-i/2,t.y-e/2,i,e)},getBoundsWithMargins:function(e){return this.getBoundsNoRotateWithMargins(e).rotate(-this.getRotation(),this.getCenter(e))},getBoundsNoRotateWithMargins:function(e){var t=this.getBoundsNoRotate(e);return e=this._containerInnerSize.x*this.getZoom(e),t.x-=this._margins.left/e,t.y-=this._margins.top/e,t.width+=(this._margins.left+this._margins.right)/e,t.height+=(this._margins.top+this._margins.bottom)/e,t},getCenter:function(e){var t,i,n,s=new a.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),o=new a.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return e?s:this.zoomPoint?(t=this.pixelFromPoint(this.zoomPoint,!0),e=(i=1/(n=this.getZoom()))/this.getAspectRatio(),e=new a.Rect(s.x-i/2,s.y-e/2,i,e),n=this._pixelFromPoint(this.zoomPoint,e).minus(t).divide(this._containerInnerSize.x*n),o.plus(n)):o},getZoom:function(e){return(e?this.zoomSpring.current:this.zoomSpring.target).value},_applyZoomConstraints:function(e){return Math.max(Math.min(e,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(e){var t,i,n;return e=new a.Rect(e.x,e.y,e.width,e.height),this.wrapHorizontal||(t=this.visibilityRatio*e.width,i=e.x+e.width,n=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,i=this._contentBoundsNoRotate.x-i+t,n=n-e.x-t,t>this._contentBoundsNoRotate.width?e.x+=(i+n)/2:n<0?e.x+=n:0<i&&(e.x+=i)),this.wrapVertical||(t=this.visibilityRatio*e.height,n=e.y+e.height,i=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,n=this._contentBoundsNoRotate.y-n+t,i=i-e.y-t,t>this._contentBoundsNoRotate.height?e.y+=(n+i)/2:i<0?e.y+=i:0<n&&(e.y+=n)),e},_raiseConstraintsEvent:function(e){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e})},applyConstraints:function(e){var t=this.getZoom(),i=this._applyZoomConstraints(t);return t!==i&&this.zoomTo(i,this.zoomPoint,e),t=this.getBoundsNoRotate(),i=this._applyBoundaryConstraints(t),this._raiseConstraintsEvent(e),t.x===i.x&&t.y===i.y&&!e||this.fitBounds(i.rotate(-this.getRotation()),e),this},ensureVisible:function(e){return this.applyConstraints(e)},_fitBounds:function(e,t){var i,n,s=(t=t||{}).immediately||!1,o=t.constraints||!1,r=this.getAspectRatio();return t=e.getCenter(),(e=new a.Rect(e.x,e.y,e.width,e.height,e.degrees+this.getRotation()).getBoundingBox()).getAspectRatio()>=r?e.height=e.width/r:e.width=e.height*r,e.x=t.x-e.width/2,e.y=t.y-e.height/2,r=1/e.width,o&&(i=e.getAspectRatio(),r!==(n=this._applyZoomConstraints(r))&&(e.width=1/(r=n),e.x=t.x-e.width/2,e.height=e.width/i,e.y=t.y-e.height/2),t=(e=this._applyBoundaryConstraints(e)).getCenter(),this._raiseConstraintsEvent(s)),s?(this.panTo(t,!0),this.zoomTo(r,null,!0)):(this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0),n=this.getBounds(),0===(i=this.getZoom())||Math.abs(r/i-1)<1e-8?(this.zoomTo(r,!0),this.panTo(t,s)):(i=(e=e.rotate(-this.getRotation())).getTopLeft().times(r).minus(n.getTopLeft().times(i)).divide(r-i),this.zoomTo(r,i,s)))},fitBounds:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!1})},fitBoundsWithConstraints:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!0})},fitVertically:function(e){var t=new a.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(t,e)},fitHorizontally:function(e){var t=new a.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(t,e)},getConstrainedBounds:function(e){return e=this.getBounds(e),this._applyBoundaryConstraints(e)},panBy:function(e,t){var i=new a.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(i.plus(e),t)},panTo:function(e,t){return t?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:t}),this},zoomBy:function(e,t,i){return this.zoomTo(this.zoomSpring.target.value*e,t,i)},zoomTo:function(e,t,i){var n=this;return this.zoomPoint=t instanceof a.Point&&!isNaN(t.x)&&!isNaN(t.y)?t:null,i?this._adjustCenterSpringsForZoomPoint(function(){n.zoomSpring.resetTo(e)}):this.zoomSpring.springTo(e),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:e,refPoint:t,immediately:i}),this},setRotation:function(e){return this.viewer&&this.viewer.drawer.canRotate()&&(this.degrees=a.positiveModulo(e,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:e})),this},getRotation:function(){return this.degrees},resize:function(e,t){var i,n=this.getBoundsNoRotate(),s=n;return this.containerSize.x=e.x,this.containerSize.y=e.y,this._updateContainerInnerSize(),t&&(i=e.x/this.containerSize.x,s.width=n.width*i,s.height=s.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:e,maintain:t}),this.fitBounds(s,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new a.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var e=this,t=(this._adjustCenterSpringsForZoomPoint(function(){e.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update(),this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom);return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,t},_adjustCenterSpringsForZoomPoint:function(e){var t;this.zoomPoint?(t=this.pixelFromPoint(this.zoomPoint,!0),e(),t=this.pixelFromPoint(this.zoomPoint,!0).minus(t),t=this.deltaPointsFromPixels(t,!0),this.centerSpringX.shiftBy(t.x),this.centerSpringY.shiftBy(t.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)):e()},deltaPixelsFromPointsNoRotate:function(e,t){return e.times(this._containerInnerSize.x*this.getZoom(t))},deltaPixelsFromPoints:function(e,t){return this.deltaPixelsFromPointsNoRotate(e.rotate(this.getRotation()),t)},deltaPointsFromPixelsNoRotate:function(e,t){return e.divide(this._containerInnerSize.x*this.getZoom(t))},deltaPointsFromPixels:function(e,t){return this.deltaPointsFromPixelsNoRotate(e,t).rotate(-this.getRotation())},pixelFromPointNoRotate:function(e,t){return this._pixelFromPointNoRotate(e,this.getBoundsNoRotate(t))},pixelFromPoint:function(e,t){return this._pixelFromPoint(e,this.getBoundsNoRotate(t))},_pixelFromPointNoRotate:function(e,t){return e.minus(t.getTopLeft()).times(this._containerInnerSize.x/t.width).plus(new a.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(e,t){return this._pixelFromPointNoRotate(e.rotate(this.getRotation(),this.getCenter(!0)),t)},pointFromPixelNoRotate:function(e,t){return t=this.getBoundsNoRotate(t),e.minus(new a.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/t.width).plus(t.getTopLeft())},pointFromPixel:function(e,t){return this.pointFromPixelNoRotate(e,t).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(e,t){var i=this._contentBoundsNoRotate.width;return new a.Point(e*this._contentSizeNoRotate.x/i,t*this._contentSizeNoRotate.x/i)},viewportToImageCoordinates:function(e,t){if(e instanceof a.Point)return this.viewportToImageCoordinates(e.x,e.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(1<i)this.silenceMultiImageWarnings||a.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===i)return this.viewer.world.getItemAt(0).viewportToImageCoordinates(e,t,!0)}return this._viewportToImageDelta(e-this._contentBoundsNoRotate.x,t-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(e,t){var i=this._contentBoundsNoRotate.width;return new a.Point(e/this._contentSizeNoRotate.x*i,t/this._contentSizeNoRotate.x*i)},imageToViewportCoordinates:function(e,t){if(e instanceof a.Point)return this.imageToViewportCoordinates(e.x,e.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(1<i)this.silenceMultiImageWarnings||a.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===i)return this.viewer.world.getItemAt(0).imageToViewportCoordinates(e,t,!0)}return(t=this._imageToViewportDelta(e,t)).x+=this._contentBoundsNoRotate.x,t.y+=this._contentBoundsNoRotate.y,t},imageToViewportRectangle:function(e,t,i,n){var s=e;if(s instanceof a.Rect||(s=new a.Rect(e,t,i,n)),this.viewer){var o=this.viewer.world.getItemCount();if(1<o)this.silenceMultiImageWarnings||a.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===o)return this.viewer.world.getItemAt(0).imageToViewportRectangle(e,t,i,n,!0)}return i=this.imageToViewportCoordinates(s.x,s.y),n=this._imageToViewportDelta(s.width,s.height),new a.Rect(i.x,i.y,n.x,n.y,s.degrees)},viewportToImageRectangle:function(e,t,i,n){var s=e;if(s instanceof a.Rect||(s=new a.Rect(e,t,i,n)),this.viewer){var o=this.viewer.world.getItemCount();if(1<o)this.silenceMultiImageWarnings||a.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===o)return this.viewer.world.getItemAt(0).viewportToImageRectangle(e,t,i,n,!0)}return i=this.viewportToImageCoordinates(s.x,s.y),n=this._viewportToImageDelta(s.width,s.height),new a.Rect(i.x,i.y,n.x,n.y,s.degrees)},viewerElementToImageCoordinates:function(e){return e=this.pointFromPixel(e,!0),this.viewportToImageCoordinates(e)},imageToViewerElementCoordinates:function(e){return e=this.imageToViewportCoordinates(e),this.pixelFromPoint(e,!0)},windowToImageCoordinates:function(e){return a.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer."),e=e.minus(a.getElementPosition(this.viewer.element)),this.viewerElementToImageCoordinates(e)},imageToWindowCoordinates:function(e){return a.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer."),this.imageToViewerElementCoordinates(e).plus(a.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},viewerElementToViewportRectangle:function(e){return a.Rect.fromSummits(this.pointFromPixel(e.getTopLeft(),!0),this.pointFromPixel(e.getTopRight(),!0),this.pointFromPixel(e.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(e){return a.Rect.fromSummits(this.pixelFromPoint(e.getTopLeft(),!0),this.pixelFromPoint(e.getTopRight(),!0),this.pixelFromPoint(e.getBottomLeft(),!0))},windowToViewportCoordinates:function(e){return a.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer."),e=e.minus(a.getElementPosition(this.viewer.element)),this.viewerElementToViewportCoordinates(e)},viewportToWindowCoordinates:function(e){return a.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer."),this.viewportToViewerElementCoordinates(e).plus(a.getElementPosition(this.viewer.element))},viewportToImageZoom:function(e){if(this.viewer){var t=this.viewer.world.getItemCount();if(1<t)this.silenceMultiImageWarnings||a.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===t)return this.viewer.world.getItemAt(0).viewportToImageZoom(e)}return t=this._contentSizeNoRotate.x,e*(this._containerInnerSize.x/t*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(e){if(this.viewer){var t=this.viewer.world.getItemCount();if(1<t)this.silenceMultiImageWarnings||a.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===t)return this.viewer.world.getItemAt(0).imageToViewportZoom(e)}return e*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(e){return this.flipped!==e&&(this.flipped=e,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:e})),this}}}(OpenSeadragon),function(y){y.TiledImage=function(e){var t=this,i=(y.console.assert(e.tileCache,"[TiledImage] options.tileCache is required"),y.console.assert(e.drawer,"[TiledImage] options.drawer is required"),y.console.assert(e.viewer,"[TiledImage] options.viewer is required"),y.console.assert(e.imageLoader,"[TiledImage] options.imageLoader is required"),y.console.assert(e.source,"[TiledImage] options.source is required"),y.console.assert(!e.clip||e.clip instanceof y.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),y.EventSource.call(this),this._tileCache=e.tileCache,delete e.tileCache,this._drawer=e.drawer,delete e.drawer,this._imageLoader=e.imageLoader,delete e.imageLoader,e.clip instanceof y.Rect&&(this._clip=e.clip.clone()),delete e.clip,e.x||0),n=(delete e.x,e.y||0),s=(delete e.y,this.normHeight=e.source.dimensions.y/e.source.dimensions.x,this.contentAspectX=e.source.dimensions.x/e.source.dimensions.y,1),o=(e.width?(s=e.width,delete e.width,e.height&&(y.console.error("specifying both width and height to a tiledImage is not supported"),delete e.height)):e.height&&(s=e.height/this.normHeight,delete e.height),e.fitBounds),r=(delete e.fitBounds,e.fitBoundsPlacement||OpenSeadragon.Placement.CENTER),a=(delete e.fitBoundsPlacement,e.degrees||0);delete e.degrees,y.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:y.DEFAULT_SETTINGS.springStiffness,animationTime:y.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:y.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:y.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:y.DEFAULT_SETTINGS.wrapVertical,immediateRender:y.DEFAULT_SETTINGS.immediateRender,blendTime:y.DEFAULT_SETTINGS.blendTime,alwaysBlend:y.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:y.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:y.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:y.DEFAULT_SETTINGS.iOSDevice,debugMode:y.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:y.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:y.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:y.DEFAULT_SETTINGS.placeholderFillStyle,opacity:y.DEFAULT_SETTINGS.opacity,preload:y.DEFAULT_SETTINGS.preload,compositeOperation:y.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:y.DEFAULT_SETTINGS.subPixelRoundingForTransparency},e),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new y.Spring({initial:i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new y.Spring({initial:n,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new y.Spring({initial:s,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new y.Spring({initial:a,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),o&&this.fitBounds(o,r,!0),this._drawingHandler=function(e){t.viewer.raiseEvent("tile-drawing",y.extend({tiledImage:t},e))}},y.extend(y.TiledImage.prototype,y.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(e){e!==this._fullyLoaded&&(this._fullyLoaded=e,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=y.now(),this._needsDraw=!0},update:function(){var e=this._xSpring.update(),t=this._ySpring.update(),i=this._scaleSpring.update(),n=this._degreesSpring.update();return!!(e||t||i||n)&&(this._updateForScale(),this._needsDraw=!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(this.getRotation(e),this._getRotationPoint(e))},getBoundsNoRotate:function(e){return e?new y.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new y.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return y.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(e){var t,i=this.getBoundsNoRotate(e);return this._clip&&(t=(e?this._worldWidthCurrent:this._worldWidthTarget)/this.source.dimensions.x,t=this._clip.times(t),i=new y.Rect(i.x+t.x,i.y+t.y,t.width,t.height)),i.rotate(this.getRotation(e),this._getRotationPoint(e))},getTileBounds:function(e,t,i){var n=this.source.getNumTiles(e),s=(n.x+t%n.x)%n.x,o=(n.y+i%n.y)%n.y;return e=this.source.getTileBounds(e,s,o),this.getFlip()&&(e.x=1-e.x-e.width),e.x+=(t-s)/n.x,e.y+=this._worldHeightCurrent/this._worldWidthCurrent*((i-o)/n.y),e},getContentSize:function(){return new y.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var e=this.imageToWindowCoordinates(new y.Point(0,0)),t=this.imageToWindowCoordinates(this.getContentSize());return new y.Point(t.x-e.x,t.y-e.y)},_viewportToImageDelta:function(e,t,i){return i=(i?this._scaleSpring.current:this._scaleSpring.target).value,new y.Point(e*(this.source.dimensions.x/i),t*(this.source.dimensions.y*this.contentAspectX/i))},viewportToImageCoordinates:function(e,t,i){e=e instanceof y.Point?(i=t,e):new y.Point(e,t);return e=e.rotate(-this.getRotation(i),this._getRotationPoint(i)),i?this._viewportToImageDelta(e.x-this._xSpring.current.value,e.y-this._ySpring.current.value):this._viewportToImageDelta(e.x-this._xSpring.target.value,e.y-this._ySpring.target.value)},_imageToViewportDelta:function(e,t,i){return i=(i?this._scaleSpring.current:this._scaleSpring.target).value,new y.Point(e/this.source.dimensions.x*i,t/this.source.dimensions.y/this.contentAspectX*i)},imageToViewportCoordinates:function(e,t,i){return e instanceof y.Point&&(i=t,t=e.y,e=e.x),t=this._imageToViewportDelta(e,t),i?(t.x+=this._xSpring.current.value,t.y+=this._ySpring.current.value):(t.x+=this._xSpring.target.value,t.y+=this._ySpring.target.value),t.rotate(this.getRotation(i),this._getRotationPoint(i))},imageToViewportRectangle:function(e,t,i,n,s){var o=e;return o instanceof y.Rect?s=t:o=new y.Rect(e,t,i,n),i=this.imageToViewportCoordinates(o.getTopLeft(),s),n=this._imageToViewportDelta(o.width,o.height,s),new y.Rect(i.x,i.y,n.x,n.y,o.degrees+this.getRotation(s))},viewportToImageRectangle:function(e,t,i,n,s){var o=e;return e instanceof y.Rect?s=t:o=new y.Rect(e,t,i,n),i=this.viewportToImageCoordinates(o.getTopLeft(),s),n=this._viewportToImageDelta(o.width,o.height,s),new y.Rect(i.x,i.y,n.x,n.y,o.degrees-this.getRotation(s))},viewerElementToImageCoordinates:function(e){return e=this.viewport.pointFromPixel(e,!0),this.viewportToImageCoordinates(e)},imageToViewerElementCoordinates:function(e){return e=this.imageToViewportCoordinates(e),this.viewport.pixelFromPoint(e,!0)},windowToImageCoordinates:function(e){return e=e.minus(OpenSeadragon.getElementPosition(this.viewer.element)),this.viewerElementToImageCoordinates(e)},imageToWindowCoordinates:function(e){return this.imageToViewerElementCoordinates(e).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(e){var t=this._scaleSpring.current.value;return e=e.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new y.Rect((e.x-this._xSpring.current.value)/t,(e.y-this._ySpring.current.value)/t,e.width/t,e.height/t,e.degrees)},viewportToImageZoom:function(e){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*e},imageToViewportZoom:function(e){return e/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(e,t){var i=this._xSpring.target.value===e.x&&this._ySpring.target.value===e.y;if(t){if(i&&this._xSpring.current.value===e.x&&this._ySpring.current.value===e.y)return;this._xSpring.resetTo(e.x),this._ySpring.resetTo(e.y)}else{if(i)return;this._xSpring.springTo(e.x),this._ySpring.springTo(e.y)}this._needsDraw=!0,i||this._raiseBoundsChange()},setWidth:function(e,t){this._setScale(e,t)},setHeight:function(e,t){this._setScale(e/this.normHeight,t)},setCroppingPolygons:function(e){try{if(!y.isArray(e))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=e.map(function(e){return e.map(function(e){try{if((t=e)instanceof y.Point||"number"==typeof t.x&&"number"==typeof t.y)return{x:e.x,y:e.y};throw new Error}catch(e){throw new Error("A Provided cropping polygon point is not supported")}var t})})}catch(e){y.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),y.console.error(e),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(e,t,i){t=t||y.Placement.CENTER;var n,s=y.Placement.properties[t],o=this.contentAspectX,r=0,a=0,l=1;t=1,this._clip&&(o=this._clip.getAspectRatio(),l=this._clip.width/this.source.dimensions.x,t=this._clip.height/this.source.dimensions.y,a=e.getAspectRatio()>o?(r=this._clip.x/this._clip.height*e.height,this._clip.y/this._clip.height*e.height):(r=this._clip.x/this._clip.width*e.width,this._clip.y/this._clip.width*e.width)),e.getAspectRatio()>o?(n=e.height/t,t=0,s.isHorizontallyCentered?t=(e.width-e.height*o)/2:s.isRight&&(t=e.width-e.height*o),this.setPosition(new y.Point(e.x-r+t,e.y-a),i),this.setHeight(n,i)):(n=e.width/l,l=0,s.isVerticallyCentered?l=(e.height-e.width/o)/2:s.isBottom&&(l=e.height-e.width/o),this.setPosition(new y.Point(e.x-r,e.y-a+l),i),this.setWidth(n,i))},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(e){y.console.assert(!e||e instanceof y.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),e instanceof y.Rect?this._clip=e.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(e){this.flipped=!!e,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(e){e!==this.opacity&&(this.opacity=e,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(e){this._preload=!!e,this._needsDraw=!0},getRotation:function(e){return(e?this._degreesSpring.current:this._degreesSpring.target).value},setRotation:function(e,t){this._degreesSpring.target.value===e&&this._degreesSpring.isAtTargetValue()||(t?this._degreesSpring.resetTo(e):this._degreesSpring.springTo(e),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(e){return this.getBoundsNoRotate(e).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(e){e!==this.compositeOperation&&(this.compositeOperation=e,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(e,t){var i=this._scaleSpring.target.value===e;if(t){if(i&&this._scaleSpring.current.value===e)return;this._scaleSpring.resetTo(e)}else{if(i)return;this._scaleSpring.springTo(e)}this._updateForScale(),this._needsDraw=!0,i||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var e=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),t=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,t=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(t/this.minPixelRatio)/Math.log(2))));return t=Math.max(t,this.source.minLevel||0),{lowestLevel:Math.min(e,t),highestLevel:t}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};0<this.lastDrawn.length;)this.lastDrawn.pop().beingDrawn=!1;var e=this.viewport,t=this._viewportToTiledImageRectangle(e.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var i=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(t=t.intersection(i)))return}for(var n=(i=this._getLevelsInterval()).lowestLevel,s=(i=i.highestLevel,null),o=!1,r=y.now(),a=i;n<=a;a--){var l=!1,h=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(a),!0).x*this._scaleSpring.current.value;if(a===n||!o&&h>=this.minPixelRatio)o=l=!0;else if(!o)continue;var c=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(a),!1).x*this._scaleSpring.current.value,u=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,u=this.immediateRender?1:u,h=Math.min(1,(h-.5)/.5),c=u/Math.abs(u-c),s=this._updateLevel(o,l,a,h,c,t,r,s);if(this._providesCoverage(this.coverage,a))break}this._drawTiles(this.lastDrawn),s&&!s.context2D?(this._loadTile(s,r),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(e,t,i){var n,s=this.wrapHorizontal?(n=y.positiveModulo(t.x,1),y.positiveModulo(i.x,1)):(n=Math.max(0,t.x),Math.min(1,i.x)),o=1/this.source.aspectRatio,r=this.wrapVertical?(a=y.positiveModulo(t.y,o),y.positiveModulo(i.y,o)):(a=Math.max(0,t.y),Math.min(o,i.y)),a=this.source.getTileAtPoint(e,new y.Point(n,a)),r=this.source.getTileAtPoint(e,new y.Point(s,r));return e=this.source.getNumTiles(e),this.wrapHorizontal&&(a.x+=e.x*Math.floor(t.x),r.x+=e.x*Math.floor(i.x)),this.wrapVertical&&(a.y+=e.y*Math.floor(t.y/o),r.y+=e.y*Math.floor(i.y/o)),{topLeft:a,bottomRight:r}},_updateLevel:function(e,t,i,n,s,o,r,a){var l=o.getBoundingBox().getTopLeft(),h=o.getBoundingBox().getBottomRight(),c=(this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:e,level:i,opacity:n,visibility:s,drawArea:o,topleft:l,bottomright:h,currenttime:r,best:a}),this._resetCoverage(this.coverage,i),this._resetCoverage(this.loadingCoverage,i),(h=this._getCornerTiles(i,l,h)).topLeft),u=h.bottomRight,d=this.source.getNumTiles(i),p=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(u.x+=1,this.wrapHorizontal||(u.x=Math.min(u.x,d.x-1)));for(var g,m=c.x;m<=u.x;m++)for(var f=c.y;f<=u.y;f++)g=this.getFlip()?(g=(d.x+m%d.x)%d.x,m+d.x-g-g-1):m,null!==o.intersection(this.getTileBounds(i,g,f))&&(a=this._updateTile(t,e,g,f,i,n,s,p,d,r,a));return a},_updateTile:function(e,t,i,n,s,o,r,a,l,h,c){var u=this._getTile(i,n,s,h,l,this._worldWidthCurrent,this._worldHeightCurrent),l=t;return this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:u}),this._setCoverage(this.coverage,s,i,n,!1),t=u.loaded||u.loading||this._isCovered(this.loadingCoverage,s,i,n),this._setCoverage(this.loadingCoverage,s,i,n,t),u.exists&&(e&&!l&&(this._isCovered(this.coverage,s,i,n)?this._setCoverage(this.coverage,s,i,n,!0):l=!0),l)&&(this._positionTile(u,this.source.tileOverlap,this.viewport,a,r),u.loaded||(u.context2D?this._setTileLoaded(u):(r=this._tileCache.getImageRecord(u.cacheKey))&&(r=r.getImage(),this._setTileLoaded(u,r))),u.loaded?this._blendTile(u,i,n,s,o,h)&&(this._needsDraw=!0):u.loading?this._tilesLoading++:t||(c=this._compareTiles(c,u))),c},_getTile:function(e,t,i,n,s,o,r){var a,l,h,c,u,d,p,g,m,f=this.tilesMatrix,v=this.source;return f[i]||(f[i]={}),f[i][e]||(f[i][e]={}),f[i][e][t]&&!f[i][e][t].flipped==!this.flipped||(a=(s.x+e%s.x)%s.x,l=(s.y+t%s.y)%s.y,h=this.getTileBounds(i,e,t),c=v.getTileBounds(i,a,l,!0),u=v.tileExists(i,a,l),d=v.getTileUrl(i,a,l),m=v.getTilePostData(i,a,l),this.loadTilesWithAjax?(p=v.getTileAjaxHeaders(i,a,l),y.isPlainObject(this.ajaxHeaders)&&(p=y.extend({},this.ajaxHeaders,p))):p=null,g=v.getContext2D?v.getContext2D(i,a,l):void 0,m=new y.Tile(i,e,t,h,u,d,g,this.loadTilesWithAjax,p,c,m,v.getTileHashKey(i,a,l,d,p,m)),this.getFlip()?0==a&&(m.isRightMost=!0):a==s.x-1&&(m.isRightMost=!0),l==s.y-1&&(m.isBottomMost=!0),m.flipped=this.flipped,f[i][e][t]=m),(m=f[i][e][t]).lastTouchTime=n,m},_loadTile:function(n,s){var o=this;n.loading=!0,this._imageLoader.addJob({src:n.url,postData:n.postData,loadWithAjax:n.loadWithAjax,ajaxHeaders:n.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(e,t,i){o._onTileLoad(n,s,e,t,i)},abort:function(){n.loading=!1}})},_onTileLoad:function(t,e,i,n,s){function o(){var e=r.source.getClosestLevel();r._setTileLoaded(t,i,e,s)}var r;i?e<this.lastResetTime?(y.console.warn("Ignoring tile %s loaded before reset: %s",t,t.url),t.loading=!1):(r=this)._midDraw?window.setTimeout(o,1):o():(y.console.error("Tile %s failed to load: %s - error: %s",t,t.url,n),this.viewer.raiseEvent("tile-load-failed",{tile:t,tiledImage:this,time:e,message:n,tileRequest:s}),t.loading=!1,t.exists=!1)},_setTileLoaded:function(e,t,i,n){var s=0,o=this;function r(){return s++,a}function a(){0==--s&&(e.loading=!1,e.loaded=!0,e.context2D||o._tileCache.cacheTile({image:t,tile:e,cutoff:i,tiledImage:o}),o._needsDraw=!0)}this.viewer.raiseEvent("tile-loaded",{tile:e,tiledImage:this,tileRequest:n,image:t,getCompletionCallback:r}),r()()},_positionTile:function(e,t,i,n,s){(a=e.bounds.getTopLeft()).x*=this._scaleSpring.current.value,a.y*=this._scaleSpring.current.value,a.x+=this._xSpring.current.value,a.y+=this._ySpring.current.value;(l=e.bounds.getSize()).x*=this._scaleSpring.current.value,l.y*=this._scaleSpring.current.value;var o=i.pixelFromPointNoRotate(a,!0),r=i.pixelFromPointNoRotate(a,!1),a=i.deltaPixelsFromPointsNoRotate(l,!0),l=i.deltaPixelsFromPointsNoRotate(l,!1),l=r.plus(l.divide(2)),l=n.squaredDistanceTo(l);t||(a=a.plus(new y.Point(1,1))),e.isRightMost&&this.wrapHorizontal&&(a.x+=.75),e.isBottomMost&&this.wrapVertical&&(a.y+=.75),e.position=o,e.size=a,e.squaredDistance=l,e.visibility=s},_blendTile:function(e,t,i,n,s,o){var r,a=1e3*this.blendTime;if(e.blendStart||(e.blendStart=o),r=o-e.blendStart,o=a?Math.min(1,r/a):1,this.alwaysBlend&&(o*=s),e.opacity=o,this.lastDrawn.push(e),1===o)this._setCoverage(this.coverage,n,t,i,!0),this._hasOpaqueTile=!0;else if(r<a)return!0;return!1},_compareTiles:function(e,t){return!e||t.visibility>e.visibility||t.visibility===e.visibility&&t.squaredDistance<e.squaredDistance?t:e},_drawTiles:function(e){if(0!==this.opacity&&(0!==e.length||this.placeholderFillStyle)){var t,i,n,s,o,r=e[0],a=(r&&(t=this.opacity<1||this.compositeOperation&&"source-over"!==this.compositeOperation||!this._isBottomItem()&&r._hasTransparencyChannel()),this.viewport.getZoom(!0)),l=this.viewportToImageZoom(a);if(1<e.length&&l>this.smoothTileEdgesMinZoom&&!this.iOSDevice&&this.getRotation(!0)%360==0&&y.supportsCanvas&&this.viewer.useCanvas&&(t=!0,i=r.getScaleForEdgeSmoothing(),n=r.getTranslationForEdgeSmoothing(i,this._drawer.getCanvasSize(!1),this._drawer.getCanvasSize(!0))),t&&(i||(s=this.viewport.viewportToViewerElementRectangle(this.getClippedBounds(!0)).getIntegerBoundingBox(),!this._drawer.viewer.viewport.getFlip()||0===this.viewport.degrees&&this.getRotation(!0)%360==0||(s.x=this._drawer.viewer.container.clientWidth-(s.x+s.width)),s=s.times(y.pixelDensityRatio)),this._drawer._clear(!0,s)),i||(0!==this.viewport.degrees&&this._drawer._offsetForRotation({degrees:this.viewport.degrees,useSketch:t}),this.getRotation(!0)%360!=0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:t}),0===this.viewport.degrees&&this.getRotation(!0)%360==0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip()),a=!1,this._clip&&(this._drawer.saveContext(t),l=(l=this.imageToViewportRectangle(this._clip,!0)).rotate(-this.getRotation(!0),this._getRotationPoint(!0)),l=this._drawer.viewportToDrawerRectangle(l),i&&(l=l.times(i)),n&&(l=l.translate(n)),this._drawer.setClip(l,t),a=!0),this._croppingPolygons){this._drawer.saveContext(t);try{var h=this._croppingPolygons.map(function(e){return e.map(function(e){return e=this.imageToViewportCoordinates(e.x,e.y,!0).rotate(-this.getRotation(!0),this._getRotationPoint(!0)),e=this._drawer.viewportCoordToDrawerCoord(e),i?e.times(i):e})});this._drawer.clipWithPolygons(h,t)}catch(e){y.console.error(e)}a=!0}this.placeholderFillStyle&&!1===this._hasOpaqueTile&&(h=this._drawer.viewportToDrawerRectangle(this.getBounds(!0)),i&&(h=h.times(i)),n&&(h=h.translate(n)),o=null,o="function"==typeof this.placeholderFillStyle?this.placeholderFillStyle(this,this._drawer.context):this.placeholderFillStyle,this._drawer.drawRectangle(h,o,t));var c=!1;(o="number"==typeof(l=this.subPixelRoundingForTransparency)?g(l):l&&y.Browser?g(h=p(h=l[y.Browser.vendor])?l["*"]:h):d)===y.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS?c=!0:o===y.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&(c=!(this.viewer&&this.viewer.isAnimating()));for(var u=e.length-1;0<=u;u--)r=e[u],this._drawer.drawTile(r,this._drawingHandler,t,i,n,c),r.beingDrawn=!0,this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:this,tile:r});a&&this._drawer.restoreContext(t),i||(this.getRotation(!0)%360!=0&&this._drawer._restoreRotationChanges(t),0!==this.viewport.degrees&&this._drawer._restoreRotationChanges(t)),t&&(i&&(0!==this.viewport.degrees&&this._drawer._offsetForRotation({degrees:this.viewport.degrees,useSketch:!1}),this.getRotation(!0)%360!=0)&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:!1}),this._drawer.blendSketch({opacity:this.opacity,scale:i,translate:n,compositeOperation:this.compositeOperation,bounds:s}),i)&&(this.getRotation(!0)%360!=0&&this._drawer._restoreRotationChanges(!1),0!==this.viewport.degrees)&&this._drawer._restoreRotationChanges(!1),i||0===this.viewport.degrees&&this.getRotation(!0)%360==0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip(),this._drawDebugInfo(e)}},_drawDebugInfo:function(e){if(this.debugMode)for(var t=e.length-1;0<=t;t--){var i=e[t];try{this._drawer.drawDebugInfo(i,e.length,t,this)}catch(e){y.console.error(e)}}},_providesCoverage:function(e,t,i,n){var s,o,r,a;if(!e[t])return!1;if(void 0!==i&&void 0!==n)return void 0===e[t][i]||void 0===e[t][i][n]||!0===e[t][i][n];for(r in s=e[t])if(Object.prototype.hasOwnProperty.call(s,r))for(a in o=s[r])if(Object.prototype.hasOwnProperty.call(o,a)&&!o[a])return!1;return!0},_isCovered:function(e,t,i,n){return void 0===i||void 0===n?this._providesCoverage(e,t+1):this._providesCoverage(e,t+1,2*i,2*n)&&this._providesCoverage(e,t+1,2*i,2*n+1)&&this._providesCoverage(e,t+1,2*i+1,2*n)&&this._providesCoverage(e,t+1,2*i+1,2*n+1)},_setCoverage:function(e,t,i,n,s){e[t]?(e[t][i]||(e[t][i]={}),e[t][i][n]=s):y.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",t)},_resetCoverage:function(e,t){e[t]={}}});var d=y.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function p(e){return e!==y.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&e!==y.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&e!==y.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function g(e){return p(e)?d:e}}(OpenSeadragon),function(g){function m(e){g.console.assert(e,"[TileCache.cacheTile] options is required"),g.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),g.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=e.tile,this.tiledImage=e.tiledImage}function f(e){g.console.assert(e,"[ImageRecord] options is required"),g.console.assert(e.image,"[ImageRecord] options.image is required"),this._image=e.image,this._tiles=[]}f.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){var e;return this._renderedContext||((e=document.createElement("canvas")).width=this._image.width,e.height=this._image.height,this._renderedContext=e.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null),this._renderedContext},setRenderedContext:function(e){g.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=e},addTile:function(e){g.console.assert(e,"[ImageRecord.addTile] tile is required"),this._tiles.push(e)},removeTile:function(e){for(var t=0;t<this._tiles.length;t++)if(this._tiles[t]===e)return void this._tiles.splice(t,1);g.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",e)},getTileCount:function(){return this._tiles.length}},g.TileCache=function(e){this._maxImageCacheCount=(e=e||{}).maxImageCacheCount||g.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},g.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(e){g.console.assert(e,"[TileCache.cacheTile] options is required"),g.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),g.console.assert(e.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),g.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var t=e.cutoff||0,i=this._tilesLoaded.length,n=this._imagesLoaded[e.tile.cacheKey];if(n||(g.console.assert(e.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),n=this._imagesLoaded[e.tile.cacheKey]=new f({image:e.image}),this._imagesLoadedCount++),n.addTile(e.tile),e.tile.cacheImageRecord=n,this._imagesLoadedCount>this._maxImageCacheCount){for(var s,o,r,a,l,h,c=null,u=-1,d=null,p=this._tilesLoaded.length-1;0<=p;p--)(s=(h=this._tilesLoaded[p]).tile).level<=t||s.beingDrawn||(!c||(a=s.lastTouchTime,o=c.lastTouchTime,l=s.level,r=c.level,a<o)||a===o&&r<l)&&(c=s,u=p,d=h);c&&0<=u&&(this._unloadTile(d),i=u)}this._tilesLoaded[i]=new m({tile:e.tile,tiledImage:e.tiledImage})},clearTilesFor:function(e){var t;g.console.assert(e,"[TileCache.clearTilesFor] tiledImage is required");for(var i=0;i<this._tilesLoaded.length;++i)(t=this._tilesLoaded[i]).tiledImage===e&&(this._unloadTile(t),this._tilesLoaded.splice(i,1),i--)},getImageRecord:function(e){return g.console.assert(e,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[e]},_unloadTile:function(e){g.console.assert(e,"[TileCache._unloadTile] tileRecord is required");var t=e.tile,i=e.tiledImage;t.unload(),t.cacheImageRecord=null,(e=this._imagesLoaded[t.cacheKey]).removeTile(t),e.getTileCount()||(e.destroy(),delete this._imagesLoaded[t.cacheKey],this._imagesLoadedCount--),i.viewer.raiseEvent("tile-unloaded",{tile:t,tiledImage:i})}}}(OpenSeadragon),function(g){g.World=function(e){var t=this;g.console.assert(e.viewer,"[World] options.viewer is required"),g.EventSource.call(this),this.viewer=e.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(e){t._autoRefigureSizes?t._figureSizes():t._needsSizesFigured=!0},this._figureSizes()},g.extend(g.World.prototype,g.EventSource.prototype,{addItem:function(e,t){g.console.assert(e,"[World.addItem] item is required"),g.console.assert(e instanceof g.TiledImage,"[World.addItem] only TiledImages supported at this time"),void 0!==(t=t||{}).index?(t=Math.max(0,Math.min(this._items.length,t.index)),this._items.splice(t,0,e)):this._items.push(e),this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,e.addHandler("bounds-change",this._delegatedFigureSizes),e.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:e})},getItemAt:function(e){return g.console.assert(void 0!==e,"[World.getItemAt] index is required"),this._items[e]},getIndexOfItem:function(e){return g.console.assert(e,"[World.getIndexOfItem] item is required"),g.indexOf(this._items,e)},getItemCount:function(){return this._items.length},setItemIndex:function(e,t){g.console.assert(e,"[World.setItemIndex] item is required"),g.console.assert(void 0!==t,"[World.setItemIndex] index is required");var i=this.getIndexOfItem(e);if(t>=this._items.length)throw new Error("Index bigger than number of layers.");t!==i&&-1!==i&&(this._items.splice(i,1),this._items.splice(t,0,e),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:e,previousIndex:i,newIndex:t}))},removeItem:function(e){g.console.assert(e,"[World.removeItem] item is required");var t=g.indexOf(this._items,e);-1!==t&&(e.removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy(),this._items.splice(t,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(e))},removeAll:function(){var e,t;for(this.viewer._cancelPendingImages(),t=0;t<this._items.length;t++)(e=this._items[t]).removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy();var i=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,t=0;t<i.length;t++)e=i[t],this._raiseRemoveItem(e)},resetItems:function(){for(var e=0;e<this._items.length;e++)this._items[e].reset()},update:function(){for(var e=!1,t=0;t<this._items.length;t++)e=this._items[t].update()||e;return e},draw:function(){for(var e=0;e<this._items.length;e++)this._items[e].draw();this._needsDraw=!1},needsDraw:function(){for(var e=0;e<this._items.length;e++)if(this._items[e].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(e){(this._autoRefigureSizes=e)&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(e){var t,i,n,s=(e=e||{}).immediately||!1,o=e.layout||g.DEFAULT_SETTINGS.collectionLayout,r=e.rows||g.DEFAULT_SETTINGS.collectionRows,a=e.columns||g.DEFAULT_SETTINGS.collectionColumns,l=e.tileSize||g.DEFAULT_SETTINGS.collectionTileSize,h=l+(e.tileMargin||g.DEFAULT_SETTINGS.collectionTileMargin),c=!e.rows&&a?a:Math.ceil(this._items.length/r),u=0,d=0;this.setAutoRefigureSizes(!1);for(var p=0;p<this._items.length;p++)p&&p%c==0&&("horizontal"===o?(d+=h,u=0):(u+=h,d=0)),n=(i=(n=(t=this._items[p]).getBounds()).width>n.height?l:l*(n.width/n.height))*(n.height/n.width),n=new g.Point(u+(l-i)/2,d+(l-n)/2),t.setPosition(n,s),t.setWidth(i,s),"horizontal"===o?u+=h:d+=h;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var e=this._homeBounds?this._homeBounds.clone():null,t=this._contentSize?this._contentSize.clone():null,i=this._contentFactor||0;if(this._items.length){for(var n=this._items[0],s=n.getBounds(),o=(this._contentFactor=n.getContentSize().x/s.width,n.getClippedBounds().getBoundingBox()),r=o.x,a=o.y,l=o.x+o.width,h=o.y+o.height,c=1;c<this._items.length;c++)s=(n=this._items[c]).getBounds(),this._contentFactor=Math.max(this._contentFactor,n.getContentSize().x/s.width),o=n.getClippedBounds().getBoundingBox(),r=Math.min(r,o.x),a=Math.min(a,o.y),l=Math.max(l,o.x+o.width),h=Math.max(h,o.y+o.height);this._homeBounds=new g.Rect(r,a,l-r,h-a),this._contentSize=new g.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new g.Rect(0,0,1,1),this._contentSize=new g.Point(1,1),this._contentFactor=1;this._contentFactor===i&&this._homeBounds.equals(e)&&this._contentSize.equals(t)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(e){this.raiseEvent("remove-item",{item:e})}})}(OpenSeadragon),function(e){function i(e){return e?Array.prototype.slice.call(e):[]}e.$=function(e,t){return t||0!==e.indexOf("#")?(t||document).querySelector(e):document.getElementById(e.substr(1,e.length))},e.$$=function(e,t){return i((t||document).querySelectorAll(e))},e.ff={toArray:i}}(this),function(t){var i,n,s,o=t,e=document,r=e.documentElement,h=e.body,a=$("#header"),l=$("#footer"),c=$("#main"),u=$(".page",c),d=!1,p=!1,g=$(".page_content",c),m=!1;function M(){n=o.innerHeight,o.innerWidth,a&&a.offsetHeight,i=d?d.offsetHeight:0,H()}function H(){var e=o.pageYOffset||r.scrollTop;s=e}setTimeout(function(){r.classList.add("is-js-init")},400),M();var f;function B(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var t="a/_,:;",i=0,n=t.length;i<n;i++)e=e.replace(new RegExp(t.charAt(i),"g"),"AAAAAACCCDEEEEEEEEGIIIIINNOOOOOORRSSTUUUUUYYZaaaaaacccdeeeeeeeegiiiiinnooooooorrsstuuuuuyyzbBDdBAa------".charAt(i));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}void 0!==(y=document.createElement("a").style)[_="webkitTransform"]&&(f=_),void 0!==y[_="msTransform"]&&(f=_),void 0!==y[_="transform"]&&(f=_);var F=[];function v(e,t){F.push({selector:e,callback:t})}h.addEventListener("click",function(t){t.ctrlKey||F.forEach(function(e){t.target&&t.target.matches(e.selector+", "+e.selector+" *")&&(t.stopPropagation(),e.callback(t,t.target.closest(e.selector)))})},!1);var y=$(".nav_list",a),N=$$(".nav_i > a",a),j=$$(".nav_i",a);function W(){r.classList.contains("has-subnavOpen")&&(r.classList.remove("has-subnavOpen"),j.forEach(function(e){e.classList.remove("is-open")}),U())}function U(){N.filter(function(e,t){return e.nextElementSibling}).forEach(function(e,t){e.closest(".nav_i").classList.contains("is-open")?(e.setAttribute("aria-expanded","true"),e.nextElementSibling.setAttribute("aria-hidden","false")):(e.setAttribute("aria-expanded","false"),e.nextElementSibling.setAttribute("aria-hidden","true"))})}y.setAttribute("role","menubar"),y.setAttribute("aria-label","Menu principal"),N.forEach(function(e,t){var i;e.setAttribute("role","menuitem"),e.nextElementSibling&&(i=$("ul",e.nextElementSibling),e.setAttribute("aria-haspopup","true"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-controls","menu-item-"+(t+1)),e.nextElementSibling.setAttribute("aria-hidden","true"),e.nextElementSibling.setAttribute("id","menu-item-"+(t+1)),i)&&(i.setAttribute("role","menu"),$$("li",i).forEach(function(e){e.setAttribute("role","none"),$("a",e).setAttribute("role","menuitem")}))}),j.forEach(function(e,t){e.setAttribute("role","none")}),N.length&&v(".nav_i > a",function(e,t){var t=t.closest(".nav_i"),i=$(".nav_sub",t);X("settingsModal"),(i?(e&&e.preventDefault(),t.classList.contains("is-open")?(t.classList.remove("is-open"),r.classList.remove("has-subnavOpen")):(r.classList.contains("has-subnavOpen")&&j.forEach(function(e){e.classList.remove("is-open")}),t.classList.add("is-open"),r.classList.add("has-subnavOpen")),U):W)()}),v(".js-nav-mobile-toggle",function(e,t){r.classList.toggle("has-nav-mobile-open")});var V=1;function G(){var e=this,t=$("#"+e.getAttribute("aria-describedby"));t&&(t.classList.add("is-focus"),t.style.setProperty("--trigger-top",e.getBoundingClientRect().top+s+"px"),t.style.setProperty("--trigger-left",e.getBoundingClientRect().left+"px"),t.style.setProperty("--trigger-w",e.offsetWidth+"px"),t.style.setProperty("--trigger-h",e.offsetHeight+"px"))}function q(){var e=$("#"+this.getAttribute("aria-describedby"));e&&e.classList.remove("is-focus")}function Z(e,t){e&&e.preventDefault(),W(),t.matches('[aria-expanded="true"]')?X(t.getAttribute("aria-controls")):(e=t.getAttribute("aria-controls"),t=$("#"+e),(e=$('.js-panel-toggle[aria-controls="'+e+'"]'))&&t&&(e.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false")))}function X(e){var e=e?$('.js-panel-toggle[aria-controls="'+e+'"][aria-expanded="true"]'):$('.js-panel-toggle[aria-controls][aria-expanded="true"]'),t=!!e&&$("#"+e.getAttribute("aria-controls"));e&&e.setAttribute("aria-expanded","false"),t&&t.setAttribute("aria-hidden","true")}(_=$$(".tooltip")).forEach(function(e){var t;!e.previousElementSibling||e.previousElementSibling.classList.contains(".tooltip")||e.id||(t=e.previousElementSibling?e.previousElementSibling.innerText:"",t=(e.previousElementSibling&&t?B(t):"tooltip")+"-"+V,e.id=t,V++,e.previousElementSibling&&e.previousElementSibling.setAttribute("aria-describedby",t))}),_.forEach(function(e){e.id&&$$('[aria-describedby="'+e.id+'"').forEach(function(e){e.classList.add("tp"),e.setAttribute("tabindex","0"),e.addEventListener("focus",G),e.addEventListener("blur",q),e.addEventListener("mouseenter",G),e.addEventListener("mouseleave",q)})}),v("[data-js-copy]",function(e,t){var i=t.getAttribute("data-js-copy"),n=document.createElement("textarea"),i=(n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.zIndex="-1",n.style.width="2em",n.style.height="2em",n.value=i,document.body.appendChild(n),n.focus(),n.select(),!1),s=t.innerHTML;try{i=document.execCommand("copy")}catch(e){}t.focus(),document.body.removeChild(n),t.innerHTML=i?'<span data-icon="link"></span> Copi !':'<span data-icon="link"></span> Erreur !';setTimeout(function(){t.innerHTML=s},2e3)}),v(".js-panel-toggle[aria-controls]",Z),v(".js-panel-close",function(e,t){Z(e,$('.js-panel-toggle[aria-controls="'+t.closest('[aria-modal="true"], [role="dialog"]').id+'"]'))});var Y=parseInt(o.getComputedStyle(h,null).getPropertyValue("font-size")),w=Y;function K(){r.style.setProperty("--text-font-size",w+"px"),localStorage.setItem("font-size",w+"px"),Q()}function Q(){24<=w?$(".js-settings-size-inc").setAttribute("disabled","disabled"):$(".js-settings-size-inc").removeAttribute("disabled"),w<=12?$(".js-settings-size-dec").setAttribute("disabled","disabled"):$(".js-settings-size-dec").removeAttribute("disabled"),t.dispatchEvent(new Event("resize"))}v(".js-settings-size-dec",function(e){e&&e.preventDefault();--w,K()}),v(".js-settings-size-inc",function(e){e&&e.preventDefault();w+=1,K()}),$$('input[name="color-theme-radios"]',a).forEach(function(e){e.addEventListener("change",function(e){"dark"==this.value?(r.setAttribute("data-theme-color","dark"),localStorage.setItem("theme-color","dark")):(r.removeAttribute("data-theme-color"),localStorage.setItem("theme-color","light"))},!1)}),v(".js-settings-reset",function(e){e&&e.preventDefault();r.style.removeProperty("--text-font-size"),w=Y,localStorage.removeItem("font-size"),Q(),t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)").matches?(r.setAttribute("data-theme-color","dark"),$('input[name="color-theme-radios"][value="dark"]',a).checked=!0):(r.removeAttribute("data-theme-color"),$('input[name="color-theme-radios"][value="light"]',a).checked=!0);localStorage.removeItem("theme-color")}),y=localStorage.getItem("font-size"),(_=localStorage.getItem("theme-color"))&&"auto"!=_||!t.matchMedia||!t.matchMedia("(prefers-color-scheme: dark)").matches||(_="dark"),y&&(w=parseInt(y),console.log(w),K()),_&&("dark"==_?(r.setAttribute("data-theme-color","dark"),$('input[name="color-theme-radios"][value="dark"]',a).checked=!0):(r.removeAttribute("data-theme-color"),$('input[name="color-theme-radios"][value="light"]',a).checked=!0));var J=0;function ee(e){$$(".js-acc",e||c).forEach(function(e){var t,i=e.firstElementChild,n=e.lastElementChild,s="acc-btn-"+J,o="acc-content-"+J;i&&n&&((t=$("a",i))?(t.classList.add("js-acc-trigger"),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-controls",o),t.id=s):(t=i.className,i.className="",i.innerHTML='<button type="button" aria-expanded="false" class="js-acc-trigger '+t+'" aria-controls="'+o+'" id="'+s+'">'+i.innerHTML+"</button>"),n.setAttribute("aria-hidden","true"),n.setAttribute("aria-labelledby",s),n.id=o,n.classList.add("js-acc-content"),J++,e.classList.contains("to-open"))&&te(!1,$(".js-acc-trigger",i))})}function te(e,t){e&&e.preventDefault();e=$("#"+t.getAttribute("aria-controls"));"true"==t.getAttribute("aria-expanded")?(t.setAttribute("aria-expanded","false"),e.setAttribute("aria-hidden","true")):(t.setAttribute("aria-expanded","true"),e.setAttribute("aria-hidden","false"))}ee(),v(".js-acc-trigger[aria-expanded][aria-controls]",te),l.insertAdjacentHTML("beforeend",'<div id="note" aria-hidden="true" class="note f1-14"><button class="note_close" type="button"><span data-icon="clear"></span><span class="srOnly">Fermer la note</span></button><p class="note_content"></p></div>');var x,b=$("#note"),T=!!b&&$(".note_content",b);function ie(){b.classList.remove("is-open")}function ne(){var e;p&&g&&(e=Math.max(0,(-1*g.getBoundingClientRect().top+i)/g.offsetHeight),p.style[f]="scaleX("+e+")")}function se(){d&&d.classList.remove("is-open")}v('a[href^="#note-"][id^="note-anchor-"]',function(e,t){t=$(t.getAttribute("href"));t&&(e.preventDefault(),e=t.closest("p").innerHTML,T.style.visibility="hidden",T.innerHTML=e,$('a[href^="#note-anchor"]',T).remove(),T.style.visibility="",b.classList.add("is-open"))}),v(".note_close",ie),h.addEventListener("click",function(e){e.target.matches('a[href^="#note-"][id^="note-anchor-"]')||e.target.closest(".note")||ie()},!1),y=$(".pHeader_title",c),_=$$(".section-classic > h2, .section-classic > h3",c),P=$$(".page_infos h2",c),x="",y&&(_.length||P.length)&&(x=(x+='<div class="pageNav" id="pageNav" aria-hidden="true"><div class="pageNav_top">')+'<p class="pageNav_title f1-20">'+y.innerHTML+'</p><p class="pageNav_sumTrigger f1-16"><button type="button">Sommaire de larticle <span data-icon="menu"></span></button></p></div><div class="pageNav_bar"></div><div class="pageNav_content">',_.length&&(x+='<ul class="pageNav_titles f1-20">',_.forEach(function(e,t){e.id||(e.id=B(e.innerText)),x+='<li class="pageNav_t pageNav_t-'+e.tagName.toLowerCase()+'"><a href="#'+e.id+'">'+e.innerText+"</a></li>"}),x+="</ul>"),P.length&&(x+='<ul class="pageNav_infos f1-16">',P.forEach(function(e,t){e.id||(e.id=B(e.innerText)),x+='<li><a href="#'+e.id+'">'+e.innerText+"</a></li>"}),x+="</ul>"),x+="</div></div>",l.insertAdjacentHTML("beforeend",x),$("#pageNav"),d=$(".pageNav_top"),p=$(".pageNav_bar"),i=d.offsetHeight,r.style.setProperty("--page-nav-h",i-1+"px")),ne(),v(".pageNav_sumTrigger button",function(e){e.preventDefault(),d.classList.toggle("is-open")}),v(".pageNav_content a",se);var oe=$$(".fiche_section",c),re=$$(".fiche_aside li a",c),E=!1;function ae(){var t;re.length&&oe.length&&(t=!1,oe.forEach(function(e){e.getBoundingClientRect().top<20&&(t=e)}),E!==t)&&(E=t,$(".fiche_aside li.is-active",c)&&$(".fiche_aside li.is-active",c).classList.remove("is-active"),$('.fiche_aside li a[href="#'+E.id+'"]',c))&&$('.fiche_aside li a[href="#'+E.id+'"]',c).parentNode.classList.add("is-active")}ae();var le=[],S=!1;function he(){var s;le.length&&(s=!1,le.forEach(function(e,t){var i=e.closest(".sectionScroll_content"),n=$(".sectionScroll_img",e);i&&n&&e.getBoundingClientRect().top<=n.getBoundingClientRect().top&&(s=e,i.getBoundingClientRect().top+i.clientHeight<n.getBoundingClientRect().top+n.clientHeight)&&(s=!1)}),S!=s)&&(S&&S.classList.remove("is-visible"),s&&s.classList.add("is-visible"),S=s)}function ce(e){var n=e.cells.length&&e.cells[0].element.classList.contains("media"),t=(e.cells.forEach(function(e){e.element.style.height=""}),e.cells.map(function(e){var t=e.element.offsetHeight;if(n){t=0;for(const i of e.element.children)t+=i.offsetHeight}return t})),i=Math.max.apply(Math,t);e.cells.forEach(function(e){e.element.style.height=i+"px"}),e.viewport.style.height=i+"px"}le=$$(".sectionScroll_wrapper",c),he(),(y=$$(".slider_inner",c)).length&&y.forEach(function(e,t){new Flickity(e,{cellAlign:"left",wrapAround:!1,pageDots:!1,groupCells:!0,contain:!0,adaptiveHeight:!1,setGallerySize:!0,resize:!0,prevNextButtons:!0,imagesLoaded:!0,on:{ready:function(){ce(this)},cellChange:function(){ce(this)},resize:function(){ce(this)}}})});var _,P,C,k,R,ue,D,L,de,I=!1,z=!1;function pe(){var e=localStorage.getItem("historique");return(e?JSON.parse(e):[])||[]}$$("figure:first-child .js-viewer-merge",C||c).forEach(function(e){var t=e.closest("figure"),t=!!t&&t.parentNode,t=$$("figure",t),s=[];t.forEach(function(e,t){var i=$("img",e),n=$("figcaption",e);i&&(s.push({src:i.getAttribute("src"),caption:n?n.innerHTML:i.src}),0<t)&&e.remove()}),1<s.length&&(e.setAttribute("data-imgs",JSON.stringify(s)),e.setAttribute("data-imgs-nb",s.length))}),(k=$$(".js-viewer",k||c)).forEach(function(e){e.hasAttribute("data-imgs-nb")?e.insertAdjacentHTML("afterend",'<button class="viewer_trigger" type="button"><span>'+e.getAttribute("data-imgs-nb")+' images</span> <span data-icon="image"></span></button>'):e.insertAdjacentHTML("afterend",'<button class="viewer_trigger" type="button"><span data-icon="zoom_in"></span><span class="srOnly">Voir dans la visionneuse</span></button>')}),k.length&&((I=e.createElement("div")).setAttribute("aria-hidden","true"),I.classList.add("viewer"),I.innerHTML='<button type="button" class="viewer_close"><span data-icon="clear"></span><span class="srOnly">Fermer la visionneuse</span></button><div class="viewer_panel" data-panel-name="infos"><button type="button" class="viewer_panelClose"><span data-icon="clear"></span><span class="srOnly">Fermer les infos</span></button><div class="viewer_panelInner txt txt-small"></div></div><div class="viewer_panel" data-panel-name="siblings"><div class="viewer_panelInner"></div></div><div class="viewer_nav viewer_nav-right"><button type="button" class="viewer_btn viewer_btn-infos"><span data-icon="info"></span><span class="srOnly">Voir les infos</span></button><button type="button" class="viewer_btn viewer_btn-zoom_in" id="viewer-zoom-in"><span data-icon="zoom_in"></span><span class="srOnly">Zommer</span></button><button type="button" class="viewer_btn viewer_btn-zoom_out" id="viewer-zoom-out"><span data-icon="zoom_out"></span><span class="srOnly">Dzoomer</span></button><button type="button" class="viewer_btn viewer_btn-rotate" id="viewer-rotate-left"><span data-icon="rotate_left"></span><span class="srOnly">Rotation</span></button><a href="#" class="viewer_btn viewer_btn-dl" target="_blank"><span data-icon="vertical_align_bottom"></span><span class="srOnly">Tlcharger</span></a></div><div class="viewer_nav viewer_nav-left viewer_nav-siblings"><button type="button" class="viewer_btn viewer_btn-previous" id="viewer-previous"><span data-icon="arrow_back"></span><span class="srOnly">Image prcdente</span></button><button type="button" class="viewer_btn viewer_btn-siblings" id="viewer-siblings"><span data-opened="Fermer le panneau" data-closed="Toutes les images"></span><span class="srOnly">Voir toutes les images</span></button><button type="button" class="viewer_btn viewer_btn-next" id="viewer-next"><span data-icon="arrow_forward"></span><span class="srOnly">Image suivante</span></button></div><div class="viewer_navigator" id="viewer-navigator"></div>',h.append(I),(z=OpenSeadragon({element:I,viewportMargins:{left:40,top:40,right:40,bottom:40},showHomeControl:!1,showFullPageControl:!1,zoomInButton:"viewer-zoom-in",zoomOutButton:"viewer-zoom-out",nextButton:"viewer-next",previousButton:"viewer-previous",rotateLeftButton:"viewer-rotate-left",showRotationControl:!0,gestureSettingsTouch:{pinchRotate:!0},showNavigator:!0,navigatorId:"viewer-navigator",navigatorOpacity:1,navigatorBorderColor:"#000",navigatorDisplayRegionColor:"#979797",sequenceMode:!0})).addHandler("open",function(e){var i="";e.eventSource&&e.eventSource.tileSources&&1<e.eventSource.tileSources.length?(I.classList.add("is-multi"),i+='<ul class="viewer_siblings f1-12">',e.eventSource.tileSources.forEach(function(e,t){i=(i=(i=i+'<li><button type="button" data-viewer-go-to="'+t+'">')+'<img src="'+e.url+'">')+"<span>"+e.caption+"</span></button></li>"}),i+="</ul>",$('.viewer_panel[data-panel-name="siblings"] .viewer_panelInner',I).innerHTML=i):I.classList.remove("is-multi"),e.source&&e.source.url&&($(".viewer_btn-dl",I).href=e.source.url),e.source&&e.source.caption&&($('.viewer_panel[data-panel-name="infos"] .viewer_panelInner',I).innerHTML="<p>"+e.source.caption+"</p>"),I.classList.add("is-open")}),z.addHandler("close",function(e){I.classList.remove("is-open"),I.classList.remove("has-panel-infos-open"),I.classList.remove("has-panel-siblings-open"),$$(".viewer_panelInner",I).forEach(function(e){e.innerHTML=""}),$(".viewer_btn-dl",I).setAttribute("href","#")})),v(".viewer_trigger",function(e,t){e&&e.preventDefault();var i,n;I&&(e=t.previousElementSibling)&&e.matches("img[src]")&&(t=e,I)&&z&&(i=[],e=t.getAttribute("src"),(n=!!t.hasAttribute("data-imgs")&&JSON.parse(t.getAttribute("data-imgs")))&&n.length?n.forEach(function(e){i.push({type:"image",url:e.src,caption:e.caption,buildPyramid:!1})}):(n={type:"image",url:e,buildPyramid:!1},e=!!(e=t.closest("figure"))&&$("figcaption",e),n.caption=e?e.innerHTML:t.src,i.push(n)),z.open(i))}),v(".viewer_close",function(e){I&&z&&(e&&e.preventDefault(),z.close())}),v(".viewer_btn-infos",function(e){e&&e.preventDefault();I.classList.toggle("has-panel-infos-open")}),v('.viewer_panel[data-panel-name="infos"] .viewer_panelClose',function(e){e&&e.preventDefault();I.classList.remove("has-panel-infos-open")}),v(".viewer_btn-siblings",function(e){e&&e.preventDefault();I.classList.toggle("has-panel-siblings-open")}),v('.viewer_panel[data-panel-name="siblings"] .viewer_panelClose',function(e){e&&e.preventDefault();I.classList.remove("has-panel-siblings-open")}),v("button[data-viewer-go-to]",function(e,t){e&&e.preventDefault();e=parseInt(t.getAttribute("data-viewer-go-to"));I&&z&&z.goToPage(e)}),_=$("h1"),_=c.classList.contains("main-home")?"Accueil":_?_.innerText:document.title,P=t.location.href.replace(location.hash,""),l=(l=(l=$(".pHeader_sup"))||$(".fiche_type"))?l.innerText:_,y=new Date,_={title:_,url:P,cat:l,date:y.getFullYear()+"-"+(y.getMonth()+1)+"-"+y.getDate()+" "+(y.getHours()<10?"0"+y.getHours():y.getHours())+":"+(y.getMinutes()<10?"0"+y.getMinutes():y.getMinutes())},(P=pe()).push(_),P=P.slice(-40),localStorage.setItem("historique",JSON.stringify(P)),C=pe(),k=$(".historique",c),R="",k&&u&&C.length&&(C.reverse(),C.forEach(function(e){R=(R=(R=(R+='<li class="historique_i">')+'<p class="historique_cat">'+e.cat+"</p>")+'<p class="historique_title"><a href="'+e.url+'">'+e.title+"</a></p>")+'<p class="historique_date">'+e.date+"</p></li>"}),k.innerHTML=R),(ue=$$(".datas",ue||c)).length&&ue.forEach(function(e){var t,i,n,s,o,r,a,l;a=e,r=$$("tbody tr",a),a=$$(".cartel",a),r.forEach(function(e,t){e.setAttribute("data-datas-idx",t)}),a.forEach(function(e,t){e.setAttribute("data-datas-idx",t)}),e.classList.contains("has-expand")&&(r=e,a=$$("thead tr",r),r=$$("tbody tr",r),a.forEach(function(e){$(".is-expand",e)||e.insertAdjacentHTML("afterbegin",'<th scope="col" class="is-expand"><span class="srOnly">Dvelopper</span></th>')}),r.forEach(function(e){$(".js-datas-expand",e)||e.insertAdjacentHTML("afterbegin",'<td><button type="button" class="js-datas-expand"><span data-icon="expand_more"></span></button></td>')})),e.classList.contains("has-bulk")&&(a=e,r=$$("thead tr",a),a=$$("tbody tr",a),r.forEach(function(e){$(".is-bulk",e)||e.insertAdjacentHTML("afterbegin",'<th scope="col" class="is-bulk"><span class="srOnly">Slectionner</span></th>')}),a.forEach(function(e){$(".js-datas-select",e)||e.insertAdjacentHTML("afterbegin",'<td><div class="form_check form_check-solo"><label><input class="js-datas-select" type="checkbox"> <span><span class="srOnly">Slectionner</span></span></label></div></td>')})),e.classList.contains("has-drag")&&(r=e,$(".datas_handle",r)||$$(".datas_th",r).forEach(function(e){var t=document.createElement("span");t.setAttribute("data-icon","drag_indicator"),t.classList.add("datas_handle"),e.prepend(t),t.addEventListener("mousedown",me)})),e.classList.contains("has-order")&&(a=e,$(".datas_order",a)||$$(".datas_th",a).forEach(function(e,t){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-icon","arrow_downward"),i.classList.add("datas_order"),e.append(i),i.addEventListener("click",ye)})),e.classList.contains("has-pagination")&&we(e),e.classList.contains("has-filters")&&(r=e,!$(".datas_filtersTrigger",r))&&(a=$(".datas_header",r),i=$(".datas_actions",r),t=$(".datas_link",r),o=Math.random().toString(16).slice(2),n='<button class="datas_filtersTrigger js-panel-toggle btn btn-g" type="button" aria-haspopup="dialog" aria-controls="datas-filters-'+o+'" aria-expanded="false">Filtrer <span data-icon="tune"></span><span class="srOnly">Filtres de la base de donnes</span></button>',s=(s=(s=(s=(s='<div class="data_filters panel filters" id="datas-filters-'+o+'" role="dialog" aria-modal="true" aria-labelledby="datas-filters-'+o+'-title" aria-hidden="true">')+'<div class="panel_inner"><h2 id="datas-filters-'+o+'-title" class="panel_title f1-24">Filtres</h2>')+'<div class="panel_txt panel_txt-filters filters_content"></div>')+'<p class="panel_close"><button class="js-panel-close" type="button"><span data-icon="clear"></span><span class="srOnly">Fermer les filtres</span></button></p></div>')+'<div class="panel_overlay js-panel-close"></div></div>',i||(n='<div class="datas_actions"><div class="datas_actionsRow">'+n+"</div></div>"),a||(n='<div class="datas_header">'+n+"</div>"),t?t.insertAdjacentHTML("afterend",n):i?$(".datas_actionsRow:first-child",i).insertAdjacentHTML("afterbegin",n):a?a.insertAdjacentHTML("beforeend",n):r.insertAdjacentHTML("afterbegin",n),h.insertAdjacentHTML("beforeend",s),o=r,o=!!(o=!!(o=$(".datas_filtersTrigger[aria-controls]",o))&&$("#"+o.getAttribute("aria-controls")))&&$(".filters_content",o))&&($$(".searchCheckboxes_s input",o).forEach(function(e){e.removeEventListener("input",Ee)}),$$(".formSlider",o||h).forEach(function(e,t){var i=$('input[type="range"]:first-child',e),n=$('input[type="range"]:last-child',e);$(".formSlider_value:first-child",e),$(".formSlider_value:last-child",e),i.removeEventListener("input",ke),n.removeEventListener("input",Re)}),o.innerHTML='<div class="filters_i filter js-acc"><h3 class="filter_title f1-30">Annes</h3><div class="filter_content"><div class="formSlider"><div class="formSlider_control"><input type="range" value="1710" min="1710" max="1810" step="10"/><input type="range" value="1810" min="1710" max="1810" step="10"/></div><div class="formSlider_values"><span class="formSlider_value">1710</span><span class="formSlider_value">1810</span></div></div><ul class="filter_list form_list form_list-cols"><li class="form_check filter_check"><label><input type="checkbox" value="1710-1720" data-filter-name="annee"> <span>1710 - 1720 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1720-1730" data-filter-name="annee"> <span>1720 - 1730 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1730-1740" data-filter-name="annee"> <span>1730 - 1740 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1740-1750" data-filter-name="annee"> <span>1740 - 1750 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1750-1760" data-filter-name="annee"> <span>1750 - 1760 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1760-1770" data-filter-name="annee"> <span>1760 - 1770 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1770-1780" data-filter-name="annee"> <span>1770 - 1780 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1780-1790" data-filter-name="annee"> <span>1780 - 1790 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1790-1800" data-filter-name="annee"> <span>1790 - 1800 <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="1800-1810" data-filter-name="annee"> <span>1800 - 1810 <span class="filter_nb">(5)</span></span></label></li></ul></div></div><div class="filters_i filter js-acc"><h3 class="filter_title f1-30">Villes</h3><div class="filter_content"><div class="filter_searchCont searchCheckboxes"><p class="searchCheckboxes_s"><input type="text"></p><ul class="filter_list form_list searchCheckboxes_list"><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Argels <span class="filter_nb">(1)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Bastia <span class="filter_nb">(3)</span></span></label><ul><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Caen <span class="filter_nb">(12)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Dole <span class="filter_nb">(5)</span></span></label></li></ul></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Paris <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Salis <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Talence <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Valence <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Salis <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Talence <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Valence <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Argels <span class="filter_nb">(1)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Bastia <span class="filter_nb">(3)</span></span></label><ul><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Caen <span class="filter_nb">(12)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Dole <span class="filter_nb">(5)</span></span></label></li></ul></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Paris <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Salis <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Talence <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Valence <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Salis <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Talence <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="ville"> <span>Valence <span class="filter_nb">(5)</span></span></label></li></ul></div></div></div><div class="filters_i filter js-acc"><h3 class="filter_title f1-30">Types daffaire</h3><div class="filter_content"><ul class="filter_list form_list form_list-m"><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="affaire"> <span>Estimer la valeur des biens <span class="filter_desc">ex : Partage et succession, valuation en vue dune vente de biens meubles ou immeubles, etc.</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="affaire"> <span>Recevoir et valuer le travail ralis <span class="filter_desc">ex : Rception douvrages, estimation dhonoraires, dfaut de paiement etc.</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="affaire"> <span>Enregistrer <span class="filter_desc">ex : Projet de construction (arrt du Parlement du 18 aot 1766), alignement non conflictuel et non estimatif, tat des lieux [ complter si on trouve dautres cas].</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="affaire"> <span>Dpartager <span class="filter_desc">ex : Conflit de voisinage et conflit entre locataire et propritaire, rpartition des frais dentretien ou de construction dun mur mitoyen, conflits de fosses daisance, prise en charge des rparations locatives etc.</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="affaire"> <span>Dcrire et valuer les travaux  venir <span class="filter_desc">ex : Rparations  faire</span></span></label></li></ul></div></div><div class="filters_i filter js-acc"><h3 class="filter_title f1-30">Cause de lexpertise</h3><div class="filter_content"><ul class="filter_list form_list form_list-cols"><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Entretien <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Fin de location <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Nouvelle construction <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Cartage <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Mesure de protection <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Privilge <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Rception de travaux <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Reconstruction de mur mitoyen <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Prt <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="cause"> <span>Vente dun bien <span class="filter_nb">(5)</span></span></label></li></ul></div></div><div class="filters_i filter js-acc"><h3 class="filter_title f1-30">Objet de lexpertise</h3><div class="filter_content"><ul class="filter_list form_list"><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="objet"> <span>Terrain(s) <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="objet"> <span>Ensemble de btiments (biens immeubles) <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="objet"> <span>Domaine, terres, fief <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="objet"> <span>Mur(s) <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="objet"> <span>Fosse(s) daisance <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="objet"> <span>Puits <span class="filter_nb">(5)</span></span></label></li><li class="form_check filter_check"><label><input type="checkbox" value="xxxx" data-filter-name="objet"> <span>Autres <span class="filter_nb">(5)</span></span></label></li></ul></div></div>',$$(".searchCheckboxes_s input",o).forEach(function(e){e.addEventListener("input",Ee)}),ee(o),_e(o)),e.classList.contains("has-settings")&&(t=e,$(".datas_settingsTrigger",t)||(i=$(".datas_header",t),a=$(".datas_actions",t),n=$(".datas_link",t),s=t.classList.contains("has-filters"),r=Math.random().toString(16).slice(2),o='<button class="datas_settingsTrigger js-panel-toggle btn btn-g btn-icon" type="button" aria-haspopup="dialog" aria-controls="datas-settings-'+r+'" aria-expanded="false"><span data-icon="settings"></span><span class="srOnly">Rglages du tableau</span></button>',l='<div class="panel datas_settings" id="datas-settings-'+r+'" role="dialog" aria-modal="true" aria-labelledby="datas-settings-'+r+'-title" aria-hidden="true">',l=(l=(l=(l=(l=(l+='<div class="panel_inner">')+'<h2 id="datas-settings-'+r+'-title" class="panel_title f1-24"><span data-icon="settings"></span> Rglages daffichage</h2><div class="panel_txt panel_txt-settings">')+'<h3 class="f1-40">Colonnes</h3><ul class="form_list">')+"</ul></div>")+'<p class="panel_close"><button class="js-panel-close" type="button"><span data-icon="clear"></span><span class="srOnly">Fermer les rglages</span></button></p></div>')+'<div class="panel_overlay js-panel-close"></div></div>',a?s&&(o='<div class="datas_actionsRow">'+o+"</div>"):o='<div class="datas_actions"><div class="datas_actionsRow">'+o+"</div></div>",i||(o='<div class="datas_header">'+o+"</div>"),i&&a&&s?a.insertAdjacentHTML("beforeend",o):n?n.insertAdjacentHTML("afterend",o):a?$(".datas_actionsRow:first-child",a).insertAdjacentHTML("afterbegin",o):i?i.insertAdjacentHTML("beforeend",o):t.insertAdjacentHTML("afterbegin",o),h.insertAdjacentHTML("beforeend",l),Te(t))),e.classList.contains("has-search")&&(r=e,$(".datas_search",r)||(a=$(".datas_header",r),l=$(".datas_actions",r),e='<div class="datas_search"><button class="btn btn-g btn-icon" type="button"><span data-icon="search"></span><span class="srOnly">Ouvrir / fermer la recherche</span></button><input type="text" value=""></div>',l||(e='<div class="datas_actions"><div class="datas_actionsRow">'+e+"</div></div>"),a||(e='<div class="datas_header">'+e+"</div>"),l?$(".datas_actionsRow:first-child",l).insertAdjacentHTML("beforeend",e):a?a.insertAdjacentHTML("beforeend",e):r.insertAdjacentHTML("afterbegin",e),$(".datas_search input",r).addEventListener("input",Se),be(r)))}),v(".js-base-view-table",function(e,t){t.closest(".base_datas").classList.remove("is-cartels")}),v(".js-base-view-cartels",function(e,t){t.closest(".base_datas").classList.add("is-cartels")}),v(".js-datas-select",function(e,t){var i=t.closest(".datas"),n=t.closest("[data-datas-idx]");n&&(n=n.getAttribute("data-datas-idx"),$$('[data-datas-idx="'+n+'"]',i).forEach(function(e){e=$(".js-datas-select",e);e&&(e.checked=t.checked)}))}),v(".js-datas-expand",function(e,t){e&&e.preventDefault();t.closest("tr").classList.toggle("is-expanded")});var ge=!1;function me(e){(L=e.target.closest("th"))&&(D=L.closest(".datas"),e=$$("th",D),de=e.indexOf(L),document.addEventListener("mousemove",fe),document.addEventListener("mouseup",ve))}function fe(e){var t,i;L&&D&&(ge||(ge=!0,L.classList.add("is-dragging")),t=e.target.closest(".datas"),e=(e=(e=e.target.closest("th"))&&e.classList.contains("is-bulk")?e.nextElementSibling:e)&&e.classList.contains("is-expand")?e.nextElementSibling:e)&&D&&t&&t===D&&(i=(t=$$("th",t)).indexOf(e),t.forEach(function(e){e.classList.remove("is-drop-before"),e.classList.remove("is-drop-after")}),i<de?e.classList.add("is-drop-before"):e.classList.add("is-drop-after"))}function ve(e){var t,i,n=e.target.closest(".datas"),e=e.target.closest("th"),e=((e=(e=e&&e.classList.contains("is-bulk")?e.nextElementSibling:e)&&e.classList.contains("is-expand")?e.nextElementSibling:e)&&n?$$("th",n):[]).indexOf(e);n=n,t=de,(i=e)<0||t==i||!D||n!==D||($$("tr",n).forEach(function(e){e=$$("th,td",e);i<t?e[i].parentNode.insertBefore(e[t],e[i]):e[i].parentNode.insertBefore(e[t],e[i].nextSibling)}),Te(n)),L&&D&&(e=$$("th",D),L.classList.remove("is-dragging"),e.forEach(function(e){e.classList.remove("is-drop-before"),e.classList.remove("is-drop-after")}),L=D=ge=!1)}function ye(e){var t=this.closest("th"),i=t.closest(".datas_table"),n=i.closest(".datas"),s=$("tbody",i),i=$$("th",i),o=i.indexOf(t),t=i[o],r=$$("tbody tr",s),a=$(".datas_cartels",n),l=$$(".cartel",n),h=t.hasAttribute("data-desc");h?t.removeAttribute("data-desc"):t.setAttribute("data-desc","1"),h=!h,i.forEach(function(e,t){t!==o&&e.removeAttribute("data-desc")}),r.sort(function(e,t){e=$("td:nth-child("+(o+1)+")",e),t=$("td:nth-child("+(o+1)+")",t);return t.textContent.localeCompare(e.textContent)}),l.sort(function(e,t){return(e.hasAttribute("data-datas-idx")?parseInt(e.getAttribute("data-datas-idx")):99999999999)-(t.hasAttribute("data-datas-idx")?parseInt(t.getAttribute("data-datas-idx")):99999999999)}),h||r.reverse(),r.forEach(function(e,t){s.insertBefore(e,s.firstChild),a&&l.length&&e.hasAttribute("data-datas-idx")&&l[parseInt(e.getAttribute("data-datas-idx"))]&&a.insertBefore(l[parseInt(e.getAttribute("data-datas-idx"))],a.firstChild)}),O(n)}function we(e){var t=$("tbody",e),t=$$("tr:not(.is-search-hide):not(.is-filter-hide)",t),i=$$(".datas_footer",e);if(i.length&&(i.forEach(function(e){e.remove()}),O(e)),!(t.length<=10)){for(var n,s,o,r,i="",a=(e.insertAdjacentHTML("beforeend",i=(i=(i=(i+='<div class="datas_footer">')+'<label class="datas_nb"><span>Items par page</span><select></select></label>'+'<div class="datas_infos"><span data-datas-min>1</span><span data-datas-max></span> de <span data-datas-total></span> items</div>')+'<label class="datas_pages"><select><option value="1">1</option></select><span>sur <span data-datas-pages-max></span> pages</span></label>'+'<button class="datas_nav datas_nav-prev" type="button"><span class="srOnly">page prcdente</span><span data-icon="arrow_left"></span></button>')+'<button class="datas_nav datas_nav-next" type="button"><span class="srOnly">page prcdente</span><span data-icon="arrow_right"></span></button>'+"</div>"),e.classList.contains("has-pagination-top")&&e.insertAdjacentHTML("afterbegin",i),n=e,s=$$(".datas_nb select",n),o=$$(".datas_pages select",n),i=$$(".datas_nav-prev",n),a=$$(".datas_nav-next",n),s.forEach(function(e){e.addEventListener("change",function(e){var t=this;s.forEach(function(e){e!==t&&(e.value=t.value)}),xe(n)})}),o.forEach(function(e){e.addEventListener("change",function(e){var t=this;o.forEach(function(e){e!==t&&(e.value=t.value)}),O(n)})}),a.forEach(function(e){e.addEventListener("click",function(e){var t=o.length?parseInt(o[0].value):1;$('.datas_pages select option[value="'+(t+1)+'"]')&&(o.forEach(function(e){e.value=t+1}),O(n))})}),i.forEach(function(e){e.addEventListener("click",function(e){var t=o.length?parseInt(o[0].value):1;$('.datas_pages select option[value="'+(t-1)+'"]')&&(o.forEach(function(e){e.value=t-1}),O(n))})}),e),i=t,l=$("tbody",a),h=(i=i||$$("tr:not(.is-search-hide):not(.is-filter-hide)",l)).length,l=$$(".datas_nb select",a),c="",u=10;u<=h&&u<=100;u+=10)c+='<option value="'+u+'">'+u+"</option>";l.forEach(function(e){e.innerHTML=c}),xe(a,i),l=e,a=t,i=$("tbody",l),r=(a=a||$$("tr:not(.is-search-hide):not(.is-filter-hide)",i)).length,$$("[data-datas-total]",l).forEach(function(e){e.innerHTML=r})}}function xe(e,t){for(var i=e,n=t,s=$("tbody",i),n=n||$$("tr:not(.is-search-hide):not(.is-filter-hide)",s),s=$$(".datas_nb select",i),n=n.length,s=s.length?parseInt(s[0].value):10,o=Math.ceil(n/s),n=$$(".datas_pages select",i),s=$$("[data-datas-pages-max]",i),r="",a=1;a<=o;a++)r+='<option value="'+a+'">'+a+"</option>";n.forEach(function(e){e.innerHTML=r}),s.forEach(function(e){e.innerHTML=o}),O(e,t)}function O(e,t){var i,n,s,o,r,a,l,h,c;o=e,r=t,s=$("tbody",o),r=r||$$("tr:not(.is-search-hide):not(.is-filter-hide)",s),s=$$(".datas_nb select",o),r=r.length,s=s.length?parseInt(s[0].value):10,a=(a=$$(".datas_pages select",o)).length?parseInt(a[0].value):1,i=Math.min(r,a*s),n=(a-1)*s+1,r=$$("[data-datas-min]",o),a=$$("[data-datas-max]",o),r.forEach(function(e){e.innerHTML=n}),a.forEach(function(e){e.innerHTML=i}),s=e,o=(o=t)||$$("tbody tr:not(.is-search-hide):not(.is-filter-hide)",s),r=$$(".cartel:not(.is-search-hide):not(.is-filter-hide)",s),a=$$(".datas_nb select",s),l=o.length,a=a.length?parseInt(a[0].value):10,s=(s=$$(".datas_pages select",s)).length?parseInt(s[0].value):1,h=Math.min(l,s*a),c=(s-1)*a+1,o.forEach(function(e,t){t<c-1||h-1<t?e.classList.add("is-hide"):e.classList.remove("is-hide")}),r.forEach(function(e,t){t<c-1||h-1<t?e.classList.add("is-hide"):e.classList.remove("is-hide")}),$(".datas_table",e).classList.contains("js-stripped")&&be(e,t)}function be(e,t){e=$(".datas_table",e);(t=t||$$("tr:not(.is-hide):not(.is-search-hide):not(.is-filter-hide)",e)).forEach(function(e,t){e.classList.remove("is-odd"),t%2==1&&e.classList.add("is-odd")}),e.classList.add("js-stripped")}function Te(e){var t,i,n=$(".datas_settingsTrigger[aria-controls]",e);n&&(n=n.getAttribute("aria-controls"),t=!!(n=$("#"+n))&&$(".form_list",n),n)&&t&&(n=$$("thead th",e),i="",n.length&&n.forEach(function(e,t){e=$(".datas_th",e);e&&(i+='<li class="form_check"><label><input type="checkbox" value="'+(t+1)+'" checked> <span>'+e.textContent+"</span></label></li>")}),t.innerHTML=i)}function Ee(e){var t=this.closest(".searchCheckboxes"),i=!!(this.value&&2<this.value.length)&&this.value;$$("li",t).forEach(function(e,t){i&&-1===e.textContent.toLowerCase().indexOf(i.toLowerCase())?e.classList.add("is-hide"):e.classList.remove("is-hide")})}function Se(e,t){var i,e=e?this:t,t=e.closest(".datas"),n=!(!(n=t.hasAttribute("data-active-search")?t.hasAttribute("data-active-search"):"")||""===n)&&n,s=!!(e.value&&2<e.value.length)&&e.value;s!==n&&(e=$$("tbody tr",t),i=$$(".cartel",t),e.forEach(function(e,t){s&&-1===e.textContent.toLowerCase().indexOf(s.toLowerCase())?(e.classList.add("is-search-hide"),i.length&&i[t]&&i[t].classList.add("is-search-hide")):(e.classList.remove("is-search-hide"),i.length&&i[t]&&i[t].classList.remove("is-search-hide"))}),t.setAttribute("data-active-search",s||""),we(t))}function _e(e){$$(".formSlider",e||h).forEach(function(e,t){var i;e=e,i=$('input[type="range"]:first-child',e),e=$('input[type="range"]:last-child',e),Pe(i,e),Ce(e),i.addEventListener("input",ke),e.addEventListener("input",Re)})}function Pe(e,t){var i=t.max-t.min,e=e.value-t.min,n=t.value-t.min;t.style.background="linear-gradient( to right, rgb(var(--color-grey-8)) 0%, rgb(var(--color-grey-8)) "+e/i*100+"%, rgb(var(--color-c)) "+e/i*100+"%, rgb(var(--color-c)) "+n/i*100+"%,  rgb(var(--color-grey-8)) "+n/i*100+"%,  rgb(var(--color-grey-8)) 100%)"}function Ce(e){parseInt(e.value)<=parseInt(e.min)?e.style.zIndex=2:e.style.zIndex=0}function ke(e){var t=this.closest(".formSlider"),i=$('input[type="range"]:last-child',t),n=$(".formSlider_value:first-child",t),s=parseInt(this.value),o=parseInt(i.value);Pe(this,i),o<s?(this.value=o,n.innerHTML=o):n.innerHTML=s,De(t)}function Re(e){var t=this.closest(".formSlider"),i=$('input[type="range"]:first-child',t),n=$(".formSlider_value:last-child",t),s=parseInt(i.value),o=parseInt(this.value);Pe(i,this),Ce(this),s<=o?n.innerHTML=o:(this.value=s,n.innerHTML=s),De(t)}function De(e){var t=$$('.filter_list input[type="checkbox"]',e.parentNode),i=$('input[type="range"]:first-child',e),e=$('input[type="range"]:last-child',e),n=parseInt(i.value),s=parseInt(e.value),o=parseInt(i.min),r=parseInt(e.max);t.forEach(function(e){var t=e.value.split("-").map(function(e){return parseInt(e)}),i=t[0],t=t[t.length-1];e.checked=(o!==n||r!==s)&&n<=i&&t<=s})}v('.datas_settings input[type="checkbox"]',function(e,t){var i=t.closest(".datas"),i=$$(".datas_table td:nth-child("+t.value+"), .datas_table th:nth-child("+t.value+")",i);t.checked?i.forEach(function(e,t){e.classList.remove("is-hide")}):i.forEach(function(e,t){e.classList.add("is-hide")})}),v(".datas_search .btn",function(e,t){var t=t.closest(".datas_search"),i=$("input",t);t.classList.toggle("is-open"),t.classList.contains("is-open")?i.focus():(i.value="",Se(!1,i))}),_e(),e.addEventListener("keydown",function(e){27!=e.keyCode||z&&z.isOpen()||(r.classList.contains("has-subnavOpen")?W:X)()}),o.addEventListener("resize",function(){M()},!1);Le=function(){var e;(!m||250<Math.abs(m-n))&&(m=n,r.style.setProperty("--vh",n+"px")),r.style.setProperty("--page-nav-h",i-1+"px"),(e=$$(".slider_inner:not(.flickity-enabled) .media",c)).length&&e.each(function(e,t){t.style.height="",t.removeAttribute("aria-hidden")})},Ie=300;var Le,Ie,ze,A,l=function(){var e=this,t=arguments,i=ze&&!A;clearTimeout(A),A=setTimeout(function(){A=null,ze||Le.apply(e,t)},Ie),i&&Le.apply(e,t)},Oe=(o.addEventListener("resize",l,!1),l(),!1);function Ae(){Oe=!1,n-i<=s?r.classList.add("is-window-scrolled"):r.classList.remove("is-window-scrolled"),g&&(g.getBoundingClientRect().top>i||u.getBoundingClientRect().top+u.offsetHeight<i?(r.classList.remove("is-page-content-viewable"),d&&se()):r.classList.add("is-page-content-viewable")),ne(),he(),ae()}o.addEventListener("scroll",function(){H(),Oe||(Oe=!0,o.requestAnimationFrame(Ae))},!1)}(window);